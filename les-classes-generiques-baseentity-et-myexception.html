
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Introduction au langage Python 3 et au framework web Flask par l'exemple">
      
      
        <meta name="author" content="Serge Tahé">
      
      
        <link rel="canonical" href="https://stahe.github.io/python-flask-sept-2020/les-classes-generiques-baseentity-et-myexception.html">
      
      
        <link rel="prev" href="les-classes-et-objets.html">
      
      
        <link rel="next" href="architecture-en-couches-et-programmation-par-interfaces.html">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>13. Les classes génériques [BaseEntity] et [MyException] - Introduction au langage Python 3 et au framework web Flask par l'exemple</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/focus.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#13-les-classes-generiques-baseentity-et-myexception" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Introduction au langage Python 3 et au framework web Flask par l&#39;exemple" class="md-header__button md-logo" aria-label="Introduction au langage Python 3 et au framework web Flask par l'exemple" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction au langage Python 3 et au framework web Flask par l'exemple
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              13. Les classes génériques [BaseEntity] et [MyException]
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stahe/python-flask-sept-2020" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Introduction au langage Python 3 et au framework web Flask par l&#39;exemple" class="md-nav__button md-logo" aria-label="Introduction au langage Python 3 et au framework web Flask par l'exemple" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Introduction au langage Python 3 et au framework web Flask par l'exemple
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stahe/python-flask-sept-2020" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="avant-propos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Avant-propos
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation-dx27un-environnement-de-travail.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Installation d&#x27;un environnement de travail
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-bases-de-python.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Les bases de Python
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-chaines-de-caracteres.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Les chaînes de caractères
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-exceptions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Les exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fonctions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Les fonctions
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fichiers-texte.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Les fichiers texte
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dx27application---version-1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Exercice d&#x27;application – version 1
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-imports.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Les imports
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Exercice d’application : version 2
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-3.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Exercice d’application : version 3
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-classes-et-objets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Les classes et objets
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    13. Les classes génériques [BaseEntity] et [MyException]
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="les-classes-generiques-baseentity-et-myexception.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Les classes génériques [BaseEntity] et [MyException]
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#131-la-classe-myexception" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.1. La classe MyException
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#132-la-classe-baseentity" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2. La classe [BaseEntity]
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.2. La classe [BaseEntity]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1321-la-methode-baseentityfromdict" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1. La méthode [BaseEntity.fromdict]
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.2.1. La méthode [BaseEntity.fromdict]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13211-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.1. Définition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13212-exemples" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2. Exemples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.2.1.2. Exemples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#132121-la-classe-utils" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.1. La classe [Utils]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132122-la-classe-personne" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.2. La classe [Personne]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132123-la-classe-enseignant" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.3. La classe [Enseignant]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132124-la-configuration-config" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.4. La configuration [config]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132125-le-script-fromdict_01" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.5. Le script [fromdict_01]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132126-le-script-fromdict_02" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.6. Le script [fromdict_02]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132127-le-script-fromdict_03" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.7. Le script [fromdict_03]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132128-le-script-fromdict_04" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.1.2.8. Le script [fromdict_04]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1322-la-methode-baseentityasdict" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.2. La méthode [BaseEntity.asdict]
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.2.2. La méthode [BaseEntity.asdict]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#13221-definition" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.2.1. Définition
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13222-exemples" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.2.2. Exemples
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1323-la-methode-baseentityasjson" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.3. La méthode [BaseEntity.asjson]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1324-la-methode-baseentityfromjson" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.4. La méthode [BaseEntity.fromjson]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1325-le-script-main" class="md-nav__link">
    <span class="md-ellipsis">
      
        13.2.5. Le script [main]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="architecture-en-couches-et-programmation-par-interfaces.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Architecture en couches et programmation par interfaces
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dx27application---version-4.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Exercice d&#x27;application - version 4
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilisation-du-sgbd-mysql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Utilisation du SGBD MySQL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilisation-du-sgbd-postgresql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Utilisation du SGBD PostgreSQL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="ecrire-du-code-independant-du-sgbd.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. Ecrire du code indépendant du SGBD
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilisation-de-lorm-sqlalchemy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. Utilisation de l’ORM SQLALCHEMY
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dx27application-version-5.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Exercice d&#x27;application : version 5
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="fonctions-internet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Fonctions internet
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="services-web-avec-le-framework-flask.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Services web avec le framework Flask
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-6.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. Exercice d’application : version 6
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-7.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. Exercice d’application : version 7
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-8.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. Exercice d’application : version 8
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="du-dictionnaire-a-xml-et-vice-versa.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. Du dictionnaire à XML et vice-versa
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-9.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. Exercice d’application : version 9
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-10.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. Exercice d’application : version 10
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-11.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. Exercice d’application : version 11
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-12.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. Exercice d’application : version 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="clients-web-pour-les-services-json-et-xml-de-la-version-12.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. Clients web pour les services jSON et XML de la version 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="le-mode-html-de-la-version-12.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Le mode HTML de la version 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-13.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. Exercice d’application : version 13
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-14.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. Exercice d’application : version 14
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-15.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. Exercice d’application : version 15
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-16.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. Exercice d’application : version 16
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-17.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Exercice d’application : version 17
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-18.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. Exercice d’application : version 18
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="conclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. Conclusion
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="13-les-classes-generiques-baseentity-et-myexception">13. Les classes génériques [BaseEntity] et [MyException]</h1>
<p>Nous définissons maintenant deux classes que nous utiliserons régulièrement par la suite.</p>
<p><img src="images/100000000000015F000001ED11B0338D.png" style="width:4.051cm;height:5.7cm;" alt="Image" /></p>
<h2 id="131-la-classe-myexception">13.1. La classe MyException</h2>
<p>La classe <strong>[MyException]</strong> (MyException.py) fournit une classe d&#x27;exceptions propriétaire :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># une classe d&#39;exception propriétaire dérivant de [BaseException]</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyException</span><span class="p">(</span><span class="ne">BaseException</span><span class="p">):</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span class="c1"># constructeur</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="c1"># parent</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="ne">BaseException</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="c1"># code erreur</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="c1"># toString</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;MyException[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="si">}</span><span class="s2">]&quot;</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="c1"># getter</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__code</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="c1"># setter</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="nd">@code</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>        <span class="c1"># le code d&#39;erreur doit être un entier positif</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">code</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__code</span> <span class="o">=</span> <span class="n">code</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>            <span class="c1"># exception</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="k">raise</span> <span class="ne">BaseException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;code erreur </span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2"> incorrect&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 2 : la classe <strong>[MyException]</strong> dérive de la classe prédéfinie <strong>[BaseException]</strong> ;</li>
<li>ligne 4 : le constructeur accepte deux paramètres :</li>
<li><strong>[code]</strong> : un code d&#x27;erreur entier ;</li>
<li><strong>[message]</strong> : un message d&#x27;erreur ;</li>
<li>ligne 6 : on passe le message d’erreur à la classe parent ;</li>
<li>lignes 14-27 : l&#x27;attribut <strong>[code]</strong> est manipulé via un getter / setter ;</li>
<li>lignes 23-24 : la validité de l&#x27;attribut <strong>[code]</strong> est vérifiée : il faut que ce soit un entier &gt;0 ;</li>
</ul>
<h2 id="132-la-classe-baseentity">13.2. La classe [BaseEntity]</h2>
<p>La classe <strong>[BaseEntity]</strong> sera la classe parent de la plupart des classes que nous créerons pour encapsuler des informations sur un objet. Dans la suite nous utiliserons principalement deux types de classes :</p>
<ul>
<li>des classes qui n’ont pour but que d’encapsuler au même endroit des informations sur un même objet. Celles-ci n’auront pas de comportements (méthodes) autres que des getters / setters et une fonction d’affichage (<strong>str</strong>). S’il y a N objets à gérer, ces classes sont instanciées N fois. <strong>[BaseEntity]</strong> sera la classe parent de ce type de classes ;</li>
<li>des classes dont le rôle principal est d’encapsuler des méthodes et très peu d’informations. Ces classes ne seront instanciées qu’une fois (<strong>singleton</strong>). Leur rôle est d’implémenter les algorithmes d’une application ;
La classe <strong>[BaseEntity]</strong> est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span>
<span class="normal"><a href="#__codelineno-1-48">48</a></span>
<span class="normal"><a href="#__codelineno-1-49">49</a></span>
<span class="normal"><a href="#__codelineno-1-50">50</a></span>
<span class="normal"><a href="#__codelineno-1-51">51</a></span>
<span class="normal"><a href="#__codelineno-1-52">52</a></span>
<span class="normal"><a href="#__codelineno-1-53">53</a></span>
<span class="normal"><a href="#__codelineno-1-54">54</a></span>
<span class="normal"><a href="#__codelineno-1-55">55</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># imports</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">BaseEntity</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="c1"># propriétés exclues de l&#39;état de la classe</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>        <span class="c1"># id : identifiant de l&#39;objet</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>    <span class="c1"># toString</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asjson</span><span class="p">()</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>    <span class="c1"># getter</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>    <span class="nd">@property</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__id</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>    <span class="c1">#  setter</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>    <span class="nd">@id</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>        <span class="c1"># l&#39;id doit être un entier &gt;=0</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>            <span class="nb">id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a>            <span class="n">erreur</span> <span class="o">=</span> <span class="nb">id</span> <span class="o">&lt;</span> <span class="mi">0</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a>        <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a>            <span class="n">erreur</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a>        <span class="c1"># erreur ?</span>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a>        <span class="k">if</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;L&#39;identifiant d&#39;une entité </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="si">}</span><span class="s2"> doit être un entier &gt;=0&quot;</span><span class="p">)</span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-1-40" name="__codelineno-1-40"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__id</span> <span class="o">=</span> <span class="nb">id</span>
<a id="__codelineno-1-41" name="__codelineno-1-41"></a>
<a id="__codelineno-1-42" name="__codelineno-1-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a>        <span class="err">…</span>
<a id="__codelineno-1-44" name="__codelineno-1-44"></a>
<a id="__codelineno-1-45" name="__codelineno-1-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">new_attributes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-1-46" name="__codelineno-1-46"></a>        <span class="err">…</span>
<a id="__codelineno-1-47" name="__codelineno-1-47"></a>
<a id="__codelineno-1-48" name="__codelineno-1-48"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">included_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">excluded_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-1-49" name="__codelineno-1-49"></a>        <span class="err">…</span>
<a id="__codelineno-1-50" name="__codelineno-1-50"></a>
<a id="__codelineno-1-51" name="__codelineno-1-51"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">asjson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">excluded_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-1-52" name="__codelineno-1-52"></a>        <span class="err">…</span>
<a id="__codelineno-1-53" name="__codelineno-1-53"></a>
<a id="__codelineno-1-54" name="__codelineno-1-54"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fromjson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-1-55" name="__codelineno-1-55"></a>        <span class="err">…</span>
</code></pre></div></td></tr></table></div>
<p><strong>Commentaires</strong></p>
<ul>
<li>l’objectif de la classe <strong>[BaseEntity]</strong> est de faciliter les conversions Objet / Dictionnaire et Objet / jSON. On offre ainsi les méthodes suivantes :</li>
<li><strong>[asdict]</strong> : rend le dictionnaire des propriétés de l’objet ;</li>
<li><strong>[fromdict]</strong> : construit un objet à partir d’un dictionnaire ;</li>
<li><strong>[asjson]</strong> : rend la chaîne jSON de l’objet comme le fait la fonction <strong>[<strong>str</strong>]</strong> ;</li>
<li><strong>[fromjson]</strong> : construit un objet à partir de sa chaîne jSON ;</li>
<li>la classe <strong>[BaseEntity]</strong> est destinée à être dérivée et non à être utilisée telle quelle ;</li>
<li>lignes 22-25 : la classe <strong>[BaseEntity]</strong> n’a qu’une propiété, l’entier <strong>[id]</strong>. Cette propriété est l’identifiant de l’objet. Dans la pratique, il est souvent utile de pouvoir différentier les instances d’une même classe. Nous le ferons avec cette propriété, unique pour une instance. Par ailleurs, les objets proviennent souvent de bases de données où ils sont identifiés par une clé primaire, un entier généralement. Dans ces cas, <strong>[id]</strong> sera la clé primaire ;</li>
<li>lignes 27-40 : le setter de la propriété <strong>[id]</strong>. On vérifie que c’est un entier &gt;=0. Si ce n’est pas le cas, une exception de type <strong>[MyException]</strong> est lancée (ligne 39) ;</li>
<li>ligne 10 : <strong>[excluded_keys]</strong> est un attribut de classe et non d’instance. Ainsi on écrira <strong>[BaseEntity.excluded_keys]</strong>. Cet attribut de classe est une liste contenant les propriétés de classe qui ne participent pas aux conversions Objet / Dictionnaire et Objet / jSON ;</li>
<li>lignes 12-16 : <strong>[get_allowed_keys]</strong> rend la liste des propriétés de la classe. Dans une conversion Dictionnaire -&gt; Objet ou jSON -&gt; Objet, on n’acceptera que les clés présentes dans cette liste. Chaque classe dérivant la classe <strong>[BaseEntity]</strong> aura à redéfinir cette liste ;
Il faut comprendre ici que les propriétés et fonctions de la classe <strong>[BaseEntity]</strong> sont accessibles aux classes dérivées de <strong>[BaseEntity]</strong>. C’est le point important à comprendre.</li>
</ul>
<p>Nous allons détailler le code de la classe <strong>[BaseEntity]</strong>. Il est assez avancé. Le lecteur débutant pourra se contenter de lire le rôle de chaque fonction sans s’apesantir sur son code.</p>
<h3 id="1321-la-methode-baseentityfromdict">13.2.1. La méthode [BaseEntity.fromdict]</h3>
<h4 id="13211-definition">13.2.1.1. Définition</h4>
<p>La méthode <strong>[fromdict]</strong> permet d’initialiser un objet <strong>[BaseEntity]</strong> ou dérivé à partir d’un dictionnaire :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">fromdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a>        <span class="c1"># on met à jour l&#39;objet</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a>        <span class="c1"># clés autorisées</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>        <span class="n">allowed_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>        <span class="c1"># parcourt des clés de state</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">state</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>            <span class="c1"># la clé est-elle autorisée ?</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_keys</span><span class="p">:</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">silent</span><span class="p">:</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>                    <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;la clé </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> n&#39;est pas autorisée&quot;</span><span class="p">)</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>                <span class="c1"># on essaie d&#39;affecter la valeur à la clé</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>                <span class="c1"># on laisse remonter l&#39;éventuelle exception</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>        <span class="c1"># on rend l&#39;objet</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>        <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
<p><strong>Commentaires</strong></p>
<ul>
<li>ligne 1 : la fonction reçoit en paramètre le dictionnaire <strong>[state]</strong> à partir duquel l’objet courant va être initialisé ;</li>
<li>ligne 4 : on fait appel à la fonction statique <strong>[get_allowed_keys]</strong> de la classe qui a appelé la fonction <strong>[fromdict]</strong>. Si on a affaire à une classe dérivée de <strong>[BaseEntity]</strong> et que cette classe dérivée a redéfini la fonction statique <strong>[get_allowed_keys]</strong> alors c’est la fonction <strong>[get_allowed_keys]</strong> qui est appelée. Chaque classe dérivée redéfinit cette fonction statique pour y déclarer ses propriétés ;</li>
<li>ligne 6 : on parcourt les clés et valeurs du dictionnaire <strong>[state]</strong> ;</li>
<li>ligne 8 : si la clé <strong>[key]</strong> ne fait pas partie des propriétés de la classe, alors soit :</li>
<li>on l’ignore ;</li>
<li>on lance une exception (ligne 10). Le développeur indique ce qu’il souhaite en passant le bon paramètre <strong>[silent]</strong> (ligne 1). La valeur par défaut de <strong>[silent]</strong> fait qu’une exception est lancée si on tente d’initialiser l’objet avec une propriété qu’il n’a pas ;</li>
<li>ligne 14 : si la clé fait partie des propriétés de l’objet, alors on l’affecte à l’objet <strong>[self]</strong> à l’aide de la fonction prédéfinie <strong>[setattr]</strong> ;</li>
<li>ligne 16 : la fonction rend l’objet initialisé ;</li>
</ul>
<h4 id="13212-exemples">13.2.1.2. Exemples</h4>
<p><img src="images/10000000000001160000018995EC20FD.png" style="width:3.222cm;height:4.53cm;" alt="Image" /></p>
<h5 id="132121-la-classe-utils">13.2.1.2.1. La classe [Utils]</h5>
<p>La classe <strong>[Utils]</strong> (Utils.py) est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">Utils</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a>    <span class="c1"># méthode statique</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_string_ok</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a>        <span class="c1"># string est-elle une chaîne</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>        <span class="n">erreur</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>            <span class="c1"># la chaîne est-elle vide ?</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>            <span class="n">erreur</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>        <span class="c1"># résultat</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>        <span class="k">return</span> <span class="ow">not</span> <span class="n">erreur</span>
</code></pre></div></td></tr></table></div>
<p>Elle définit aux lignes 3-11, une méthode statique qui rend un booléen vrai si son paramètre <strong>[str]</strong> est une chaîne de caractères non vide ;</p>
<h5 id="132122-la-classe-personne">13.2.1.2.2. La classe [Personne]</h5>
<p>La classe <strong>[Personne]</strong> (Personne.py) dérive de la classe <strong>[BaseEntity]</strong> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span>
<span class="normal"><a href="#__codelineno-4-39">39</a></span>
<span class="normal"><a href="#__codelineno-4-40">40</a></span>
<span class="normal"><a href="#__codelineno-4-41">41</a></span>
<span class="normal"><a href="#__codelineno-4-42">42</a></span>
<span class="normal"><a href="#__codelineno-4-43">43</a></span>
<span class="normal"><a href="#__codelineno-4-44">44</a></span>
<span class="normal"><a href="#__codelineno-4-45">45</a></span>
<span class="normal"><a href="#__codelineno-4-46">46</a></span>
<span class="normal"><a href="#__codelineno-4-47">47</a></span>
<span class="normal"><a href="#__codelineno-4-48">48</a></span>
<span class="normal"><a href="#__codelineno-4-49">49</a></span>
<span class="normal"><a href="#__codelineno-4-50">50</a></span>
<span class="normal"><a href="#__codelineno-4-51">51</a></span>
<span class="normal"><a href="#__codelineno-4-52">52</a></span>
<span class="normal"><a href="#__codelineno-4-53">53</a></span>
<span class="normal"><a href="#__codelineno-4-54">54</a></span>
<span class="normal"><a href="#__codelineno-4-55">55</a></span>
<span class="normal"><a href="#__codelineno-4-56">56</a></span>
<span class="normal"><a href="#__codelineno-4-57">57</a></span>
<span class="normal"><a href="#__codelineno-4-58">58</a></span>
<span class="normal"><a href="#__codelineno-4-59">59</a></span>
<span class="normal"><a href="#__codelineno-4-60">60</a></span>
<span class="normal"><a href="#__codelineno-4-61">61</a></span>
<span class="normal"><a href="#__codelineno-4-62">62</a></span>
<span class="normal"><a href="#__codelineno-4-63">63</a></span>
<span class="normal"><a href="#__codelineno-4-64">64</a></span>
<span class="normal"><a href="#__codelineno-4-65">65</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># imports</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Utils</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1"># classe Personne</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">Personne</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>    <span class="c1"># propriétés exclues de l&#39;état de la classe</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>    <span class="c1"># id : identifiant de la personne</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span class="c1"># prénom : prénom de la personne</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>    <span class="c1"># nom : nom de la personne</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>    <span class="c1"># âge : âge de la personne</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>        <span class="c1"># id : identifiant de l&#39;objet</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>        <span class="k">return</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;nom&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">]</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>    <span class="c1"># getters</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>    <span class="nd">@property</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prénom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__prénom</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>    <span class="nd">@property</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span>
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a>    <span class="nd">@property</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">âge</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__âge</span>
<a id="__codelineno-4-34" name="__codelineno-4-34"></a>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>    <span class="c1"># setters</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>    <span class="nd">@prénom</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prénom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prénom</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a>        <span class="c1"># le prénom doit être non vide</span>
<a id="__codelineno-4-39" name="__codelineno-4-39"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">prénom</span><span class="p">):</span>
<a id="__codelineno-4-40" name="__codelineno-4-40"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__prénom</span> <span class="o">=</span> <span class="n">prénom</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-4-41" name="__codelineno-4-41"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-42" name="__codelineno-4-42"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;Le prénom doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-4-43" name="__codelineno-4-43"></a>
<a id="__codelineno-4-44" name="__codelineno-4-44"></a>    <span class="nd">@nom</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-4-45" name="__codelineno-4-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nom</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-4-46" name="__codelineno-4-46"></a>        <span class="c1"># le prénom doit être non vide</span>
<a id="__codelineno-4-47" name="__codelineno-4-47"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">nom</span><span class="p">):</span>
<a id="__codelineno-4-48" name="__codelineno-4-48"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span> <span class="o">=</span> <span class="n">nom</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-4-49" name="__codelineno-4-49"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-50" name="__codelineno-4-50"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;Le nom doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-4-51" name="__codelineno-4-51"></a>
<a id="__codelineno-4-52" name="__codelineno-4-52"></a>    <span class="nd">@âge</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-4-53" name="__codelineno-4-53"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">âge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">âge</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-4-54" name="__codelineno-4-54"></a>        <span class="c1"># l&#39;âge doit être un entier &gt;=0</span>
<a id="__codelineno-4-55" name="__codelineno-4-55"></a>        <span class="n">erreur</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-4-56" name="__codelineno-4-56"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">âge</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-4-57" name="__codelineno-4-57"></a>            <span class="k">if</span> <span class="n">âge</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-4-58" name="__codelineno-4-58"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__âge</span> <span class="o">=</span> <span class="n">âge</span>
<a id="__codelineno-4-59" name="__codelineno-4-59"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-60" name="__codelineno-4-60"></a>                <span class="n">erreur</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-4-61" name="__codelineno-4-61"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-62" name="__codelineno-4-62"></a>            <span class="n">erreur</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-4-63" name="__codelineno-4-63"></a>        <span class="c1"># erreur ?</span>
<a id="__codelineno-4-64" name="__codelineno-4-64"></a>        <span class="k">if</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-4-65" name="__codelineno-4-65"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="s2">&quot;L&#39;âge doit être un entier &gt;=0&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 8 : la classe <strong>[Personne]</strong> dérive de la classe <strong>[BaseEntity]</strong> ;</li>
<li>lignes 8-65 : on a gardé l’essentiel de la classe <strong>[Personne]</strong> déjà rencontrée. Les différences sont les suivantes :</li>
<li>la classe n’a plus de constructeur ;</li>
<li>la classe utilise l’exception <strong>[MyException]</strong>, exemple ligne 65 ;</li>
<li>elle a une méthode statique, <strong>[get_allowed_keys]</strong>, lignes 17-20, qui définit la liste de ses propriétés. Les propriétés propres à la classe <strong>[Personne]</strong> sont ajoutées à celles de la classe parent <strong>[BaseEntity]</strong> ;</li>
<li>elle a une liste statique <strong>[excluded_keys]</strong> sur laquelle on reviendra ;</li>
</ul>
<h5 id="132123-la-classe-enseignant">13.2.1.2.3. La classe [Enseignant]</h5>
<p>La classe <strong>[Enseignant]</strong> (Enseignant.py) dérive de la classe <strong>[Personne]</strong> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span>
<span class="normal"><a href="#__codelineno-5-31">31</a></span>
<span class="normal"><a href="#__codelineno-5-32">32</a></span>
<span class="normal"><a href="#__codelineno-5-33">33</a></span>
<span class="normal"><a href="#__codelineno-5-34">34</a></span>
<span class="normal"><a href="#__codelineno-5-35">35</a></span>
<span class="normal"><a href="#__codelineno-5-36">36</a></span>
<span class="normal"><a href="#__codelineno-5-37">37</a></span>
<span class="normal"><a href="#__codelineno-5-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1"># imports</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Personne</span><span class="w"> </span><span class="kn">import</span> <span class="n">Personne</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Utils</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1"># classe Enseignant</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">Enseignant</span><span class="p">(</span><span class="n">Personne</span><span class="p">):</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a>    <span class="c1"># propriétés exclues de l&#39;état de la classe</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>    <span class="c1"># id : identifiant de la personne</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>    <span class="c1"># prénom : prénom de la personne</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a>    <span class="c1"># nom : nom de la personne</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>    <span class="c1"># âge : âge de la personne</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>    <span class="c1"># discipline : discpline enseignée</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a>        <span class="c1"># id : identifiant de l&#39;objet</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a>        <span class="k">return</span> <span class="n">Personne</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;discipline&quot;</span><span class="p">]</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a>    <span class="c1"># propriétés</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a>    <span class="nd">@property</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">discipline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__discipline</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a>    <span class="nd">@discipline</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">discipline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">discipline</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a>        <span class="c1"># la discipline doit être une chaîne non vide</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">discipline</span><span class="p">):</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__discipline</span> <span class="o">=</span> <span class="n">discipline</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;La discipline doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a>    <span class="c1"># méthode show</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Enseignant[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">prénom</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nom</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">âge</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 8 : la classe <strong>[Enseignant]</strong> étend (ou dérive) la classe <strong>[Personne]</strong> ;</li>
<li>lignes 18-21 : définissent la liste des propriétés de la classe ;</li>
<li>lignes 37-38 : la méthode <strong>[show]</strong> affiche l’identité de l’enseignant ;</li>
</ul>
<h5 id="132124-la-configuration-config">13.2.1.2.4. La configuration [config]</h5>
<p>Les scripts d’exemples utilisent la configuration <strong>[config]</strong> suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">():</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a>    <span class="c1"># dossier du fichier de configuration</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>    <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a>    <span class="c1"># chemins absolus des dossiers à mettre dans le syspath</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a>    <span class="n">absolute_dependencies</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a>        <span class="c1"># la classe BaseEntity</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/entities&quot;</span><span class="p">,</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a>    <span class="p">]</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a>    <span class="c1"># mise à jour du syspath</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">myutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_syspath</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a>    <span class="n">set_syspath</span><span class="p">(</span><span class="n">absolute_dependencies</span><span class="p">)</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a>    <span class="c1"># on rend la configuration</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a>    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 8-10 : les dossiers contenant les dépendances du projet ;</li>
<li>lignes 14-15 : le Python Path est construit ;</li>
<li>ligne 18 : on rend un dictionnaire vide (il n’y a pas d’autres configuration que celle du syspath) ;</li>
</ul>
<h5 id="132125-le-script-fromdict_01">13.2.1.2.5. Le script [fromdict_01]</h5>
<p>Le script <strong>[fromdict_01]</strong> est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">})</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="n">enseignant1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 10 : on crée un objet <strong>[Enseignant]</strong> à partir d’un dictionnaire. Pour cela, on utilise le constructeur par défaut de la classe pour créer un objet <strong>[Enseignant]</strong> à laquel on applique la méthode <strong>[fromdict]</strong>. Il faut comprendre qu’ici la méthode <strong>[fromdict]</strong> exécutée est celle de la classe parent <strong>[BaseEntity]</strong>. En effet :</li>
<li>la méthode <strong>[fromdict]</strong> est d’abord cherchée dans la classe <strong>[Enseignant]</strong>. <strong>Elle n’existe pas</strong> ;</li>
<li>elle est ensuite cherchée dans la classe parent <strong>[Personne]</strong>. <strong>Elle n’existe pas</strong> ;</li>
<li>elle est ensuite cherchée dans la classe parent <strong>[BaseEntity]</strong>. <strong>Elle existe</strong> ;</li>
<li>ligne 11 : on affiche l’objet <strong>[Enseignant]</strong> ;
Les résultats sont les suivants :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">fromdict_01</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="n">Enseignant</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">paul</span><span class="p">,</span> <span class="n">lourou</span><span class="p">,</span> <span class="mi">56</span><span class="p">]</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<h5 id="132126-le-script-fromdict_02">13.2.1.2.6. Le script [fromdict_02]</h5>
<p>Le script <strong>[fromdict_02]</strong> est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">})</span>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="n">enseignant1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 10 : on crée un enseignant avec un prénom vide. Cela doit créer une exception car la classe <strong>[Personne]</strong> n’accepte pas des prénoms vides. Cet exemple montre la différence entre un dictionnaire et un objet. Ce dernier peut vérifier la validité de ses propriétés, pas le dictionnaire ;
Les résultats sont les suivants :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">fromdict_02</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>  <span class="n">File</span> <span class="s2">&quot;C:/Data/st-2020/dev/python/cours-2020/python3-flask-2020/classes/02/fromdict_02.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">10</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>    <span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">})</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>  <span class="n">File</span> <span class="s2">&quot;C:\Data\st-2020\dev\python\cours-2020\python3-flask-2020\classes</span><span class="se">\02</span><span class="s2">/entities\BaseEntity.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">55</span><span class="p">,</span> <span class="ow">in</span> <span class="n">fromdict</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a>    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>  <span class="n">File</span> <span class="s2">&quot;C:\Data\st-2020\dev\python\cours-2020\python3-flask-2020\classes</span><span class="se">\02</span><span class="s2">/entities\Personne.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">42</span><span class="p">,</span> <span class="ow">in</span> <span class="n">prénom</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a>    <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;Le prénom doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="n">MyException</span><span class="o">.</span><span class="n">MyException</span><span class="p">:</span> <span class="n">MyException</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="n">Le</span> <span class="n">prénom</span> <span class="n">doit</span> <span class="n">être</span> <span class="n">une</span> <span class="n">chaîne</span> <span class="n">de</span> <span class="n">caractères</span> <span class="n">non</span> <span class="n">vide</span><span class="p">]</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
<h5 id="132127-le-script-fromdict_03">13.2.1.2.7. Le script [fromdict_03]</h5>
<p>Le script <strong>[fromdict_03]</strong> est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-11-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-11-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-11-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-11-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-11-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-11-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-11-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-11-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-11-10">10</a></span>
<span class="normal"><a href="#__codelineno-11-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-11-8" name="__codelineno-11-8"></a>
<a id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;albert&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">:</span> <span class="s2">&quot;M&quot;</span><span class="p">})</span>
<a id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="n">enseignant1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 10 : on crée un enseignant à partir d’un dictionnaire contenant une clé (sexe) qui n’appartient pas à la classe <strong>[Enseignant]</strong>. Une exception devrait alors être levée ;
Les résultats sont les suivants :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span>
<span class="normal"><a href="#__codelineno-12-6">6</a></span>
<span class="normal"><a href="#__codelineno-12-7">7</a></span>
<span class="normal"><a href="#__codelineno-12-8">8</a></span>
<span class="normal"><a href="#__codelineno-12-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">fromdict_03</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>  <span class="n">File</span> <span class="s2">&quot;C:/Data/st-2020/dev/python/cours-2020/python3-flask-2020/classes/02/fromdict_03.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">10</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a>    <span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;albert&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">:</span> <span class="s2">&quot;M&quot;</span><span class="p">})</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>  <span class="n">File</span> <span class="s2">&quot;C:\Data\st-2020\dev\python\cours-2020\python3-flask-2020\classes</span><span class="se">\02</span><span class="s2">/entities\BaseEntity.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">51</span><span class="p">,</span> <span class="ow">in</span> <span class="n">fromdict</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a>    <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;la clé [</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">] n&#39;est pas autorisée&quot;</span><span class="p">)</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="n">MyException</span><span class="o">.</span><span class="n">MyException</span><span class="p">:</span> <span class="n">MyException</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">la</span> <span class="n">clé</span> <span class="p">[</span><span class="n">sexe</span><span class="p">]</span> <span class="n">n</span><span class="s1">&#39;est pas autorisée]</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
<h5 id="132128-le-script-fromdict_04">13.2.1.2.8. Le script [fromdict_04]</h5>
<p>Le script <strong>[fromdict_04]</strong> est une copie de <strong>[fromdict_03]</strong> à un détail près :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;albert&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s2">&quot;sexe&quot;</span><span class="p">:</span> <span class="s2">&quot;M&quot;</span><span class="p">},</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="n">enseignant1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 10 : on a utilisé le paramètre <strong>[silent=True]</strong> pour indiquer que si une clé du dictionnaire n’est pas une propriété de la classe <strong>[Enseignant]</strong>, elle doit simplement être ignorée. Dans ce cas, aucune exception ne sera lancée ;
Les résultats sont les suivants :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">fromdict_04</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="n">Enseignant</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">albert</span><span class="p">,</span> <span class="n">lourou</span><span class="p">,</span> <span class="mi">56</span><span class="p">]</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<h3 id="1322-la-methode-baseentityasdict">13.2.2. La méthode [BaseEntity.asdict]</h3>
<h4 id="13221-definition">13.2.2.1. Définition</h4>
<p>La méthode <strong>[BaseEntity.asdict]</strong> rend un dictionnaire dont les clés sont les propriétés de l’objet :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">included_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">excluded_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span><span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a>        <span class="c1"># attributs de l&#39;objet</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a>        <span class="n">attributes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a>        <span class="c1"># les nouveaux attributs</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a>        <span class="n">new_attributes</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a>        <span class="c1"># on parcourt les attributs</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>            <span class="c1"># si la clé est explicitement demandée</span>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>            <span class="k">if</span> <span class="n">included_keys</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">included_keys</span><span class="p">:</span>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">new_attributes</span><span class="p">)</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a>            <span class="c1"># sinon, si la clé n&#39;est pas exclue</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>            <span class="k">elif</span> <span class="ow">not</span> <span class="n">included_keys</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="ow">and</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">excluded_keys</span><span class="p">:</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">new_attributes</span><span class="p">)</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a>        <span class="c1"># on rend le dictionnaire des attributs</span>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a>        <span class="k">return</span> <span class="n">new_attributes</span>
</code></pre></div></td></tr></table></div>
<p><strong>Commentaires</strong></p>
<ul>
<li>ligne 1 : la fonction <strong>[asdict]</strong> rend le dictionnaire des propriétés de l’objet ;</li>
<li>ligne 1 : <strong>[included_keys]</strong> : la liste des clés à inclure dans le dictionnaire ;</li>
<li>ligne 1 : <strong>[excluded_keys]</strong> : la liste des clés à exclure du dictionnaire ;</li>
<li>ligne 3 : la propriété <strong>[self.<strong>dict</strong>]</strong> rend le dictionnaire des propriétés de l’objet. Les noms des propriétés sont les clés et leurs valeurs les valeurs du dictionnaire. Un objet peut contenir des références d’autres objets. Les noms des propriétés sont alors préfixées par le nom de la classe à laquelle elles appartiennent. C’est quelque chose qu’on ne veut pas. On veut les propriétés sans leur préfixe ;</li>
<li>ligne 3 : il faut comprendre ici que si la fonction <strong>[asdict]</strong> s’exécute à l’intérieur d’une classe dérivée de <strong>[BaseEntity]</strong>, la propriété <strong>[self.<strong>dict</strong>]</strong> rend le dictionnaire des propriétés de <strong>l’objet dérivé</strong> ;</li>
<li>ligne 5 : le dictionnaire que l’on va construire ;</li>
<li>ligne 7 : on parcourt les valeurs de <strong>[self.<strong>dict</strong>]</strong> sous la forme (clé, valeur) ;</li>
<li>ligne 9 : si la clé courante appartient à la liste des clés à inclure, alors elle est ajoutée au dictionnaire <strong>[new_attributes]</strong> par la fonction <strong>[set_value]</strong> que nous allons prochainement décrire ;</li>
<li>ligne 12 : si le paramètre <strong>[included_keys]</strong> n’est pas présent, alors le paramètre <strong>[excluded_keys]</strong> est exploité. Si la propriété ne fait pas partie des propriétés à exclure, alors elle est ajoutée au dictionnaire <strong>[new_attributes]</strong> ;</li>
<li>ligne 12 : il y a plusieurs façons d’exclure une propriété du dictionnaire :</li>
<li>elle a été définie au niveau de l’attribut de classe <strong>[excluded_keys]</strong> ;</li>
<li>elle a été définie dans la liste <strong>[excluded_keys]</strong> passée à la fonction <strong>[asdict]</strong> ;</li>
<li>le paramètre <strong>[included_keys]</strong> est présent et ne comprend pas la propriété ;</li>
<li>ligne 15 : on rend le dictionnaire <strong>[new_attributes]</strong>
La fonction <strong>[set_value]</strong> des lignes 10 et 13 est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_value</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">new_attributes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a>        <span class="c1"># les clés peuvent être de la forme __Class__key</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a>        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^.*?__(.*?)$&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a>            <span class="c1"># on note la nouvelle clé</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>            <span class="n">newkey</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a>            <span class="c1"># la clé reste inchangée</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a>            <span class="n">newkey</span> <span class="o">=</span> <span class="n">key</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a>        <span class="c1"># on insère la nouvelle clé dans le dictionnaire [new_attributes]</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a>        <span class="c1"># en transformant si besoin est la valeur associée en l&#39;un des types</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a>        <span class="c1"># dict, list, type simple</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a>        <span class="n">new_attributes</span><span class="p">[</span><span class="n">newkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Commentaires</strong></p>
<ul>
<li>ligne 4 : on regarde si la clé est de la forme __Class_key. C’est la forme qu’elle a si elle appartient à un objet inclus dans l’objet principal. Dans ce cas, on ne veut garder que la chaîne <strong>[key]</strong> ;</li>
<li>ligne 7 : on ne garde que la chaîne qui suit les deux derniers caractères soulignés de la chaîne ;</li>
<li>ligne 8-10 : si la clé n’est pas de la forme __Class_key alors on la garde telle quelle ; </li>
<li>lignes 11-14 : la valeur associée à la clé <strong>[newkey]</strong> est calculée par la méthode statique <strong>[</strong><strong>BaseEntity.check_value</strong><strong>]</strong> ;
La méthode statique <strong>[</strong><strong>BaseEntity.check_value</strong><strong>]</strong> est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span>
<span class="normal"><a href="#__codelineno-17-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">check_value</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>        <span class="c1"># la valeur peut être de type BaseEntity, list, dict ou un type simple</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>        <span class="c1"># value est-elle une instance de BaseEntity ?</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>            <span class="n">value2</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a>        <span class="c1"># value est-elle de type list</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a>            <span class="n">value2</span> <span class="o">=</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">list2list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a>        <span class="c1"># value est-elle de type dict ?</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a>            <span class="n">value2</span> <span class="o">=</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">dict2dict</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a>        <span class="c1"># value est un type simple</span>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a>            <span class="n">value2</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a>        <span class="c1"># on rend le résultat</span>
<a id="__codelineno-17-17" name="__codelineno-17-17"></a>        <span class="k">return</span> <span class="n">value2</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 1 : la méthode <strong>[</strong><strong>check_value</strong><strong>]</strong> est statique (méthode de classe et non d’instance). Elle reçoit en paramètre la valeur à associer à une clé du dictionnaire : </li>
<li>ligne 17 : si cette valeur est un type simple, elle reste inchangée ;</li>
<li>lignes 5-6 : si cette valeur est de type BaseEntity, la valeur est remplacée par son dictionnaire. On a alors un appel récursif ;</li>
<li>lignes 8-9 : si cette valeur est une liste, alors elle est remplacée par la valeur <strong>[</strong><strong>BaseEntity.list2list</strong><strong>]</strong> ;</li>
<li>lignes 11-12 : si cette valeur est un dictionnaire, alors elle est remplacée par la valeur <strong>[</strong><strong>BaseEntity.dict2dict</strong><strong>]</strong> ;
La méthode statique <strong>[</strong><strong>BaseEntity.list2list</strong><strong>]</strong> est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span>
<span class="normal"><a href="#__codelineno-18-6">6</a></span>
<span class="normal"><a href="#__codelineno-18-7">7</a></span>
<span class="normal"><a href="#__codelineno-18-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list2list</span><span class="p">(</span><span class="n">liste</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>        <span class="c1"># on inspecte les éléments de la liste</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>        <span class="n">newlist</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">liste</span><span class="p">:</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a>            <span class="n">newlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BaseEntity</span><span class="o">.</span><span class="n">check_value</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a>        <span class="c1"># on rend la nouvelle liste</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a>        <span class="k">return</span> <span class="n">newlist</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 2 : la méthode reçoit une liste et rend une liste ;</li>
<li>lignes 5-6 : on remplace chaque valeur de la liste reçue en paramètre par la valeur rendue par la méthode statique <strong>[</strong><strong>BaseEntity.check_value</strong><strong>]</strong>. On a donc là un appel récursif. La méthode statique <strong>[</strong><strong>BaseEntity.check_value</strong><strong>]</strong> est appelée jusqu’à ce que son paramètre <strong>[value]</strong> soit un type simple (pas un type BaseEntity ou list ou dict) ;
La méthode statique <strong>[</strong><strong>BaseEntity.dict2dict</strong><strong>]</strong> est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span>
<span class="normal"><a href="#__codelineno-19-2">2</a></span>
<span class="normal"><a href="#__codelineno-19-3">3</a></span>
<span class="normal"><a href="#__codelineno-19-4">4</a></span>
<span class="normal"><a href="#__codelineno-19-5">5</a></span>
<span class="normal"><a href="#__codelineno-19-6">6</a></span>
<span class="normal"><a href="#__codelineno-19-7">7</a></span>
<span class="normal"><a href="#__codelineno-19-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dict2dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a>        <span class="c1"># on inspecte les éléments du dictionnaire</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>        <span class="n">newdict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a>            <span class="n">newdict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">check_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a>        <span class="c1"># on rend le nouveau dictionnaire</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>        <span class="k">return</span> <span class="n">newdict</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 2 : la méthode reçoit un dictionnaire et rend un dictionnaire ;</li>
<li>lignes 5-6 : on remplace chaque valeur du dictionnaire reçu en paramètre par la valeur rendue par la méthode statique <strong>[</strong><strong>BaseEntity.check_value</strong><strong>]</strong>. On a donc là un appel récursif. La méthode statique <strong>[</strong><strong>BaseEntity.check_value</strong><strong>]</strong> est appelée jusqu’à ce que son paramètre <strong>[value]</strong> soit un type simple (pas un type BaseEntity ou list ou dict) ;</li>
</ul>
<h4 id="13222-exemples">13.2.2.2. Exemples</h4>
<p>Le script <strong>[asdict_01]</strong> montre diverses utilisations de la méthode <strong>[asdict]</strong> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span>
<span class="normal"><a href="#__codelineno-20-30">30</a></span>
<span class="normal"><a href="#__codelineno-20-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">})</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="n">dict1</span> <span class="o">=</span> <span class="n">enseignant1</span><span class="o">.</span><span class="n">asdict</span><span class="p">()</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dict1</span><span class="p">))</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant1</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">dict1</span><span class="p">)</span>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant1</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">excluded_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_Personne__âge&quot;</span><span class="p">]))</span>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="n">Enseignant</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_Personne__prénom&quot;</span><span class="p">]</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant1</span><span class="p">)</span>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="c1"># un autre enseignant</span>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="n">enseignant2</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;béatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">})</span>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant2</span><span class="o">.</span><span class="n">asdict</span><span class="p">())</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant2</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">included_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_Personne__nom&quot;</span><span class="p">]))</span>
<a id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="c1"># une liste d&#39;entités dans une entité</span>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="n">Enseignant</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="n">entity1</span> <span class="o">=</span> <span class="n">BaseEntity</span><span class="p">()</span>
<a id="__codelineno-20-25" name="__codelineno-20-25"></a><span class="n">enseignants</span> <span class="o">=</span> <span class="p">[</span><span class="n">enseignant1</span><span class="p">,</span> <span class="n">enseignant2</span><span class="p">]</span>
<a id="__codelineno-20-26" name="__codelineno-20-26"></a><span class="nb">setattr</span><span class="p">(</span><span class="n">entity1</span><span class="p">,</span> <span class="s2">&quot;enseignants&quot;</span><span class="p">,</span> <span class="n">enseignants</span><span class="p">)</span>
<a id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="nb">print</span><span class="p">(</span><span class="n">entity1</span><span class="o">.</span><span class="n">asdict</span><span class="p">())</span>
<a id="__codelineno-20-28" name="__codelineno-20-28"></a><span class="c1"># un dictionnaire d&#39;entités dans une entité</span>
<a id="__codelineno-20-29" name="__codelineno-20-29"></a><span class="n">matières</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;maths&quot;</span><span class="p">:</span> <span class="n">enseignant1</span><span class="p">,</span> <span class="s2">&quot;français&quot;</span><span class="p">:</span> <span class="n">enseignant2</span><span class="p">}</span>
<a id="__codelineno-20-30" name="__codelineno-20-30"></a><span class="nb">setattr</span><span class="p">(</span><span class="n">entity1</span><span class="p">,</span> <span class="s2">&quot;matières&quot;</span><span class="p">,</span> <span class="n">matières</span><span class="p">)</span>
<a id="__codelineno-20-31" name="__codelineno-20-31"></a><span class="nb">print</span><span class="p">(</span><span class="n">entity1</span><span class="o">.</span><span class="n">asdict</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>Les résultats de l’exécution sont les suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">asdict_01</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">dict</span><span class="s1">&#39;&gt;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="p">{</span><span class="s1">&#39;_BaseEntity__id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;_Personne__nom&#39;</span><span class="p">:</span> <span class="s1">&#39;lourou&#39;</span><span class="p">,</span> <span class="s1">&#39;_Personne__prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;paul&#39;</span><span class="p">,</span> <span class="s1">&#39;_Personne__âge&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">}</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;lourou&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;paul&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">}</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;lourou&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;paul&#39;</span><span class="p">}</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">}</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;abélard&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;abélard&#39;</span><span class="p">}</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="p">{</span><span class="s1">&#39;enseignants&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;lourou&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;paul&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;abélard&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;béatrice&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}]}</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="p">{</span><span class="s1">&#39;enseignants&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;lourou&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;paul&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;abélard&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;béatrice&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}],</span> <span class="s1">&#39;matières&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;maths&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;lourou&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;paul&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span> <span class="s1">&#39;français&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;abélard&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;béatrice&#39;</span><span class="p">,</span> <span class="s1">&#39;âge&#39;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}}}</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>la ligne 4 montre l’intérêt de la méthode <strong>[asdict]</strong> vis-à-vis de l’utilisation de la propriété <strong>[<strong>dict</strong>]</strong>. Les propriétés sont débarrassées du préfixe de leur classe. Cela se prête mieux à un affichage ;</li>
<li>il y a plusieurs façons d’utiliser la méthode <strong>[asdict]</strong> :</li>
<li>on veut toutes les propriétés : on utilise la méthode <strong>[asdict]</strong> sans paramètres ;</li>
<li>on ne veut que certaines propriétés :</li>
<li>il y a plus de propriétés à inclure qu’à exclure : on utilisera le seul paramètre <strong>[excluded_keys]</strong> ;</li>
<li>il y a moins de propriétés à inclure qu’à exclure : on utilisera le seul paramètre <strong>[included_keys]</strong> ;</li>
</ul>
<h3 id="1323-la-methode-baseentityasjson">13.2.3. La méthode [BaseEntity.asjson]</h3>
<p>Cette méthode permet d’obtenir la chaîne jSON d’un objet <strong>[BaseEntity]</strong> ou dérivé. Elle affiche la chaîne jSON du dictionnaire rendu par la méthode <strong>[asdict]</strong>. Son code est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">asjson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">included_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">excluded_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a>        <span class="c1"># la chaîne json</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">included_keys</span><span class="o">=</span><span class="n">included_keys</span><span class="p">,</span> <span class="n">excluded_keys</span><span class="o">=</span><span class="n">excluded_keys</span><span class="p">),</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 1 : les paramètres de la méthode <strong>[asjson]</strong> sont ceux de la méthode <strong>[asdict]</strong> ;
Voici un exemple (asjson_01) utilisant cette méthode :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span>
<span class="normal"><a href="#__codelineno-23-27">27</a></span>
<span class="normal"><a href="#__codelineno-23-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">})</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">enseignant1</span><span class="o">.</span><span class="n">asjson</span><span class="p">()))</span>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant1</span><span class="o">.</span><span class="n">asjson</span><span class="p">(</span><span class="n">excluded_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_Personne__âge&quot;</span><span class="p">]))</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="n">Enseignant</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_Personne__prénom&quot;</span><span class="p">]</span>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant1</span><span class="o">.</span><span class="n">asjson</span><span class="p">())</span>
<a id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="c1"># un autre enseignant</span>
<a id="__codelineno-23-16" name="__codelineno-23-16"></a><span class="n">enseignant2</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;béatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">})</span>
<a id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant2</span><span class="o">.</span><span class="n">asjson</span><span class="p">())</span>
<a id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">enseignant2</span><span class="o">.</span><span class="n">asjson</span><span class="p">(</span><span class="n">included_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_Personne__nom&quot;</span><span class="p">]))</span>
<a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="c1"># une liste d&#39;entités dans une entité</span>
<a id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="n">Enseignant</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-23-21" name="__codelineno-23-21"></a><span class="n">entity1</span> <span class="o">=</span> <span class="n">BaseEntity</span><span class="p">()</span>
<a id="__codelineno-23-22" name="__codelineno-23-22"></a><span class="n">enseignants</span> <span class="o">=</span> <span class="p">[</span><span class="n">enseignant1</span><span class="p">,</span> <span class="n">enseignant2</span><span class="p">]</span>
<a id="__codelineno-23-23" name="__codelineno-23-23"></a><span class="nb">setattr</span><span class="p">(</span><span class="n">entity1</span><span class="p">,</span> <span class="s2">&quot;enseignants&quot;</span><span class="p">,</span> <span class="n">enseignants</span><span class="p">)</span>
<a id="__codelineno-23-24" name="__codelineno-23-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">entity1</span><span class="o">.</span><span class="n">asjson</span><span class="p">())</span>
<a id="__codelineno-23-25" name="__codelineno-23-25"></a><span class="c1"># un dictionnaire d&#39;entités dans une entité</span>
<a id="__codelineno-23-26" name="__codelineno-23-26"></a><span class="n">matières</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;maths&quot;</span><span class="p">:</span> <span class="n">enseignant1</span><span class="p">,</span> <span class="s2">&quot;français&quot;</span><span class="p">:</span> <span class="n">enseignant2</span><span class="p">}</span>
<a id="__codelineno-23-27" name="__codelineno-23-27"></a><span class="nb">setattr</span><span class="p">(</span><span class="n">entity1</span><span class="p">,</span> <span class="s2">&quot;matières&quot;</span><span class="p">,</span> <span class="n">matières</span><span class="p">)</span>
<a id="__codelineno-23-28" name="__codelineno-23-28"></a><span class="nb">print</span><span class="p">(</span><span class="n">entity1</span><span class="o">.</span><span class="n">asjson</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p>Les résultats sont les suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">asjson_01</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">str</span><span class="s1">&#39;&gt;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">}</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">}</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}</span>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="p">{</span><span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">}</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="p">{</span><span class="s2">&quot;enseignants&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;béatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}]}</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="p">{</span><span class="s2">&quot;enseignants&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;béatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}],</span> <span class="s2">&quot;matières&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;maths&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">},</span> <span class="s2">&quot;français&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;abélard&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;béatrice&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">57</span><span class="p">}}}</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>La méthode <strong>[BaseEntity.<strong>str</strong>]</strong> utilise la méthode <strong>[asjson]</strong> pour afficher l’identité de l’objet <strong>[BaseEntity]</strong> ou dérivé :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># toString</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asjson</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h3 id="1324-la-methode-baseentityfromjson">13.2.4. La méthode [BaseEntity.fromjson]</h3>
<p>La méthode <strong>[BaseEntity.fromjson]</strong> permet d’initialiser un objet de type <strong>[BaseEntity]</strong> ou dérivé à partir d’un dictionnaire jSON. Son code est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">fromjson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_state</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">silent</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a>        <span class="c1"># on met à jour l&#39;état de l&#39;objet à partir de la chaîne jSON</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_state</span><span class="p">),</span> <span class="n">silent</span><span class="o">=</span><span class="n">silent</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 1 : la méthode admet deux paramètres :</li>
<li><strong>[json_state]</strong> : le dictionnaire jSON qui va servir à initialiser l’objet <strong>[BaseEntity]</strong> ;</li>
<li><strong>[silent]</strong> : pour indiquer si la présence dans le dictionnaire jSON d’une clé qui ne peut être acceptée comme propriété de l’objet <strong>[BaseEntity]</strong> provoque une exception (silent=False) ou est simplement ignorée (silent=True) ;</li>
<li>ligne 3 : on commence par construire le dictionnaire Python image du dictionnaire jSON, puis on utilise la méthode <strong>[fromdict]</strong> pour initialiser l’objet <strong>[BaseEntity]</strong> à partir de ce dictionnaire Python ;
Voici un exemple (fromjson_01) :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span>
<span class="normal"><a href="#__codelineno-27-11">11</a></span>
<span class="normal"><a href="#__codelineno-27-12">12</a></span>
<span class="normal"><a href="#__codelineno-27-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Enseignant</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enseignant</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="c1"># un enseignant</span>
<a id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="n">json1</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;lourou&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;paul&quot;</span><span class="p">,</span> <span class="s2">&quot;âge&quot;</span><span class="p">:</span> <span class="mi">56</span><span class="p">})</span>
<a id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="n">enseignant1</span> <span class="o">=</span> <span class="n">Enseignant</span><span class="p">()</span><span class="o">.</span><span class="n">fromjson</span><span class="p">(</span><span class="n">json1</span><span class="p">)</span>
<a id="__codelineno-27-13" name="__codelineno-27-13"></a><span class="n">enseignant1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 11 : on crée la chaîne jSON d’un dictionnaire ;</li>
<li>ligne 12 : un objet <strong>[Enseignant]</strong> est initialisé avec cette chaîne ;</li>
<li>ligne 13 : l’enseignant est affiché ;
Les résultats sont les suivants :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span>
<span class="normal"><a href="#__codelineno-28-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">fromjson_01</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="n">Enseignant</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">paul</span><span class="p">,</span> <span class="n">lourou</span><span class="p">,</span> <span class="mi">56</span><span class="p">]</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<h3 id="1325-le-script-main">13.2.5. Le script [main]</h3>
<p>Le script <strong>[main]</strong> récapitule les différentes méthodes rencontrées :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span>
<span class="normal"><a href="#__codelineno-29-18">18</a></span>
<span class="normal"><a href="#__codelineno-29-19">19</a></span>
<span class="normal"><a href="#__codelineno-29-20">20</a></span>
<span class="normal"><a href="#__codelineno-29-21">21</a></span>
<span class="normal"><a href="#__codelineno-29-22">22</a></span>
<span class="normal"><a href="#__codelineno-29-23">23</a></span>
<span class="normal"><a href="#__codelineno-29-24">24</a></span>
<span class="normal"><a href="#__codelineno-29-25">25</a></span>
<span class="normal"><a href="#__codelineno-29-26">26</a></span>
<span class="normal"><a href="#__codelineno-29-27">27</a></span>
<span class="normal"><a href="#__codelineno-29-28">28</a></span>
<span class="normal"><a href="#__codelineno-29-29">29</a></span>
<span class="normal"><a href="#__codelineno-29-30">30</a></span>
<span class="normal"><a href="#__codelineno-29-31">31</a></span>
<span class="normal"><a href="#__codelineno-29-32">32</a></span>
<span class="normal"><a href="#__codelineno-29-33">33</a></span>
<span class="normal"><a href="#__codelineno-29-34">34</a></span>
<span class="normal"><a href="#__codelineno-29-35">35</a></span>
<span class="normal"><a href="#__codelineno-29-36">36</a></span>
<span class="normal"><a href="#__codelineno-29-37">37</a></span>
<span class="normal"><a href="#__codelineno-29-38">38</a></span>
<span class="normal"><a href="#__codelineno-29-39">39</a></span>
<span class="normal"><a href="#__codelineno-29-40">40</a></span>
<span class="normal"><a href="#__codelineno-29-41">41</a></span>
<span class="normal"><a href="#__codelineno-29-42">42</a></span>
<span class="normal"><a href="#__codelineno-29-43">43</a></span>
<span class="normal"><a href="#__codelineno-29-44">44</a></span>
<span class="normal"><a href="#__codelineno-29-45">45</a></span>
<span class="normal"><a href="#__codelineno-29-46">46</a></span>
<span class="normal"><a href="#__codelineno-29-47">47</a></span>
<span class="normal"><a href="#__codelineno-29-48">48</a></span>
<span class="normal"><a href="#__codelineno-29-49">49</a></span>
<span class="normal"><a href="#__codelineno-29-50">50</a></span>
<span class="normal"><a href="#__codelineno-29-51">51</a></span>
<span class="normal"><a href="#__codelineno-29-52">52</a></span>
<span class="normal"><a href="#__codelineno-29-53">53</a></span>
<span class="normal"><a href="#__codelineno-29-54">54</a></span>
<span class="normal"><a href="#__codelineno-29-55">55</a></span>
<span class="normal"><a href="#__codelineno-29-56">56</a></span>
<span class="normal"><a href="#__codelineno-29-57">57</a></span>
<span class="normal"><a href="#__codelineno-29-58">58</a></span>
<span class="normal"><a href="#__codelineno-29-59">59</a></span>
<span class="normal"><a href="#__codelineno-29-60">60</a></span>
<span class="normal"><a href="#__codelineno-29-61">61</a></span>
<span class="normal"><a href="#__codelineno-29-62">62</a></span>
<span class="normal"><a href="#__codelineno-29-63">63</a></span>
<span class="normal"><a href="#__codelineno-29-64">64</a></span>
<span class="normal"><a href="#__codelineno-29-65">65</a></span>
<span class="normal"><a href="#__codelineno-29-66">66</a></span>
<span class="normal"><a href="#__codelineno-29-67">67</a></span>
<span class="normal"><a href="#__codelineno-29-68">68</a></span>
<span class="normal"><a href="#__codelineno-29-69">69</a></span>
<span class="normal"><a href="#__codelineno-29-70">70</a></span>
<span class="normal"><a href="#__codelineno-29-71">71</a></span>
<span class="normal"><a href="#__codelineno-29-72">72</a></span>
<span class="normal"><a href="#__codelineno-29-73">73</a></span>
<span class="normal"><a href="#__codelineno-29-74">74</a></span>
<span class="normal"><a href="#__codelineno-29-75">75</a></span>
<span class="normal"><a href="#__codelineno-29-76">76</a></span>
<span class="normal"><a href="#__codelineno-29-77">77</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="c1"># une classe</span>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChildEntity</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a>    <span class="c1"># attributs exclus de l&#39;état de la classe</span>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-29-15" name="__codelineno-29-15"></a>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">():</span>
<a id="__codelineno-29-18" name="__codelineno-29-18"></a>        <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;att1&quot;</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">,</span> <span class="s2">&quot;att3&quot;</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">]</span>
<a id="__codelineno-29-19" name="__codelineno-29-19"></a>
<a id="__codelineno-29-20" name="__codelineno-29-20"></a>    <span class="nd">@property</span>
<a id="__codelineno-29-21" name="__codelineno-29-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">att1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-29-22" name="__codelineno-29-22"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__att1</span>
<a id="__codelineno-29-23" name="__codelineno-29-23"></a>
<a id="__codelineno-29-24" name="__codelineno-29-24"></a>    <span class="nd">@att1</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-29-25" name="__codelineno-29-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">att1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-29-26" name="__codelineno-29-26"></a>        <span class="k">if</span> <span class="mi">10</span> <span class="o">&gt;=</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-29-27" name="__codelineno-29-27"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__att1</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-29-28" name="__codelineno-29-28"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-29-29" name="__codelineno-29-29"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;L&#39;attribut [att1] attend une valeur dans l&#39;intervalle [1,10] (</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<a id="__codelineno-29-30" name="__codelineno-29-30"></a>
<a id="__codelineno-29-31" name="__codelineno-29-31"></a>
<a id="__codelineno-29-32" name="__codelineno-29-32"></a><span class="c1"># configuration ChildEntity</span>
<a id="__codelineno-29-33" name="__codelineno-29-33"></a><span class="n">ChildEntity</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-29-34" name="__codelineno-29-34"></a><span class="c1"># instance ChildEntity</span>
<a id="__codelineno-29-35" name="__codelineno-29-35"></a><span class="n">child</span> <span class="o">=</span> <span class="n">ChildEntity</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<a id="__codelineno-29-36" name="__codelineno-29-36"></a><span class="c1"># attention aux noms des propriétés</span>
<a id="__codelineno-29-37" name="__codelineno-29-37"></a><span class="c1"># ce sont ces noms qui sont utilisés dans [excluded_keys] et [included_keys]</span>
<a id="__codelineno-29-38" name="__codelineno-29-38"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
<a id="__codelineno-29-39" name="__codelineno-29-39"></a><span class="c1"># propriétés non préfixées par leur classe</span>
<a id="__codelineno-29-40" name="__codelineno-29-40"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<a id="__codelineno-29-41" name="__codelineno-29-41"></a>
<a id="__codelineno-29-42" name="__codelineno-29-42"></a><span class="c1"># instance ChildEntity</span>
<a id="__codelineno-29-43" name="__codelineno-29-43"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-29-44" name="__codelineno-29-44"></a>    <span class="n">child</span> <span class="o">=</span> <span class="n">ChildEntity</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att5&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
<a id="__codelineno-29-45" name="__codelineno-29-45"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<a id="__codelineno-29-46" name="__codelineno-29-46"></a><span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-29-47" name="__codelineno-29-47"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">erreur</span><span class="p">)</span>
<a id="__codelineno-29-48" name="__codelineno-29-48"></a>
<a id="__codelineno-29-49" name="__codelineno-29-49"></a><span class="c1"># instance ChildEntity</span>
<a id="__codelineno-29-50" name="__codelineno-29-50"></a><span class="n">child</span> <span class="o">=</span> <span class="n">ChildEntity</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;att3&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<a id="__codelineno-29-51" name="__codelineno-29-51"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<a id="__codelineno-29-52" name="__codelineno-29-52"></a>
<a id="__codelineno-29-53" name="__codelineno-29-53"></a><span class="c1"># exclusions de certaines clés de l&#39;état des instances</span>
<a id="__codelineno-29-54" name="__codelineno-29-54"></a><span class="n">ChildEntity</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;att3&#39;</span><span class="p">]</span>
<a id="__codelineno-29-55" name="__codelineno-29-55"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<a id="__codelineno-29-56" name="__codelineno-29-56"></a>
<a id="__codelineno-29-57" name="__codelineno-29-57"></a><span class="c1"># on exclut une clé explicitement de l&#39;affichage</span>
<a id="__codelineno-29-58" name="__codelineno-29-58"></a><span class="c1"># elle se rajoute à celles exclues globalement au niveau de la classe</span>
<a id="__codelineno-29-59" name="__codelineno-29-59"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">excluded_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_ChildEntity__att1&quot;</span><span class="p">]))</span>
<a id="__codelineno-29-60" name="__codelineno-29-60"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">asjson</span><span class="p">(</span><span class="n">excluded_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;att2&quot;</span><span class="p">]))</span>
<a id="__codelineno-29-61" name="__codelineno-29-61"></a>
<a id="__codelineno-29-62" name="__codelineno-29-62"></a><span class="c1"># intérêt de la classe vis à vis du dictionnaire</span>
<a id="__codelineno-29-63" name="__codelineno-29-63"></a><span class="c1"># elle peut vérifier la validité de son contenu</span>
<a id="__codelineno-29-64" name="__codelineno-29-64"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-29-65" name="__codelineno-29-65"></a>    <span class="n">child</span> <span class="o">=</span> <span class="n">ChildEntity</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
<a id="__codelineno-29-66" name="__codelineno-29-66"></a><span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-29-67" name="__codelineno-29-67"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">erreur</span><span class="p">)</span>
<a id="__codelineno-29-68" name="__codelineno-29-68"></a>
<a id="__codelineno-29-69" name="__codelineno-29-69"></a><span class="c1"># instance ChildEntity</span>
<a id="__codelineno-29-70" name="__codelineno-29-70"></a><span class="n">child1</span> <span class="o">=</span> <span class="n">ChildEntity</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;att3&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<a id="__codelineno-29-71" name="__codelineno-29-71"></a><span class="c1"># instanche ChildEntity contenant une autre instance ChildEntity</span>
<a id="__codelineno-29-72" name="__codelineno-29-72"></a><span class="n">child2</span> <span class="o">=</span> <span class="n">ChildEntity</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;att3&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="n">child1</span><span class="p">})</span>
<a id="__codelineno-29-73" name="__codelineno-29-73"></a><span class="nb">print</span><span class="p">(</span><span class="n">child2</span><span class="p">)</span>
<a id="__codelineno-29-74" name="__codelineno-29-74"></a>
<a id="__codelineno-29-75" name="__codelineno-29-75"></a><span class="c1"># included_keys a priorité sur excluded_keys qui sont alors ignorées</span>
<a id="__codelineno-29-76" name="__codelineno-29-76"></a><span class="n">ChildEntity</span><span class="o">.</span><span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_ChildEntity__att1&#39;</span><span class="p">,</span> <span class="s1">&#39;att2&#39;</span><span class="p">]</span>
<a id="__codelineno-29-77" name="__codelineno-29-77"></a><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">included_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;_ChildEntity__att1&quot;</span><span class="p">,</span> <span class="s2">&quot;att3&quot;</span><span class="p">],</span> <span class="n">excluded_keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;att3&quot;</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
<p>Les résultats de l’exécution sont les suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-30-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-30-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-30-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-30-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-30-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-30-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-30-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-30-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-30-10">10</a></span>
<span class="normal"><a href="#__codelineno-30-11">11</a></span>
<span class="normal"><a href="#__codelineno-30-12">12</a></span>
<span class="normal"><a href="#__codelineno-30-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">classes</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="p">{</span><span class="s1">&#39;_ChildEntity__att1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;att2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="p">{</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="n">MyException</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">la</span> <span class="n">clé</span> <span class="p">[</span><span class="n">att5</span><span class="p">]</span> <span class="n">n</span><span class="s1">&#39;est pas autorisée]</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="p">{</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;att3&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="p">{</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="p">{</span><span class="s1">&#39;att2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;att4&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="p">{</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<a id="__codelineno-30-9" name="__codelineno-30-9"></a><span class="n">MyException</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;attribut [att1] attend une valeur dans l&#39;</span><span class="n">intervalle</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span> <span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<a id="__codelineno-30-10" name="__codelineno-30-10"></a><span class="p">{</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;att1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;att2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;att4&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}}</span>
<a id="__codelineno-30-11" name="__codelineno-30-11"></a><span class="p">{</span><span class="s1">&#39;att1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;att3&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<a id="__codelineno-30-12" name="__codelineno-30-12"></a>
<a id="__codelineno-30-13" name="__codelineno-30-13"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>On prêtera attention à la ligne 2 des résultats : c’est la propriété <strong>[ChildEntity.<strong>dict</strong>]</strong> (ligne 38 du code) qui nous permet de connaître les noms des propriétés à mettre dans les listes <strong>[included_keys]</strong> et <strong>[excluded_keys]</strong>. On notera, toujours ligne 2 des résultats, que selon que la propriété est définie à l’intérieur de la classe par un getter / setter ou qu’elle a été créée comme on créerait la clé d’un dictionnaire, elle est ou pas préfixée par le nom de la classe <strong>[ChildEntity]</strong>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner">

      <div>
        <a href="https://tahe.developpez.com" target="_blank">
          https://tahe.developpez.com
        </a>
        <br>
        Ce cours tutoriel écrit par <strong>Serge Tahé</strong> est mis à disposition du public selon les termes de la
        <em>Licence Creative Commons Attribution – Pas d’Utilisation Commerciale –
        Partage dans les Mêmes Conditions 3.0 non transposé</em>.
      </div>

    </div>
  </div>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections", "navigation.indexes", "toc.integrate", "navigation.top"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="javascripts/focus.js"></script>
      
    
  </body>
</html>