
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Introduction au langage Python 3 et au framework web Flask par l'exemple">
      
      
        <meta name="author" content="Serge Tahé">
      
      
        <link rel="canonical" href="https://stahe.github.io/python-flask-sept-2020/architecture-en-couches-et-programmation-par-interfaces.html">
      
      
        <link rel="prev" href="les-classes-generiques-baseentity-et-myexception.html">
      
      
        <link rel="next" href="exercice-dx27application---version-4.html">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>14. Architecture en couches et programmation par interfaces - Introduction au langage Python 3 et au framework web Flask par l'exemple</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/focus.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#14-architecture-en-couches-et-programmation-par-interfaces" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Introduction au langage Python 3 et au framework web Flask par l&#39;exemple" class="md-header__button md-logo" aria-label="Introduction au langage Python 3 et au framework web Flask par l'exemple" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Introduction au langage Python 3 et au framework web Flask par l'exemple
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              14. Architecture en couches et programmation par interfaces
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passer au mode sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Passer au mode clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passer au mode clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/stahe/python-flask-sept-2020" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Introduction au langage Python 3 et au framework web Flask par l&#39;exemple" class="md-nav__button md-logo" aria-label="Introduction au langage Python 3 et au framework web Flask par l'exemple" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Introduction au langage Python 3 et au framework web Flask par l'exemple
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stahe/python-flask-sept-2020" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accueil
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="avant-propos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Avant-propos
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="installation-dx27un-environnement-de-travail.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Installation d&#x27;un environnement de travail
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-bases-de-python.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Les bases de Python
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-chaines-de-caracteres.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Les chaînes de caractères
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-exceptions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Les exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fonctions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Les fonctions
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-fichiers-texte.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Les fichiers texte
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dx27application---version-1.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Exercice d&#x27;application – version 1
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-imports.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Les imports
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Exercice d’application : version 2
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-3.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Exercice d’application : version 3
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-classes-et-objets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Les classes et objets
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="les-classes-generiques-baseentity-et-myexception.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Les classes génériques [BaseEntity] et [MyException]
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    14. Architecture en couches et programmation par interfaces
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="architecture-en-couches-et-programmation-par-interfaces.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Architecture en couches et programmation par interfaces
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#141-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.1. Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#142-exemple-1" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2. Exemple 1
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.2. Exemple 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1421-les-entites-de-lapplication" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.1. Les entités de l&#x27;application
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.2.1. Les entités de l&#39;application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14211-lentite-classe" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.1.1. L&#x27;entité [Classe]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14212-lentite-matiere" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.1.2. L&#x27;entité [Matière]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14213-lentite-eleve" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.1.3. L&#x27;entité [Elève]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14214-lentite-note" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.1.4. L&#x27;entité [Note]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1422-configuration-de-lapplication" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.2. Configuration de l’application
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1423-tests-des-entites" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.3. Tests des entités
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.2.3. Tests des entités">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14231-la-classe-de-tests-testbaseentity" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.3.1. La classe de tests [TestBaseEntity]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14232-la-classe-de-tests-testentites" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.3.2. La classe de tests [TestEntités]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1424-la-couche-dao" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.4. La couche [dao]
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.2.4. La couche [dao]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14241-interface-interfacedao" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.4.1. Interface [InterfaceDao]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14242-implementation-dao" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.4.2. Implémentation [Dao]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1425-la-couche-metier" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.5. La couche [métier]
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.2.5. La couche [métier]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14251-interface-interfacemetier" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.5.1. Interface [InterfaceMétier]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14252-lentite-statsforeleve" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.5.2. L&#x27;entité [StatsForElève]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14253-limplementation-metier" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.5.3. L&#x27;implémentation [Métier]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14254-test-de-la-couche-metier" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.5.4. Test de la couche [métier]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1426-la-couche-ui" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.6. La couche [ui]
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.2.6. La couche [ui]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#14261-interface-interfaceui" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.6.1. Interface [InterfaceUi]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14262-limplementation-console" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.2.6.2. L&#x27;implémentation [Console]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#143-le-script-principal-main" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.3. Le script principal [main]
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#144-exemple-2" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.4. Exemple 2
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="14.4. Exemple 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1441-la-couche-dao" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.4.1. La couche [dao]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1442-la-couche-metier" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.4.2. La couche [métier]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1443-la-couche-ui" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.4.3. La couche [ui]
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1444-les-fichiers-de-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.4.4. Les fichiers de configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1445-le-script-principal-main" class="md-nav__link">
    <span class="md-ellipsis">
      
        14.4.5. Le script principal [main]
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dx27application---version-4.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Exercice d&#x27;application - version 4
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilisation-du-sgbd-mysql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. Utilisation du SGBD MySQL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilisation-du-sgbd-postgresql.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Utilisation du SGBD PostgreSQL
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="ecrire-du-code-independant-du-sgbd.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. Ecrire du code indépendant du SGBD
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utilisation-de-lorm-sqlalchemy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. Utilisation de l’ORM SQLALCHEMY
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dx27application-version-5.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Exercice d&#x27;application : version 5
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="fonctions-internet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Fonctions internet
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="services-web-avec-le-framework-flask.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Services web avec le framework Flask
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-6.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. Exercice d’application : version 6
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-7.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. Exercice d’application : version 7
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-8.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. Exercice d’application : version 8
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="du-dictionnaire-a-xml-et-vice-versa.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. Du dictionnaire à XML et vice-versa
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-9.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. Exercice d’application : version 9
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-10.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. Exercice d’application : version 10
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-11.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. Exercice d’application : version 11
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-12.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. Exercice d’application : version 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="clients-web-pour-les-services-json-et-xml-de-la-version-12.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. Clients web pour les services jSON et XML de la version 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="le-mode-html-de-la-version-12.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Le mode HTML de la version 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-13.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. Exercice d’application : version 13
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-14.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. Exercice d’application : version 14
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-15.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. Exercice d’application : version 15
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-16.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    36. Exercice d’application : version 16
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-17.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Exercice d’application : version 17
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="exercice-dapplication-version-18.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. Exercice d’application : version 18
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="conclusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. Conclusion
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="14-architecture-en-couches-et-programmation-par-interfaces">14. Architecture en couches et programmation par interfaces</h1>
<h2 id="141-introduction">14.1. Introduction</h2>
<p>Nous nous proposons d&#x27;écrire une application permettant l&#x27;affichage des notes des élèves d&#x27;un collège. Cette application peut avoir une architecture multicouche :</p>
<p><img src="images/1000000100000366000000ABD38E9B95.png" style="width:11.881cm;height:2.331cm;" alt="Image" /></p>
<ul>
<li>la couche <strong>[</strong><strong>ui</strong><strong>]</strong> (<strong>U</strong>ser <strong>I</strong>nterface) est la couche en contact avec l&#x27;utilisateur de l&#x27;application ;</li>
<li>la couche <strong>[</strong><strong>métier</strong><strong>]</strong> implémente les règles de gestion de l&#x27;application, tels que le calcul d&#x27;un salaire ou d&#x27;une facture. Cette couche utilise des données provenant de l&#x27;utilisateur via la couche <strong>[présentation]</strong> et du SGBD via la couche <strong>[dao]</strong> ;</li>
<li>la couche <strong>[</strong><strong>dao</strong><strong>]</strong> (<strong>D</strong>ata <strong>A</strong>ccess <strong>O</strong>bjects) gère l&#x27;accès aux données du SGBD (Système de Gestion de Bases de Données).
C&#x27;est l&#x27;architecture qui avait été utilisée dans le |<a href="https://tahe.developpez.com/tutoriels-cours/python-2012/"><u><u>cours sur Python 2</u></u></a>|. On peut également introduire une variante :</li>
</ul>
<p><img src="images/100000010000036D00000113F6F5317B.png" style="width:11.69cm;height:3.661cm;" alt="Image" /></p>
<p>Les différences vis à vis de la structure en couches précédente sont les suivantes :</p>
<ul>
<li>un script principal appelé <strong>[main]</strong> ci-dessus organise l&#x27;instanciation des couches ;</li>
<li>
<p>les couches <strong>[ui, métier, dao]</strong> ne communiquent plus forcément entre-elles. Si elles le doivent, le script <strong>[main]</strong> leur fournit les références des couches dont elles ont besoin ;
Le code est ici organisé en centres de compétences avec un chef d&#x27;orchestre :</p>
</li>
<li>
<p>le chef d&#x27;orchestre est le script principal <strong>[main]</strong> ;</p>
</li>
<li>les couches <strong>[ui]</strong>, <strong>[dao]</strong> et <strong>[métier]</strong> sont les centres de compétences ;
On pourrait appeler cette organisation, une organisation <strong>orchestrale</strong>.</li>
</ul>
<h2 id="142-exemple-1">14.2. Exemple 1</h2>
<p>Nous allons illustrer l’architecture en couches avec une application console simple :</p>
<ul>
<li>il n&#x27;y aura pas de base de données ;</li>
<li>la couche <strong>[dao]</strong> gèrera des entités Elève, Classe, Matière, Note permettant de gérer les notes des élèves ;</li>
<li>la couche <strong>[métier]</strong> permettra de calculer des indicateurs sur les notes d&#x27;un élève précis ;</li>
<li>la couche <strong>[ui]</strong> sera une application console qui affichera les résultats des élèves ;
Le projet PyCharm de l&#x27;application est le suivant :</li>
</ul>
<p><img src="images/1000000100000128000002B0930A5206.png" style="width:2.761cm;height:6.411cm;" alt="Image" /></p>
<p><strong>Note</strong> : les dossiers en bleu font partie des <strong>[Sources Root]</strong> du projet PyCharm.</p>
<h3 id="1421-les-entites-de-lapplication">14.2.1. Les entités de l&#x27;application</h3>
<p>On appellera entités, des classes dont le seul rôle est d&#x27;encapsuler des données. On pourrait pour ce faire utiliser des dictionnaires. L&#x27;intérêt de la classe est de permettre de tester la validité des données stockées dans l&#x27;objet et de fournir une méthode fournissant l&#x27;identité de l&#x27;objet sous la forme d&#x27;une chaîne de caractères.</p>
<p><img src="images/10000000000001230000011048549434.png" style="width:3.361cm;height:3.14cm;" alt="Image" /></p>
<h4 id="14211-lentite-classe">14.2.1.1. L&#x27;entité [Classe]</h4>
<p>L&#x27;entité <strong>[Classe]</strong> (Classe.py) représente une classe du collège :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># imports</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Utils</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">Classe</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="c1"># attributs exclus de l&#39;état de la classe</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>        <span class="c1"># id : identifiant de la classe</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>        <span class="c1"># nom : nom de la classe</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>        <span class="k">return</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;nom&quot;</span><span class="p">]</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="c1"># getter</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="nd">@property</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>    <span class="c1">#  setters</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>    <span class="nd">@nom</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">nom</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="c1"># nom doit être une chaîne de caractères non vide</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">nom</span><span class="p">):</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span> <span class="o">=</span> <span class="n">nom</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Le nom de la classe </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 7 : l&#x27;entité <strong>[Classe]</strong> dérive de l&#x27;entité <strong>[BaseEntity]</strong> étudiée au paragraphe |<a href="#_La_classe_[BaseEntity]"><u><u>La classe BaseEntity</u></u></a>| ;</li>
<li>lignes 11-16 : une classe est définie par un n° id et un nom (ligne 16). La propriété <strong>[id]</strong> est fournie par la classe <strong>[BaseEntity]</strong> et le nom par la classe <strong>[Classe]</strong> ;</li>
<li>lignes 18-30 : getter / setter de l&#x27;attribut <strong>[nom]</strong> ;</li>
</ul>
<h4 id="14212-lentite-matiere">14.2.1.2. L&#x27;entité [Matière]</h4>
<p>La classe <strong>[Matière]</strong> (matière.py) est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span>
<span class="normal"><a href="#__codelineno-1-48">48</a></span>
<span class="normal"><a href="#__codelineno-1-49">49</a></span>
<span class="normal"><a href="#__codelineno-1-50">50</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># imports</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Utils</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">Matière</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="c1"># attributs exclus de l&#39;état de la classe</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>        <span class="c1"># id : identifiant de la matière</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>        <span class="c1"># nom : nom de la matière</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>        <span class="c1"># coefficient : coefficient de la matière</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>        <span class="k">return</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;nom&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">]</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a>    <span class="c1"># getter</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>    <span class="nd">@property</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>    <span class="nd">@property</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coefficient</span>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a>    <span class="c1">#  setters</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a>    <span class="nd">@nom</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">nom</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a>        <span class="c1"># nom doit être une chaîne de caractères non vide</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">nom</span><span class="p">):</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span> <span class="o">=</span> <span class="n">nom</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Le nom de la matière </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a>    <span class="nd">@coefficient</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coefficient</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a>        <span class="c1"># le coefficient doit être un réel &gt;=0</span>
<a id="__codelineno-1-40" name="__codelineno-1-40"></a>        <span class="n">erreur</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-1-41" name="__codelineno-1-41"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coefficient</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
<a id="__codelineno-1-42" name="__codelineno-1-42"></a>            <span class="k">if</span> <span class="n">coefficient</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__coefficient</span> <span class="o">=</span> <span class="n">coefficient</span>
<a id="__codelineno-1-44" name="__codelineno-1-44"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-1-45" name="__codelineno-1-45"></a>                <span class="n">erreur</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-1-46" name="__codelineno-1-46"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-1-47" name="__codelineno-1-47"></a>            <span class="n">erreur</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-1-48" name="__codelineno-1-48"></a>        <span class="c1"># erreur ?</span>
<a id="__codelineno-1-49" name="__codelineno-1-49"></a>        <span class="k">if</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-1-50" name="__codelineno-1-50"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Le coefficient de la matière </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nom</span><span class="si">}</span><span class="s2"> doit être un réel &gt;=0&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 7 : la classe <strong>[Classe]</strong> dérive de la classe <strong>[BaseEntity]</strong> ;</li>
<li>lignes 11-17 : une matière est définie par son n° <strong>[id]</strong>, son nom <strong>[nom]</strong>, son coefficient <strong>[coefficient]</strong> ;</li>
<li>lignes 19-50 : getters / setters des attributs de la classe ;</li>
</ul>
<h4 id="14213-lentite-eleve">14.2.1.3. L&#x27;entité [Elève]</h4>
<p>La classe <strong>[Elève]</strong> (élève.py) est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span>
<span class="normal"><a href="#__codelineno-2-32">32</a></span>
<span class="normal"><a href="#__codelineno-2-33">33</a></span>
<span class="normal"><a href="#__codelineno-2-34">34</a></span>
<span class="normal"><a href="#__codelineno-2-35">35</a></span>
<span class="normal"><a href="#__codelineno-2-36">36</a></span>
<span class="normal"><a href="#__codelineno-2-37">37</a></span>
<span class="normal"><a href="#__codelineno-2-38">38</a></span>
<span class="normal"><a href="#__codelineno-2-39">39</a></span>
<span class="normal"><a href="#__codelineno-2-40">40</a></span>
<span class="normal"><a href="#__codelineno-2-41">41</a></span>
<span class="normal"><a href="#__codelineno-2-42">42</a></span>
<span class="normal"><a href="#__codelineno-2-43">43</a></span>
<span class="normal"><a href="#__codelineno-2-44">44</a></span>
<span class="normal"><a href="#__codelineno-2-45">45</a></span>
<span class="normal"><a href="#__codelineno-2-46">46</a></span>
<span class="normal"><a href="#__codelineno-2-47">47</a></span>
<span class="normal"><a href="#__codelineno-2-48">48</a></span>
<span class="normal"><a href="#__codelineno-2-49">49</a></span>
<span class="normal"><a href="#__codelineno-2-50">50</a></span>
<span class="normal"><a href="#__codelineno-2-51">51</a></span>
<span class="normal"><a href="#__codelineno-2-52">52</a></span>
<span class="normal"><a href="#__codelineno-2-53">53</a></span>
<span class="normal"><a href="#__codelineno-2-54">54</a></span>
<span class="normal"><a href="#__codelineno-2-55">55</a></span>
<span class="normal"><a href="#__codelineno-2-56">56</a></span>
<span class="normal"><a href="#__codelineno-2-57">57</a></span>
<span class="normal"><a href="#__codelineno-2-58">58</a></span>
<span class="normal"><a href="#__codelineno-2-59">59</a></span>
<span class="normal"><a href="#__codelineno-2-60">60</a></span>
<span class="normal"><a href="#__codelineno-2-61">61</a></span>
<span class="normal"><a href="#__codelineno-2-62">62</a></span>
<span class="normal"><a href="#__codelineno-2-63">63</a></span>
<span class="normal"><a href="#__codelineno-2-64">64</a></span>
<span class="normal"><a href="#__codelineno-2-65">65</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1"># imports</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Utils</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">Elève</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>    <span class="c1"># attributs exclus de l&#39;état de la classe</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a>        <span class="c1"># id : identifiant de l&#39;élève</span>
<a id="__codelineno-2-17" name="__codelineno-2-17"></a>        <span class="c1"># nom : nom de l&#39;élève</span>
<a id="__codelineno-2-18" name="__codelineno-2-18"></a>        <span class="c1"># prénom : prénom de l&#39;élève</span>
<a id="__codelineno-2-19" name="__codelineno-2-19"></a>        <span class="c1"># classe : classe de l&#39;élève</span>
<a id="__codelineno-2-20" name="__codelineno-2-20"></a>        <span class="k">return</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;nom&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">]</span>
<a id="__codelineno-2-21" name="__codelineno-2-21"></a>
<a id="__codelineno-2-22" name="__codelineno-2-22"></a>    <span class="c1"># getters</span>
<a id="__codelineno-2-23" name="__codelineno-2-23"></a>    <span class="nd">@property</span>
<a id="__codelineno-2-24" name="__codelineno-2-24"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-2-25" name="__codelineno-2-25"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span>
<a id="__codelineno-2-26" name="__codelineno-2-26"></a>
<a id="__codelineno-2-27" name="__codelineno-2-27"></a>    <span class="nd">@property</span>
<a id="__codelineno-2-28" name="__codelineno-2-28"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prénom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-2-29" name="__codelineno-2-29"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__prénom</span>
<a id="__codelineno-2-30" name="__codelineno-2-30"></a>
<a id="__codelineno-2-31" name="__codelineno-2-31"></a>    <span class="nd">@property</span>
<a id="__codelineno-2-32" name="__codelineno-2-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">classe</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Classe</span><span class="p">:</span>
<a id="__codelineno-2-33" name="__codelineno-2-33"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__classe</span>
<a id="__codelineno-2-34" name="__codelineno-2-34"></a>
<a id="__codelineno-2-35" name="__codelineno-2-35"></a>    <span class="c1">#  setters</span>
<a id="__codelineno-2-36" name="__codelineno-2-36"></a>    <span class="nd">@nom</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-2-37" name="__codelineno-2-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">nom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">nom</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-2-38" name="__codelineno-2-38"></a>        <span class="c1"># nom doit être une chaîne de caractères non vide</span>
<a id="__codelineno-2-39" name="__codelineno-2-39"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">nom</span><span class="p">):</span>
<a id="__codelineno-2-40" name="__codelineno-2-40"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__nom</span> <span class="o">=</span> <span class="n">nom</span>
<a id="__codelineno-2-41" name="__codelineno-2-41"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-2-42" name="__codelineno-2-42"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Le nom de l&#39;élève </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-2-43" name="__codelineno-2-43"></a>
<a id="__codelineno-2-44" name="__codelineno-2-44"></a>    <span class="nd">@prénom</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-2-45" name="__codelineno-2-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">prénom</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">prénom</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-2-46" name="__codelineno-2-46"></a>        <span class="c1"># prénom doit être une chaîne de caractères non vide</span>
<a id="__codelineno-2-47" name="__codelineno-2-47"></a>        <span class="k">if</span> <span class="n">Utils</span><span class="o">.</span><span class="n">is_string_ok</span><span class="p">(</span><span class="n">prénom</span><span class="p">):</span>
<a id="__codelineno-2-48" name="__codelineno-2-48"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__prénom</span> <span class="o">=</span> <span class="n">prénom</span>
<a id="__codelineno-2-49" name="__codelineno-2-49"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-2-50" name="__codelineno-2-50"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Le prénom de l&#39;élève </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être une chaîne de caractères non vide&quot;</span><span class="p">)</span>
<a id="__codelineno-2-51" name="__codelineno-2-51"></a>
<a id="__codelineno-2-52" name="__codelineno-2-52"></a>    <span class="nd">@classe</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-2-53" name="__codelineno-2-53"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">classe</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-2-54" name="__codelineno-2-54"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-2-55" name="__codelineno-2-55"></a>            <span class="c1"># on attend un type Classe</span>
<a id="__codelineno-2-56" name="__codelineno-2-56"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Classe</span><span class="p">):</span>
<a id="__codelineno-2-57" name="__codelineno-2-57"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__classe</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-2-58" name="__codelineno-2-58"></a>            <span class="c1"># ou un type dict</span>
<a id="__codelineno-2-59" name="__codelineno-2-59"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-2-60" name="__codelineno-2-60"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__classe</span><span class="o">=</span><span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-2-61" name="__codelineno-2-61"></a>            <span class="c1"># ou un type json</span>
<a id="__codelineno-2-62" name="__codelineno-2-62"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-2-63" name="__codelineno-2-63"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__classe</span> <span class="o">=</span> <span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromjson</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-2-64" name="__codelineno-2-64"></a>        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-2-65" name="__codelineno-2-65"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;L&#39;attribut [</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">] de l&#39;élève </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être de type Classe ou dict ou json. Erreur : </span><span class="si">{</span><span class="n">erreur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 9 : la classe <strong>[Elève]</strong> dérive de la classe <strong>[BaseEntity]</strong> ;</li>
<li>lignes 13-20 : un élève est caractérisé par son n° <strong>[id]</strong>, son nom <strong>[nom]</strong>, son prénom <strong>[prénom]</strong>, sa classe<strong>[classe]</strong>. Ce dernier paramètre est une référence sur un objet <strong>[Classe]</strong> ;</li>
<li>lignes 22-65 : getters / setters des attributs de la classe ;</li>
</ul>
<h4 id="14214-lentite-note">14.2.1.4. L&#x27;entité [Note]</h4>
<p>La classe <strong>[Note]</strong> (note.py) est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-3-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-3-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-3-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-3-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-3-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-3-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-3-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-3-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-3-10">10</a></span>
<span class="normal"><a href="#__codelineno-3-11">11</a></span>
<span class="normal"><a href="#__codelineno-3-12">12</a></span>
<span class="normal"><a href="#__codelineno-3-13">13</a></span>
<span class="normal"><a href="#__codelineno-3-14">14</a></span>
<span class="normal"><a href="#__codelineno-3-15">15</a></span>
<span class="normal"><a href="#__codelineno-3-16">16</a></span>
<span class="normal"><a href="#__codelineno-3-17">17</a></span>
<span class="normal"><a href="#__codelineno-3-18">18</a></span>
<span class="normal"><a href="#__codelineno-3-19">19</a></span>
<span class="normal"><a href="#__codelineno-3-20">20</a></span>
<span class="normal"><a href="#__codelineno-3-21">21</a></span>
<span class="normal"><a href="#__codelineno-3-22">22</a></span>
<span class="normal"><a href="#__codelineno-3-23">23</a></span>
<span class="normal"><a href="#__codelineno-3-24">24</a></span>
<span class="normal"><a href="#__codelineno-3-25">25</a></span>
<span class="normal"><a href="#__codelineno-3-26">26</a></span>
<span class="normal"><a href="#__codelineno-3-27">27</a></span>
<span class="normal"><a href="#__codelineno-3-28">28</a></span>
<span class="normal"><a href="#__codelineno-3-29">29</a></span>
<span class="normal"><a href="#__codelineno-3-30">30</a></span>
<span class="normal"><a href="#__codelineno-3-31">31</a></span>
<span class="normal"><a href="#__codelineno-3-32">32</a></span>
<span class="normal"><a href="#__codelineno-3-33">33</a></span>
<span class="normal"><a href="#__codelineno-3-34">34</a></span>
<span class="normal"><a href="#__codelineno-3-35">35</a></span>
<span class="normal"><a href="#__codelineno-3-36">36</a></span>
<span class="normal"><a href="#__codelineno-3-37">37</a></span>
<span class="normal"><a href="#__codelineno-3-38">38</a></span>
<span class="normal"><a href="#__codelineno-3-39">39</a></span>
<span class="normal"><a href="#__codelineno-3-40">40</a></span>
<span class="normal"><a href="#__codelineno-3-41">41</a></span>
<span class="normal"><a href="#__codelineno-3-42">42</a></span>
<span class="normal"><a href="#__codelineno-3-43">43</a></span>
<span class="normal"><a href="#__codelineno-3-44">44</a></span>
<span class="normal"><a href="#__codelineno-3-45">45</a></span>
<span class="normal"><a href="#__codelineno-3-46">46</a></span>
<span class="normal"><a href="#__codelineno-3-47">47</a></span>
<span class="normal"><a href="#__codelineno-3-48">48</a></span>
<span class="normal"><a href="#__codelineno-3-49">49</a></span>
<span class="normal"><a href="#__codelineno-3-50">50</a></span>
<span class="normal"><a href="#__codelineno-3-51">51</a></span>
<span class="normal"><a href="#__codelineno-3-52">52</a></span>
<span class="normal"><a href="#__codelineno-3-53">53</a></span>
<span class="normal"><a href="#__codelineno-3-54">54</a></span>
<span class="normal"><a href="#__codelineno-3-55">55</a></span>
<span class="normal"><a href="#__codelineno-3-56">56</a></span>
<span class="normal"><a href="#__codelineno-3-57">57</a></span>
<span class="normal"><a href="#__codelineno-3-58">58</a></span>
<span class="normal"><a href="#__codelineno-3-59">59</a></span>
<span class="normal"><a href="#__codelineno-3-60">60</a></span>
<span class="normal"><a href="#__codelineno-3-61">61</a></span>
<span class="normal"><a href="#__codelineno-3-62">62</a></span>
<span class="normal"><a href="#__codelineno-3-63">63</a></span>
<span class="normal"><a href="#__codelineno-3-64">64</a></span>
<span class="normal"><a href="#__codelineno-3-65">65</a></span>
<span class="normal"><a href="#__codelineno-3-66">66</a></span>
<span class="normal"><a href="#__codelineno-3-67">67</a></span>
<span class="normal"><a href="#__codelineno-3-68">68</a></span>
<span class="normal"><a href="#__codelineno-3-69">69</a></span>
<span class="normal"><a href="#__codelineno-3-70">70</a></span>
<span class="normal"><a href="#__codelineno-3-71">71</a></span>
<span class="normal"><a href="#__codelineno-3-72">72</a></span>
<span class="normal"><a href="#__codelineno-3-73">73</a></span>
<span class="normal"><a href="#__codelineno-3-74">74</a></span>
<span class="normal"><a href="#__codelineno-3-75">75</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># imports</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">Note</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>    <span class="c1"># attributs exclus de l&#39;état de la classe</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>        <span class="c1"># id : identifiant de la note</span>
<a id="__codelineno-3-16" name="__codelineno-3-16"></a>        <span class="c1"># valeur : la note elle-même</span>
<a id="__codelineno-3-17" name="__codelineno-3-17"></a>        <span class="c1"># élève : élève (de type Elève) concerné par la note</span>
<a id="__codelineno-3-18" name="__codelineno-3-18"></a>        <span class="c1"># matière : matière (de type Matière) concernée par la note</span>
<a id="__codelineno-3-19" name="__codelineno-3-19"></a>        <span class="c1"># l&#39;objet Note est donc la note d&#39;un élève dans une matière</span>
<a id="__codelineno-3-20" name="__codelineno-3-20"></a>        <span class="k">return</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;valeur&quot;</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">]</span>
<a id="__codelineno-3-21" name="__codelineno-3-21"></a>
<a id="__codelineno-3-22" name="__codelineno-3-22"></a>    <span class="c1"># getters</span>
<a id="__codelineno-3-23" name="__codelineno-3-23"></a>    <span class="nd">@property</span>
<a id="__codelineno-3-24" name="__codelineno-3-24"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">valeur</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-3-25" name="__codelineno-3-25"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__valeur</span>
<a id="__codelineno-3-26" name="__codelineno-3-26"></a>
<a id="__codelineno-3-27" name="__codelineno-3-27"></a>    <span class="nd">@property</span>
<a id="__codelineno-3-28" name="__codelineno-3-28"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">élève</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Elève</span><span class="p">:</span>
<a id="__codelineno-3-29" name="__codelineno-3-29"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__élève</span>
<a id="__codelineno-3-30" name="__codelineno-3-30"></a>
<a id="__codelineno-3-31" name="__codelineno-3-31"></a>    <span class="nd">@property</span>
<a id="__codelineno-3-32" name="__codelineno-3-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">matière</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matière</span><span class="p">:</span>
<a id="__codelineno-3-33" name="__codelineno-3-33"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__matière</span>
<a id="__codelineno-3-34" name="__codelineno-3-34"></a>
<a id="__codelineno-3-35" name="__codelineno-3-35"></a>    <span class="c1"># getters</span>
<a id="__codelineno-3-36" name="__codelineno-3-36"></a>    <span class="nd">@valeur</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-3-37" name="__codelineno-3-37"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">valeur</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">valeur</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<a id="__codelineno-3-38" name="__codelineno-3-38"></a>        <span class="c1"># la note doit être un réel entre 0 et 20</span>
<a id="__codelineno-3-39" name="__codelineno-3-39"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">valeur</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">))</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">valeur</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>
<a id="__codelineno-3-40" name="__codelineno-3-40"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__valeur</span> <span class="o">=</span> <span class="n">valeur</span>
<a id="__codelineno-3-41" name="__codelineno-3-41"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-3-42" name="__codelineno-3-42"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span>
<a id="__codelineno-3-43" name="__codelineno-3-43"></a>                              <span class="sa">f</span><span class="s2">&quot;L&#39;attribut </span><span class="si">{</span><span class="n">valeur</span><span class="si">}</span><span class="s2"> de la note </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être un nombre dans l&#39;intervalle [0,20]&quot;</span><span class="p">)</span>
<a id="__codelineno-3-44" name="__codelineno-3-44"></a>
<a id="__codelineno-3-45" name="__codelineno-3-45"></a>    <span class="nd">@élève</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-3-46" name="__codelineno-3-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">élève</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-3-47" name="__codelineno-3-47"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-3-48" name="__codelineno-3-48"></a>            <span class="c1"># on attend un type Elève</span>
<a id="__codelineno-3-49" name="__codelineno-3-49"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Elève</span><span class="p">):</span>
<a id="__codelineno-3-50" name="__codelineno-3-50"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__élève</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-3-51" name="__codelineno-3-51"></a>            <span class="c1"># ou un type dict</span>
<a id="__codelineno-3-52" name="__codelineno-3-52"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-3-53" name="__codelineno-3-53"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__élève</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-3-54" name="__codelineno-3-54"></a>            <span class="c1"># ou un type json</span>
<a id="__codelineno-3-55" name="__codelineno-3-55"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-3-56" name="__codelineno-3-56"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__élève</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromjson</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-3-57" name="__codelineno-3-57"></a>        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-3-58" name="__codelineno-3-58"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span>
<a id="__codelineno-3-59" name="__codelineno-3-59"></a>                              <span class="sa">f</span><span class="s2">&quot;L&#39;attribut [</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">] de la note </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être de type Elève ou dict ou json. Erreur : </span><span class="si">{</span><span class="n">erreur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-3-60" name="__codelineno-3-60"></a>
<a id="__codelineno-3-61" name="__codelineno-3-61"></a>    <span class="nd">@matière</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-3-62" name="__codelineno-3-62"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">matière</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<a id="__codelineno-3-63" name="__codelineno-3-63"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-3-64" name="__codelineno-3-64"></a>            <span class="c1"># on attend un type Matière</span>
<a id="__codelineno-3-65" name="__codelineno-3-65"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Matière</span><span class="p">):</span>
<a id="__codelineno-3-66" name="__codelineno-3-66"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__matière</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-3-67" name="__codelineno-3-67"></a>            <span class="c1"># ou un type dict</span>
<a id="__codelineno-3-68" name="__codelineno-3-68"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
<a id="__codelineno-3-69" name="__codelineno-3-69"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__matière</span> <span class="o">=</span> <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-3-70" name="__codelineno-3-70"></a>            <span class="c1"># ou un type json</span>
<a id="__codelineno-3-71" name="__codelineno-3-71"></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-3-72" name="__codelineno-3-72"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__matière</span> <span class="o">=</span> <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromjson</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<a id="__codelineno-3-73" name="__codelineno-3-73"></a>        <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-3-74" name="__codelineno-3-74"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span>
<a id="__codelineno-3-75" name="__codelineno-3-75"></a>                              <span class="sa">f</span><span class="s2">&quot;L&#39;attribut [</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">] de la note </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> doit être de type Matière ou dict ou json. Erreur : </span><span class="si">{</span><span class="n">erreur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 8 : la classe <strong>[Note]</strong> dérive de la classe <strong>[BaseEntity]</strong> ;</li>
<li>lignes 12-20 : un objet <strong>[Note]</strong> est caractérisé par son n° <strong>[id]</strong>, la valeur de la note <strong>[valeur]</strong>, une référence <strong>[élève]</strong> sur <strong>l&#x27;élève</strong> qui a cette note, une référence sur la <strong>matière</strong> <strong>[matière]</strong> objet de la note ;</li>
<li>lignes 22-75 : getters / setters des attributs de la classe ;</li>
</ul>
<h3 id="1422-configuration-de-lapplication">14.2.2. Configuration de l’application</h3>
<p><img src="images/100000000000012F00000195977BC3C4.png" style="width:3.504cm;height:4.68cm;" alt="Image" /></p>
<p>Le fichier <strong>[config.py]</strong> configure l’environnement du script principal <strong>[main]</strong> (1) ainsi que celui des tests (2). Tous ces scripts ont une instruction <strong>[import config]</strong> en début de code. On rappelle que le dossier contenant le script objet de la commande <strong>[python script]</strong> fait automatiquement partie du Python Path.Si donc <strong>[config]</strong> est dans le même dossier que les scripts ayant l’instruction <strong>[import config]</strong>, il sera trouvé. Les fichiers <strong>[1]</strong> et <strong>[2]</strong> sont ici identiques. Ce pourrait ne pas être le cas.</p>
<p>Le fichier <strong>[config.sys]</strong> est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">():</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>    <span class="c1"># chemin absolu du dossier de ce script</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>    <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>    <span class="c1"># root_dir</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>    <span class="n">root_dir</span><span class="o">=</span><span class="s2">&quot;C:/Data/st-2020/dev/python/cours-2020/python3-flask-2020/classes&quot;</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>    <span class="c1"># dépendances absolues</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>    <span class="n">absolute_dependencies</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>        <span class="c1"># les dossiers locaux contenant des classes et interfaces</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">root_dir</span><span class="si">}</span><span class="s2">/02/entities&quot;</span><span class="p">,</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../entities&quot;</span><span class="p">,</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../interfaces&quot;</span><span class="p">,</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../services&quot;</span><span class="p">,</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>    <span class="p">]</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="c1"># mise à jour du syspath</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">myutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_syspath</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>    <span class="n">set_syspath</span><span class="p">(</span><span class="n">absolute_dependencies</span><span class="p">)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>    <span class="c1"># on rend la config</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 11-14 : les dossiers qui doivent faire partie du Python Path (sys.path) ;</li>
<li>le dossier <strong>[</strong><strong>f&quot;{root_dir}/02/entities&quot;</strong><strong>]</strong> donne accès aux classes <strong>[BaseEntity]</strong> et <strong>[MyException]</strong> ;</li>
<li>le dossier <strong>[</strong><strong>f&quot;{script_dir}/../entities&quot;</strong><strong>]</strong> donne accès aux classes <strong>[Elève]</strong>, <strong>[Classe]</strong>, <strong>[Matière]</strong>, <strong>[Note]</strong> ;</li>
<li>le dossier <strong>[</strong><strong>f&quot;{script_dir}/../interfaces&quot;</strong><strong>,]</strong> donne accès aux interfaces de l’application ;</li>
<li>le dossier <strong>[</strong><strong>f&quot;{script_dir}/../services&quot;</strong><strong>]</strong> donne accès aux classes implémentant les interfaces ;</li>
</ul>
<h3 id="1423-tests-des-entites">14.2.3. Tests des entités</h3>
<p><img src="images/100000000000013000000164F1DEE7D5.png" style="width:3.511cm;height:4.1cm;" alt="Image" /></p>
<p>Nous allons ici écrire des tests exécutés par un outil appelé <strong>[unittest]</strong>. PyCharm vient avec plusieurs frameworks de test. Le choix de l’un d’eux se fait dans la configuration de PyCharm :</p>
<p><img src="images/10000000000005F00000035C69A2DF22.png" style="width:17.551cm;height:9.921cm;" alt="Image" /></p>
<ul>
<li>en <strong>[4]</strong>, plusieurs frameworks de test sont disponibles :</li>
</ul>
<p><img src="images/10000000000001FA0000014E58EC1FB3.png" style="width:5.841cm;height:3.851cm;" alt="Image" /></p>
<h4 id="14231-la-classe-de-tests-testbaseentity">14.2.3.1. La classe de tests [TestBaseEntity]</h4>
<p>Le script de test <strong>[TestBaseEntity]</strong> sera le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span>
<span class="normal"><a href="#__codelineno-5-31">31</a></span>
<span class="normal"><a href="#__codelineno-5-32">32</a></span>
<span class="normal"><a href="#__codelineno-5-33">33</a></span>
<span class="normal"><a href="#__codelineno-5-34">34</a></span>
<span class="normal"><a href="#__codelineno-5-35">35</a></span>
<span class="normal"><a href="#__codelineno-5-36">36</a></span>
<span class="normal"><a href="#__codelineno-5-37">37</a></span>
<span class="normal"><a href="#__codelineno-5-38">38</a></span>
<span class="normal"><a href="#__codelineno-5-39">39</a></span>
<span class="normal"><a href="#__codelineno-5-40">40</a></span>
<span class="normal"><a href="#__codelineno-5-41">41</a></span>
<span class="normal"><a href="#__codelineno-5-42">42</a></span>
<span class="normal"><a href="#__codelineno-5-43">43</a></span>
<span class="normal"><a href="#__codelineno-5-44">44</a></span>
<span class="normal"><a href="#__codelineno-5-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">TestBaseEntity</span> <span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_note1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>        <span class="c1"># imports</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>        <span class="c1"># construction d&#39;une note à partir d&#39;une chaîne jSON</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a>        <span class="n">note</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromjson</span><span class="p">(</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>            <span class="s1">&#39;{&quot;id&quot;: 8, &quot;valeur&quot;: 12, &quot;élève&quot;: {&quot;id&quot;: 42, &quot;nom&quot;: &quot;nom4&quot;, &quot;prénom&quot;: &quot;prénom4&quot;, &quot;classe&quot;: {&quot;id&quot;: 2, &quot;nom&quot;: &quot;classe2&quot;}}, &quot;matière&quot;: {&quot;id&quot;: 2, &quot;nom&quot;: &quot;matière2&quot;, &quot;coefficient&quot;: 2}}&#39;</span><span class="p">)</span>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a>        <span class="c1"># vérifications</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">Note</span><span class="p">)</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">élève</span><span class="p">,</span> <span class="n">Elève</span><span class="p">)</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">élève</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">Classe</span><span class="p">)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">matière</span><span class="p">,</span> <span class="n">Matière</span><span class="p">)</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_note2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a>        <span class="c1"># imports</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a>        <span class="c1"># construction d&#39;une note à partir d&#39;un dictionnaire</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a>        <span class="n">note</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">(</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a>            <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom4&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom4&quot;</span><span class="p">,</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a>                                              <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}},</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a>             <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}})</span>
<a id="__codelineno-5-38" name="__codelineno-5-38"></a>        <span class="c1"># vérifications</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="p">,</span> <span class="n">Note</span><span class="p">)</span>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">élève</span><span class="p">,</span> <span class="n">Elève</span><span class="p">)</span>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">élève</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">Classe</span><span class="p">)</span>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">matière</span><span class="p">,</span> <span class="n">Matière</span><span class="p">)</span>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a>    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 1 : on importe le module <strong>[unittest]</strong> qui va fournir les différentes méthodes de test ;</li>
<li>lignes 3-6 : on configure l’application pour que les classes nécessaires aux tests soient trouvées ;</li>
<li>ligne 9 : une classe de test <strong>[unittest]</strong> doit étendre la classe <strong>[unittest</strong><strong>.</strong><strong>TestCase</strong><strong>]</strong> ;</li>
<li>lignes 11, 27 : les fonctions de test doivent avoir un nom commençant par <strong>[test]</strong> sinon elles ne seront pas reconnues ;</li>
<li>lignes 13-16 : on importe les classes dont on a besoin ;</li>
<li>dans cette classe de test, on veut vérifier le comportement des méthodes <strong>[BaseEntity.fromdict]</strong> (ligne 34) et <strong>[BaseEntity.fromjson]</strong> (ligne 18). La classe <strong>[Note]</strong> a des propriétés qui sont des références à d’autres classes. On veut vérifier que les deux méthodes précédentes créent des objets <strong>[Note]</strong> valides ;</li>
<li>ligne 18 : on crée un objet <strong>[Note]</strong> à partir d’un objet jSON ;</li>
<li>ligne 21 : on vérifie que l’objet créé est bien de type <strong>[Note]</strong>. La méthode <strong>[</strong><strong>assertIsInstance</strong><strong>]</strong> est une méthode de la classe <strong>[unittest</strong><strong>.</strong><strong>TestCase</strong><strong>]</strong>, classe parent de la classe <strong>[TestBaseEntity]</strong> ;</li>
<li>ligne 22 : on vérifie que <strong>[note.élève]</strong> est bien de type <strong>[Elève]</strong> ;</li>
<li>ligne 23 : on vérifie que <strong>[note.élève.classe]</strong> est bien de type <strong>[Classe]</strong> ;</li>
<li>ligne 24 : on vérifie que <strong>[note.matière]</strong> est bien de type <strong>[Matière]</strong> ;</li>
<li>lignes 33-42 : on fait de même avec la méthode <strong>[BaseEntity.fromdict]</strong> ;
Il y a plusieurs façon d’exécuter les tests :</li>
</ul>
<p><img src="images/10000000000005CB00000286E288C9FB.png" style="width:17.13cm;height:7.46cm;" alt="Image" /></p>
<ul>
<li>en <strong>[1-2]</strong>, on exécute <strong>[TestBaseEntity]</strong> avec le framework <strong>[UnitTest]</strong> ;</li>
<li>en <strong>[3-5]</strong>, les tests échouent. <strong>[UnitTests]</strong> indique qu’il n’a trouvé aucun test à exécuter ;
L’échec des tests vient de l’organisation du code de <strong>[TestBaseEntity]</strong> :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span>
<span class="normal"><a href="#__codelineno-6-4">4</a></span>
<span class="normal"><a href="#__codelineno-6-5">5</a></span>
<span class="normal"><a href="#__codelineno-6-6">6</a></span>
<span class="normal"><a href="#__codelineno-6-7">7</a></span>
<span class="normal"><a href="#__codelineno-6-8">8</a></span>
<span class="normal"><a href="#__codelineno-6-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="k">class</span><span class="w"> </span><span class="nc">TestBaseEntity</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
</code></pre></div></td></tr></table></div>
<p>Ce qui gêne le framework <strong>[UnitTest]</strong>, c’est la présence de code exécutable, lignes 3-6, avant la définition de la classe de test, ligne 9.</p>
<p>On réorganise alors le code de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">TestBaseEntity</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>        <span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a>        <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_note1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a>        <span class="err">…</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_note2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a>        <span class="err">…</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a>    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 6-10 : on définit une fonction <strong>[setUp]</strong>. Cette fonction a un rôle particulier : elle est exécutée avant chaque fonction de test (test_note1, test_note2) ;
Ceci fait, l’exécution de la classe <strong>[TestBaseEntity]</strong> donne les résultats suivants :</li>
</ul>
<p><img src="images/10000000000005EE000001C151CB179A.png" style="width:17.551cm;height:5.19cm;" alt="Image" /></p>
<p>Cette fois-ci les deux méthodes de test ont été exécutées et les tests ont été réussis.</p>
<p>Voyons ce qui se passe lorsqu’un test échoue. Modifions le code de <strong>[test_note1]</strong> de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_note1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a>        <span class="c1"># erreur volontaire - on vérifie que 1==2</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a>        <span class="c1"># imports</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="err">…</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 2 : on vérifie que 1==2 ;
Les résultats de l’exécution sont alors les suivants :</li>
</ul>
<p><img src="images/10000000000005F0000001CF3B807400.png" style="width:17.53cm;height:5.351cm;" alt="Image" /></p>
<p>On peut connaître la cause de l’erreur en cliquant sur le test raté <strong>[2]</strong> :</p>
<p><img src="images/10000000000004740000027069C2E74C.png" style="width:13.151cm;height:7.212cm;" alt="Image" /></p>
<ul>
<li>en <strong>[7-8]</strong>, la cause de l’erreur ;
Une autre façon d’exécuter une classe de tests est de l’exécuter dans un terminal :</li>
</ul>
<p><img src="images/100000000000019400000341AD03E861.png" style="width:4.661cm;height:9.61cm;" alt="Image" /></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span>
<span class="normal"><a href="#__codelineno-9-4">4</a></span>
<span class="normal"><a href="#__codelineno-9-5">5</a></span>
<span class="normal"><a href="#__codelineno-9-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="p">(</span><span class="n">venv</span><span class="p">)</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">troiscouches</span>\<span class="n">v01</span>\<span class="n">tests</span><span class="o">&gt;</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">unittest</span> <span class="n">TestBaseEntity</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="o">..</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="o">----------------------------------------------------------------------</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="n">Ran</span> <span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.026</span><span class="n">s</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="n">OK</span>
</code></pre></div></td></tr></table></div>
<p>La ligne 6 indique que les deux tests ont réussi (on a enlevé l’erreur 1==2) ;</p>
<p>Enfin une troisème façon d’exécuter la classe de tests <strong>[TestBaseEntity]</strong>, toujours dans un terminal, est la suivante. On termine la classe de tests avec les lignes 6-7 suivantes ;</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span>
<span class="normal"><a href="#__codelineno-10-5">5</a></span>
<span class="normal"><a href="#__codelineno-10-6">6</a></span>
<span class="normal"><a href="#__codelineno-10-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="err">…</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">élève</span><span class="o">.</span><span class="n">classe</span><span class="p">,</span> <span class="n">Classe</span><span class="p">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsInstance</span><span class="p">(</span><span class="n">note</span><span class="o">.</span><span class="n">matière</span><span class="p">,</span> <span class="n">Matière</span><span class="p">)</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a>    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 6 : la variable <strong>[<strong>name</strong>]</strong> est le nom donné au script qui s’exécute. Lorsque le script est le script lancé par la commande <strong>[python script.py]</strong>, la variable <strong>[<strong>name</strong>]</strong> vaut <strong>[<strong>main</strong>]</strong> (2 caractères soulignés avant et après l’identifiant). Ainsi la ligne 7 n’est exécutée que lorsque le script <strong>[TestBaseEntity]</strong> est lancé par la commande <strong>[python TestBaseEntity.py]</strong>. L’instruction <strong>[unittest.main()]</strong> lance l’exécution du script par le framework <strong>[UnitTest]</strong>. Voici un exemple :
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="p">(</span><span class="n">venv</span><span class="p">)</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">troiscouches</span>\<span class="n">v01</span>\<span class="n">tests</span><span class="o">&gt;</span><span class="n">python</span> <span class="n">TestBaseEntity</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="o">..</span>
<a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="o">----------------------------------------------------------------------</span>
<a id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="n">Ran</span> <span class="mi">2</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.013</span><span class="n">s</span>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="n">OK</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h4 id="14232-la-classe-de-tests-testentites">14.2.3.2. La classe de tests [TestEntités]</h4>
<p>La classe de tests <strong>[TestEntités]</strong> est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">  1</a></span>
<span class="normal"><a href="#__codelineno-12-2">  2</a></span>
<span class="normal"><a href="#__codelineno-12-3">  3</a></span>
<span class="normal"><a href="#__codelineno-12-4">  4</a></span>
<span class="normal"><a href="#__codelineno-12-5">  5</a></span>
<span class="normal"><a href="#__codelineno-12-6">  6</a></span>
<span class="normal"><a href="#__codelineno-12-7">  7</a></span>
<span class="normal"><a href="#__codelineno-12-8">  8</a></span>
<span class="normal"><a href="#__codelineno-12-9">  9</a></span>
<span class="normal"><a href="#__codelineno-12-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-12-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-12-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-12-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-12-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-12-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-12-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-12-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-12-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-12-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-12-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-12-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-12-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-12-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-12-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-12-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-12-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-12-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-12-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-12-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-12-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-12-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-12-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-12-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-12-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-12-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-12-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-12-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-12-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-12-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-12-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-12-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-12-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-12-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-12-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-12-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-12-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-12-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-12-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-12-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-12-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-12-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-12-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-12-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-12-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-12-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-12-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-12-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-12-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-12-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-12-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-12-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-12-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-12-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-12-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-12-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-12-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-12-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-12-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-12-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-12-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-12-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-12-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-12-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-12-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-12-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-12-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-12-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-12-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-12-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-12-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-12-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-12-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-12-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-12-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-12-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-12-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-12-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-12-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-12-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-12-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-12-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-12-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-12-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-12-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-12-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-12-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-12-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-12-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-12-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-12-100">100</a></span>
<span class="normal"><a href="#__codelineno-12-101">101</a></span>
<span class="normal"><a href="#__codelineno-12-102">102</a></span>
<span class="normal"><a href="#__codelineno-12-103">103</a></span>
<span class="normal"><a href="#__codelineno-12-104">104</a></span>
<span class="normal"><a href="#__codelineno-12-105">105</a></span>
<span class="normal"><a href="#__codelineno-12-106">106</a></span>
<span class="normal"><a href="#__codelineno-12-107">107</a></span>
<span class="normal"><a href="#__codelineno-12-108">108</a></span>
<span class="normal"><a href="#__codelineno-12-109">109</a></span>
<span class="normal"><a href="#__codelineno-12-110">110</a></span>
<span class="normal"><a href="#__codelineno-12-111">111</a></span>
<span class="normal"><a href="#__codelineno-12-112">112</a></span>
<span class="normal"><a href="#__codelineno-12-113">113</a></span>
<span class="normal"><a href="#__codelineno-12-114">114</a></span>
<span class="normal"><a href="#__codelineno-12-115">115</a></span>
<span class="normal"><a href="#__codelineno-12-116">116</a></span>
<span class="normal"><a href="#__codelineno-12-117">117</a></span>
<span class="normal"><a href="#__codelineno-12-118">118</a></span>
<span class="normal"><a href="#__codelineno-12-119">119</a></span>
<span class="normal"><a href="#__codelineno-12-120">120</a></span>
<span class="normal"><a href="#__codelineno-12-121">121</a></span>
<span class="normal"><a href="#__codelineno-12-122">122</a></span>
<span class="normal"><a href="#__codelineno-12-123">123</a></span>
<span class="normal"><a href="#__codelineno-12-124">124</a></span>
<span class="normal"><a href="#__codelineno-12-125">125</a></span>
<span class="normal"><a href="#__codelineno-12-126">126</a></span>
<span class="normal"><a href="#__codelineno-12-127">127</a></span>
<span class="normal"><a href="#__codelineno-12-128">128</a></span>
<span class="normal"><a href="#__codelineno-12-129">129</a></span>
<span class="normal"><a href="#__codelineno-12-130">130</a></span>
<span class="normal"><a href="#__codelineno-12-131">131</a></span>
<span class="normal"><a href="#__codelineno-12-132">132</a></span>
<span class="normal"><a href="#__codelineno-12-133">133</a></span>
<span class="normal"><a href="#__codelineno-12-134">134</a></span>
<span class="normal"><a href="#__codelineno-12-135">135</a></span>
<span class="normal"><a href="#__codelineno-12-136">136</a></span>
<span class="normal"><a href="#__codelineno-12-137">137</a></span>
<span class="normal"><a href="#__codelineno-12-138">138</a></span>
<span class="normal"><a href="#__codelineno-12-139">139</a></span>
<span class="normal"><a href="#__codelineno-12-140">140</a></span>
<span class="normal"><a href="#__codelineno-12-141">141</a></span>
<span class="normal"><a href="#__codelineno-12-142">142</a></span>
<span class="normal"><a href="#__codelineno-12-143">143</a></span>
<span class="normal"><a href="#__codelineno-12-144">144</a></span>
<span class="normal"><a href="#__codelineno-12-145">145</a></span>
<span class="normal"><a href="#__codelineno-12-146">146</a></span>
<span class="normal"><a href="#__codelineno-12-147">147</a></span>
<span class="normal"><a href="#__codelineno-12-148">148</a></span>
<span class="normal"><a href="#__codelineno-12-149">149</a></span>
<span class="normal"><a href="#__codelineno-12-150">150</a></span>
<span class="normal"><a href="#__codelineno-12-151">151</a></span>
<span class="normal"><a href="#__codelineno-12-152">152</a></span>
<span class="normal"><a href="#__codelineno-12-153">153</a></span>
<span class="normal"><a href="#__codelineno-12-154">154</a></span>
<span class="normal"><a href="#__codelineno-12-155">155</a></span>
<span class="normal"><a href="#__codelineno-12-156">156</a></span>
<span class="normal"><a href="#__codelineno-12-157">157</a></span>
<span class="normal"><a href="#__codelineno-12-158">158</a></span>
<span class="normal"><a href="#__codelineno-12-159">159</a></span>
<span class="normal"><a href="#__codelineno-12-160">160</a></span>
<span class="normal"><a href="#__codelineno-12-161">161</a></span>
<span class="normal"><a href="#__codelineno-12-162">162</a></span>
<span class="normal"><a href="#__codelineno-12-163">163</a></span>
<span class="normal"><a href="#__codelineno-12-164">164</a></span>
<span class="normal"><a href="#__codelineno-12-165">165</a></span>
<span class="normal"><a href="#__codelineno-12-166">166</a></span>
<span class="normal"><a href="#__codelineno-12-167">167</a></span>
<span class="normal"><a href="#__codelineno-12-168">168</a></span>
<span class="normal"><a href="#__codelineno-12-169">169</a></span>
<span class="normal"><a href="#__codelineno-12-170">170</a></span>
<span class="normal"><a href="#__codelineno-12-171">171</a></span>
<span class="normal"><a href="#__codelineno-12-172">172</a></span>
<span class="normal"><a href="#__codelineno-12-173">173</a></span>
<span class="normal"><a href="#__codelineno-12-174">174</a></span>
<span class="normal"><a href="#__codelineno-12-175">175</a></span>
<span class="normal"><a href="#__codelineno-12-176">176</a></span>
<span class="normal"><a href="#__codelineno-12-177">177</a></span>
<span class="normal"><a href="#__codelineno-12-178">178</a></span>
<span class="normal"><a href="#__codelineno-12-179">179</a></span>
<span class="normal"><a href="#__codelineno-12-180">180</a></span>
<span class="normal"><a href="#__codelineno-12-181">181</a></span>
<span class="normal"><a href="#__codelineno-12-182">182</a></span>
<span class="normal"><a href="#__codelineno-12-183">183</a></span>
<span class="normal"><a href="#__codelineno-12-184">184</a></span>
<span class="normal"><a href="#__codelineno-12-185">185</a></span>
<span class="normal"><a href="#__codelineno-12-186">186</a></span>
<span class="normal"><a href="#__codelineno-12-187">187</a></span>
<span class="normal"><a href="#__codelineno-12-188">188</a></span>
<span class="normal"><a href="#__codelineno-12-189">189</a></span>
<span class="normal"><a href="#__codelineno-12-190">190</a></span>
<span class="normal"><a href="#__codelineno-12-191">191</a></span>
<span class="normal"><a href="#__codelineno-12-192">192</a></span>
<span class="normal"><a href="#__codelineno-12-193">193</a></span>
<span class="normal"><a href="#__codelineno-12-194">194</a></span>
<span class="normal"><a href="#__codelineno-12-195">195</a></span>
<span class="normal"><a href="#__codelineno-12-196">196</a></span>
<span class="normal"><a href="#__codelineno-12-197">197</a></span>
<span class="normal"><a href="#__codelineno-12-198">198</a></span>
<span class="normal"><a href="#__codelineno-12-199">199</a></span>
<span class="normal"><a href="#__codelineno-12-200">200</a></span>
<span class="normal"><a href="#__codelineno-12-201">201</a></span>
<span class="normal"><a href="#__codelineno-12-202">202</a></span>
<span class="normal"><a href="#__codelineno-12-203">203</a></span>
<span class="normal"><a href="#__codelineno-12-204">204</a></span>
<span class="normal"><a href="#__codelineno-12-205">205</a></span>
<span class="normal"><a href="#__codelineno-12-206">206</a></span>
<span class="normal"><a href="#__codelineno-12-207">207</a></span>
<span class="normal"><a href="#__codelineno-12-208">208</a></span>
<span class="normal"><a href="#__codelineno-12-209">209</a></span>
<span class="normal"><a href="#__codelineno-12-210">210</a></span>
<span class="normal"><a href="#__codelineno-12-211">211</a></span>
<span class="normal"><a href="#__codelineno-12-212">212</a></span>
<span class="normal"><a href="#__codelineno-12-213">213</a></span>
<span class="normal"><a href="#__codelineno-12-214">214</a></span>
<span class="normal"><a href="#__codelineno-12-215">215</a></span>
<span class="normal"><a href="#__codelineno-12-216">216</a></span>
<span class="normal"><a href="#__codelineno-12-217">217</a></span>
<span class="normal"><a href="#__codelineno-12-218">218</a></span>
<span class="normal"><a href="#__codelineno-12-219">219</a></span>
<span class="normal"><a href="#__codelineno-12-220">220</a></span>
<span class="normal"><a href="#__codelineno-12-221">221</a></span>
<span class="normal"><a href="#__codelineno-12-222">222</a></span>
<span class="normal"><a href="#__codelineno-12-223">223</a></span>
<span class="normal"><a href="#__codelineno-12-224">224</a></span>
<span class="normal"><a href="#__codelineno-12-225">225</a></span>
<span class="normal"><a href="#__codelineno-12-226">226</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<a id="__codelineno-12-2" name="__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">TestEntités</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-12-5" name="__codelineno-12-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-6" name="__codelineno-12-6"></a>        <span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-12-7" name="__codelineno-12-7"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-12-8" name="__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9"></a>        <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-12-10" name="__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code1a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-12" name="__codelineno-12-12"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-13" name="__codelineno-12-13"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-12-14" name="__codelineno-12-14"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-15" name="__codelineno-12-15"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-16" name="__codelineno-12-16"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-17" name="__codelineno-12-17"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-18" name="__codelineno-12-18"></a>            <span class="c1"># id invalide</span>
<a id="__codelineno-12-19" name="__codelineno-12-19"></a>            <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-20" name="__codelineno-12-20"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-21" name="__codelineno-12-21"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-22" name="__codelineno-12-22"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-23" name="__codelineno-12-23"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-24" name="__codelineno-12-24"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-12-25" name="__codelineno-12-25"></a>
<a id="__codelineno-12-26" name="__codelineno-12-26"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code41</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-27" name="__codelineno-12-27"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-28" name="__codelineno-12-28"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-12-29" name="__codelineno-12-29"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-30" name="__codelineno-12-30"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-31" name="__codelineno-12-31"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-32" name="__codelineno-12-32"></a>
<a id="__codelineno-12-33" name="__codelineno-12-33"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-34" name="__codelineno-12-34"></a>            <span class="c1"># nom invalide</span>
<a id="__codelineno-12-35" name="__codelineno-12-35"></a>            <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-36" name="__codelineno-12-36"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-37" name="__codelineno-12-37"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-38" name="__codelineno-12-38"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-39" name="__codelineno-12-39"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-40" name="__codelineno-12-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">41</span><span class="p">)</span>
<a id="__codelineno-12-41" name="__codelineno-12-41"></a>
<a id="__codelineno-12-42" name="__codelineno-12-42"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code42</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-43" name="__codelineno-12-43"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-44" name="__codelineno-12-44"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-12-45" name="__codelineno-12-45"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-46" name="__codelineno-12-46"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-47" name="__codelineno-12-47"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-48" name="__codelineno-12-48"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-49" name="__codelineno-12-49"></a>            <span class="c1"># prénom invalide</span>
<a id="__codelineno-12-50" name="__codelineno-12-50"></a>            <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-51" name="__codelineno-12-51"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-52" name="__codelineno-12-52"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-53" name="__codelineno-12-53"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-54" name="__codelineno-12-54"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-55" name="__codelineno-12-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-12-56" name="__codelineno-12-56"></a>
<a id="__codelineno-12-57" name="__codelineno-12-57"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code43</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-58" name="__codelineno-12-58"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-59" name="__codelineno-12-59"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-12-60" name="__codelineno-12-60"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-61" name="__codelineno-12-61"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-62" name="__codelineno-12-62"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-63" name="__codelineno-12-63"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-64" name="__codelineno-12-64"></a>            <span class="c1"># classe invalide</span>
<a id="__codelineno-12-65" name="__codelineno-12-65"></a>            <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-66" name="__codelineno-12-66"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-67" name="__codelineno-12-67"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-68" name="__codelineno-12-68"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-69" name="__codelineno-12-69"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-70" name="__codelineno-12-70"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">43</span><span class="p">)</span>
<a id="__codelineno-12-71" name="__codelineno-12-71"></a>
<a id="__codelineno-12-72" name="__codelineno-12-72"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code1b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-73" name="__codelineno-12-73"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-74" name="__codelineno-12-74"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-12-75" name="__codelineno-12-75"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-76" name="__codelineno-12-76"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-77" name="__codelineno-12-77"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-78" name="__codelineno-12-78"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-79" name="__codelineno-12-79"></a>            <span class="c1"># identifiant invalide</span>
<a id="__codelineno-12-80" name="__codelineno-12-80"></a>            <span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">})</span>
<a id="__codelineno-12-81" name="__codelineno-12-81"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-82" name="__codelineno-12-82"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-83" name="__codelineno-12-83"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-84" name="__codelineno-12-84"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-85" name="__codelineno-12-85"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-12-86" name="__codelineno-12-86"></a>
<a id="__codelineno-12-87" name="__codelineno-12-87"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code11</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-88" name="__codelineno-12-88"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-89" name="__codelineno-12-89"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-12-90" name="__codelineno-12-90"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-91" name="__codelineno-12-91"></a>
<a id="__codelineno-12-92" name="__codelineno-12-92"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-93" name="__codelineno-12-93"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-94" name="__codelineno-12-94"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-95" name="__codelineno-12-95"></a>            <span class="c1"># nom invalide</span>
<a id="__codelineno-12-96" name="__codelineno-12-96"></a>            <span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
<a id="__codelineno-12-97" name="__codelineno-12-97"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-98" name="__codelineno-12-98"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-99" name="__codelineno-12-99"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-100" name="__codelineno-12-100"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<a id="__codelineno-12-101" name="__codelineno-12-101"></a>
<a id="__codelineno-12-102" name="__codelineno-12-102"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code1c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-103" name="__codelineno-12-103"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-104" name="__codelineno-12-104"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-12-105" name="__codelineno-12-105"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-106" name="__codelineno-12-106"></a>
<a id="__codelineno-12-107" name="__codelineno-12-107"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-108" name="__codelineno-12-108"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-109" name="__codelineno-12-109"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-110" name="__codelineno-12-110"></a>            <span class="c1"># identifiant invalide</span>
<a id="__codelineno-12-111" name="__codelineno-12-111"></a>            <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-112" name="__codelineno-12-112"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-113" name="__codelineno-12-113"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-114" name="__codelineno-12-114"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-115" name="__codelineno-12-115"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-116" name="__codelineno-12-116"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-12-117" name="__codelineno-12-117"></a>
<a id="__codelineno-12-118" name="__codelineno-12-118"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code21</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-119" name="__codelineno-12-119"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-120" name="__codelineno-12-120"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-12-121" name="__codelineno-12-121"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-122" name="__codelineno-12-122"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-123" name="__codelineno-12-123"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-124" name="__codelineno-12-124"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-125" name="__codelineno-12-125"></a>            <span class="c1"># nom invalide</span>
<a id="__codelineno-12-126" name="__codelineno-12-126"></a>            <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-127" name="__codelineno-12-127"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-128" name="__codelineno-12-128"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-129" name="__codelineno-12-129"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-130" name="__codelineno-12-130"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-131" name="__codelineno-12-131"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<a id="__codelineno-12-132" name="__codelineno-12-132"></a>
<a id="__codelineno-12-133" name="__codelineno-12-133"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code22</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-134" name="__codelineno-12-134"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-135" name="__codelineno-12-135"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-12-136" name="__codelineno-12-136"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-137" name="__codelineno-12-137"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-138" name="__codelineno-12-138"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-139" name="__codelineno-12-139"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-140" name="__codelineno-12-140"></a>            <span class="c1"># coefficient invalide</span>
<a id="__codelineno-12-141" name="__codelineno-12-141"></a>            <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-142" name="__codelineno-12-142"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-143" name="__codelineno-12-143"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-144" name="__codelineno-12-144"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-145" name="__codelineno-12-145"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-146" name="__codelineno-12-146"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span>
<a id="__codelineno-12-147" name="__codelineno-12-147"></a>
<a id="__codelineno-12-148" name="__codelineno-12-148"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code1d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-149" name="__codelineno-12-149"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-150" name="__codelineno-12-150"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-12-151" name="__codelineno-12-151"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-152" name="__codelineno-12-152"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-153" name="__codelineno-12-153"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-154" name="__codelineno-12-154"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-155" name="__codelineno-12-155"></a>            <span class="c1"># identifiant invalide</span>
<a id="__codelineno-12-156" name="__codelineno-12-156"></a>            <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">})</span>
<a id="__codelineno-12-157" name="__codelineno-12-157"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-158" name="__codelineno-12-158"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-159" name="__codelineno-12-159"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-160" name="__codelineno-12-160"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-161" name="__codelineno-12-161"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-12-162" name="__codelineno-12-162"></a>
<a id="__codelineno-12-163" name="__codelineno-12-163"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code31</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-164" name="__codelineno-12-164"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-165" name="__codelineno-12-165"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-12-166" name="__codelineno-12-166"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-167" name="__codelineno-12-167"></a>
<a id="__codelineno-12-168" name="__codelineno-12-168"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-169" name="__codelineno-12-169"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-170" name="__codelineno-12-170"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-171" name="__codelineno-12-171"></a>            <span class="c1"># valeur invalide</span>
<a id="__codelineno-12-172" name="__codelineno-12-172"></a>            <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">})</span>
<a id="__codelineno-12-173" name="__codelineno-12-173"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-174" name="__codelineno-12-174"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-175" name="__codelineno-12-175"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-176" name="__codelineno-12-176"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-177" name="__codelineno-12-177"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
<a id="__codelineno-12-178" name="__codelineno-12-178"></a>
<a id="__codelineno-12-179" name="__codelineno-12-179"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code32</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-180" name="__codelineno-12-180"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-181" name="__codelineno-12-181"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-12-182" name="__codelineno-12-182"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-183" name="__codelineno-12-183"></a>
<a id="__codelineno-12-184" name="__codelineno-12-184"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-185" name="__codelineno-12-185"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-186" name="__codelineno-12-186"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-187" name="__codelineno-12-187"></a>            <span class="c1"># élève invalide</span>
<a id="__codelineno-12-188" name="__codelineno-12-188"></a>            <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">})</span>
<a id="__codelineno-12-189" name="__codelineno-12-189"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-190" name="__codelineno-12-190"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-191" name="__codelineno-12-191"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-192" name="__codelineno-12-192"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-193" name="__codelineno-12-193"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-12-194" name="__codelineno-12-194"></a>
<a id="__codelineno-12-195" name="__codelineno-12-195"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_code33</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-196" name="__codelineno-12-196"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-197" name="__codelineno-12-197"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-12-198" name="__codelineno-12-198"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-12-199" name="__codelineno-12-199"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-12-200" name="__codelineno-12-200"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-201" name="__codelineno-12-201"></a>
<a id="__codelineno-12-202" name="__codelineno-12-202"></a>        <span class="c1"># code d&#39;erreur</span>
<a id="__codelineno-12-203" name="__codelineno-12-203"></a>        <span class="n">code</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-12-204" name="__codelineno-12-204"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-12-205" name="__codelineno-12-205"></a>            <span class="c1"># matière invalide</span>
<a id="__codelineno-12-206" name="__codelineno-12-206"></a>            <span class="n">classe</span> <span class="o">=</span> <span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">})</span>
<a id="__codelineno-12-207" name="__codelineno-12-207"></a>            <span class="n">élève</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="n">classe</span><span class="p">})</span>
<a id="__codelineno-12-208" name="__codelineno-12-208"></a>            <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">})</span>
<a id="__codelineno-12-209" name="__codelineno-12-209"></a>        <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-12-210" name="__codelineno-12-210"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">code erreur=</span><span class="si">{</span><span class="n">ex</span><span class="o">.</span><span class="n">code</span><span class="si">}</span><span class="s2">, message=</span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-12-211" name="__codelineno-12-211"></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span>
<a id="__codelineno-12-212" name="__codelineno-12-212"></a>        <span class="c1"># vérification</span>
<a id="__codelineno-12-213" name="__codelineno-12-213"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<a id="__codelineno-12-214" name="__codelineno-12-214"></a>
<a id="__codelineno-12-215" name="__codelineno-12-215"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-216" name="__codelineno-12-216"></a>        <span class="c1"># imports</span>
<a id="__codelineno-12-217" name="__codelineno-12-217"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-12-218" name="__codelineno-12-218"></a>        <span class="c1"># le test doit lancer le type [MyException] pour réussir</span>
<a id="__codelineno-12-219" name="__codelineno-12-219"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-12-220" name="__codelineno-12-220"></a>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">assertRaises</span><span class="p">(</span><span class="n">MyException</span><span class="p">):</span>
<a id="__codelineno-12-221" name="__codelineno-12-221"></a>            <span class="c1"># le test</span>
<a id="__codelineno-12-222" name="__codelineno-12-222"></a>            <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">})</span>
<a id="__codelineno-12-223" name="__codelineno-12-223"></a>
<a id="__codelineno-12-224" name="__codelineno-12-224"></a>
<a id="__codelineno-12-225" name="__codelineno-12-225"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-12-226" name="__codelineno-12-226"></a>    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>le script de test a pour but de tester les setters des classes : vérifier qu&#x27;on ne peut pas attribuer des valeurs incorrectes aux attributs des différentes entités ;</li>
<li>lignes 11-24 : on teste qu&#x27;on ne peut pas passer un identifiant invalide à un élève. Parce qu&#x27;on passe la valeur &#x27;x&#x27;, ligne 16, comme identifiant de l&#x27;élève, on s&#x27;attend à avoir une exception. On devrait donc passer dans les lignes 20-22 ;</li>
<li>ligne 21 : affichage du message d&#x27;erreur ;</li>
<li>ligne 22 : on récupère le code de l&#x27;erreur (cf paragraphe |<u>L&#x27;entité MyException</u>|) ;</li>
<li>ligne 24 : on vérifie (assert) que le code d&#x27;erreur est 1. Ici, on vérifie deux choses :</li>
<li>qu&#x27;il y a bien eu erreur ;</li>
<li>que le code d&#x27;erreur est 1 ;</li>
<li>ce processus est répété avec les fonctions des lignes 24-213 ;</li>
<li>lignes 215-222 : on teste qu&#x27;une action lève une exception d&#x27;un certain type ;</li>
<li>ligne 220 : on indique que le test est réussi s&#x27;il lève une exception de type <strong>[MyException]</strong> ;
<strong>Résultats</strong></li>
</ul>
<p>On exécute le script de test :</p>
<p><img src="images/10000000000003EF000002CECA97401A.png" style="width:8.656cm;height:6.171cm;" alt="Image" /></p>
<p>Les résultats obtenus sont les suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span>
<span class="normal"><a href="#__codelineno-13-29">29</a></span>
<span class="normal"><a href="#__codelineno-13-30">30</a></span>
<span class="normal"><a href="#__codelineno-13-31">31</a></span>
<span class="normal"><a href="#__codelineno-13-32">32</a></span>
<span class="normal"><a href="#__codelineno-13-33">33</a></span>
<span class="normal"><a href="#__codelineno-13-34">34</a></span>
<span class="normal"><a href="#__codelineno-13-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">Testing</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">09</span><span class="p">:</span><span class="mi">39</span> <span class="o">...</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="s2">&quot;C:\Program Files\JetBrains\PyCharm Community Edition 2020.1.2\plugins\python-ce\helpers\pycharm\_jb_unittest_runner.py&quot;</span> <span class="o">--</span><span class="n">path</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">TestEntités</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="n">Launching</span> <span class="n">unittests</span> <span class="k">with</span> <span class="n">arguments</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">unittest</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">TestEntités</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">troiscouches</span>\<span class="n">v01</span>\<span class="n">tests</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;identifiant d&#39;</span><span class="n">une</span> <span class="n">entité</span> <span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">Elève</span><span class="o">.</span><span class="n">Elève</span><span class="s1">&#39;&gt; doit être un entier &gt;=0]</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;identifiant d&#39;</span><span class="n">une</span> <span class="n">entité</span> <span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">Classe</span><span class="o">.</span><span class="n">Classe</span><span class="s1">&#39;&gt; doit être un entier &gt;=0]</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;identifiant d&#39;</span><span class="n">une</span> <span class="n">entité</span> <span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">Matière</span><span class="o">.</span><span class="n">Matière</span><span class="s1">&#39;&gt; doit être un entier &gt;=0]</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;identifiant d&#39;</span><span class="n">une</span> <span class="n">entité</span> <span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="err">&#39;</span><span class="nc">Note</span><span class="o">.</span><span class="n">Note</span><span class="s1">&#39;&gt; doit être un entier &gt;=0]</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="n">Le</span> <span class="n">nom</span> <span class="n">de</span> <span class="n">la</span> <span class="n">matière</span> <span class="mi">1</span> <span class="n">doit</span> <span class="n">être</span> <span class="n">une</span> <span class="n">chaîne</span> <span class="n">de</span> <span class="n">caractères</span> <span class="n">non</span> <span class="n">vide</span><span class="p">]</span>
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="n">Le</span> <span class="n">coefficient</span> <span class="n">de</span> <span class="n">la</span> <span class="n">matière</span> <span class="n">y</span> <span class="n">doit</span> <span class="n">être</span> <span class="n">un</span> <span class="n">réel</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;attribut x de la note 1 doit être un nombre dans l&#39;</span><span class="n">intervalle</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">]]</span>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;attribut [y] de la note 1 doit être de type Elève ou dict ou json. Erreur : Expecting value: line 1 column 1 (char 0)]</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;attribut [z] de la note 1 doit être de type Matière ou dict ou json. Erreur : Expecting value: line 1 column 1 (char 0)]</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="n">Le</span> <span class="n">nom</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève 1 doit être une chaîne de caractères non vide]</span>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="n">Le</span> <span class="n">prénom</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève 1 doit être une chaîne de caractères non vide]</span>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="n">code</span> <span class="n">erreur</span><span class="o">=</span><span class="mi">43</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="n">MyException</span><span class="p">[</span><span class="mi">43</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;attribut [t] de l&#39;</span><span class="n">élève</span> <span class="mi">1</span> <span class="n">doit</span> <span class="n">être</span> <span class="n">de</span> <span class="nb">type</span> <span class="n">Classe</span> <span class="n">ou</span> <span class="nb">dict</span> <span class="n">ou</span> <span class="n">json</span><span class="o">.</span> <span class="n">Erreur</span> <span class="p">:</span> <span class="n">Expecting</span> <span class="n">value</span><span class="p">:</span> <span class="n">line</span> <span class="mi">1</span> <span class="n">column</span> <span class="mi">1</span> <span class="p">(</span><span class="n">char</span> <span class="mi">0</span><span class="p">)]</span>
<a id="__codelineno-13-29" name="__codelineno-13-29"></a>
<a id="__codelineno-13-30" name="__codelineno-13-30"></a>
<a id="__codelineno-13-31" name="__codelineno-13-31"></a><span class="n">Ran</span> <span class="mi">14</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.040</span><span class="n">s</span>
<a id="__codelineno-13-32" name="__codelineno-13-32"></a>
<a id="__codelineno-13-33" name="__codelineno-13-33"></a><span class="n">OK</span>
<a id="__codelineno-13-34" name="__codelineno-13-34"></a>
<a id="__codelineno-13-35" name="__codelineno-13-35"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>Ici, tous les tests ont été réussis</p>
<h3 id="1424-la-couche-dao">14.2.4. La couche [dao]</h3>
<p><img src="images/1000000000000523000002CDB342C812.png" style="width:15.17cm;height:8.272cm;" alt="Image" /></p>
<p>La couche <strong>[dao]</strong> implémente l’interface <strong>[InterfaceDao]</strong> <strong>[1]</strong>. Celle-ci est implémentée par la classe <strong>[Dao]</strong> (2). Le script <strong>[tests_dao]</strong> (3) teste les méthodes de la couche <strong>[dao]</strong>.</p>
<h4 id="14241-interface-interfacedao">14.2.4.1. Interface [InterfaceDao]</h4>
<p>Une interface est un contrat passé entre code appelant et code appelé. C’est le code appelé qui offre l’interface :</p>
<p><img src="images/100000000000038A000000E37692A18F.png" style="width:11.951cm;height:2.991cm;" alt="Image" /></p>
<ul>
<li>
<p>le code appelant <strong>[1]</strong> ne connait pas l’implémentation du code appelé <strong>[3]</strong>. Il ne connaît que la façon de l’appeler. C’est l’interface <strong>[2]</strong> qui le lui indique. Celle-ci définit un certain nombre de méthodes / fonctions à utiliser pour interagir avec le code appelé. On appelle également API (Application Programming Interface) cette interface ;
La couche <strong>[dao]</strong> offrira l&#x27;interface suivante :</p>
</li>
<li>
<p><strong>[get_classes]</strong> rend la liste des classes du collège ;</p>
</li>
<li><strong>[get_matières]</strong> rend la liste des matières enseignées au collège ;</li>
<li><strong>[get_élèves]</strong> rend la liste des élèves du collège ;</li>
<li><strong>[get_notes]</strong> rend la liste des notes de tous les élèves ;</li>
<li><strong>[</strong><strong>get_notes_for_élève_by_id</strong><strong>]</strong> rend les notes d’un élève particulier ;</li>
<li><strong>[</strong><strong>get_élève_by_id</strong><strong>]</strong> rend un élève repéré par son n° ;
Le code appelant n&#x27;utilisera que ces méthodes. Il n&#x27;a pas à savoir comment elles sont implémentées. Les données peuvent alors provenir de différentes sources (en dur, d&#x27;une base de données, de fichiers texte…) sans que cela impacte le code appelant. On appelle cela la <strong>programmation par interfaces</strong>.</li>
</ul>
<p>Python 3 a une notion qui s&#x27;approche de celle d&#x27;interface : la <strong>classe abstraite</strong>. Nous allons l&#x27;utiliser. Nous allons regrouper les interfaces de cet exemple dans le dossier <strong>[interfaces]</strong>.</p>
<p>Nous définissons une classe abstraite <strong>[</strong><strong>InterfaceDao</strong><strong>]</strong> (InterfaceDao.py) pour la couche <strong>[dao]</strong> :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span>
<span class="normal"><a href="#__codelineno-14-33">33</a></span>
<span class="normal"><a href="#__codelineno-14-34">34</a></span>
<span class="normal"><a href="#__codelineno-14-35">35</a></span>
<span class="normal"><a href="#__codelineno-14-36">36</a></span>
<span class="normal"><a href="#__codelineno-14-37">37</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="c1"># imports</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="c1"># interface Dao</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">InterfaceDao</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-14-9" name="__codelineno-14-9"></a>    <span class="c1"># liste des classes</span>
<a id="__codelineno-14-10" name="__codelineno-14-10"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-14-11" name="__codelineno-14-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-14-12" name="__codelineno-14-12"></a>        <span class="k">pass</span>
<a id="__codelineno-14-13" name="__codelineno-14-13"></a>
<a id="__codelineno-14-14" name="__codelineno-14-14"></a>    <span class="c1"># liste des élèves</span>
<a id="__codelineno-14-15" name="__codelineno-14-15"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-14-16" name="__codelineno-14-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_élèves</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-14-17" name="__codelineno-14-17"></a>        <span class="k">pass</span>
<a id="__codelineno-14-18" name="__codelineno-14-18"></a>
<a id="__codelineno-14-19" name="__codelineno-14-19"></a>    <span class="c1"># liste des matières</span>
<a id="__codelineno-14-20" name="__codelineno-14-20"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-14-21" name="__codelineno-14-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_matières</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-14-22" name="__codelineno-14-22"></a>        <span class="k">pass</span>
<a id="__codelineno-14-23" name="__codelineno-14-23"></a>
<a id="__codelineno-14-24" name="__codelineno-14-24"></a>    <span class="c1"># liste des notes</span>
<a id="__codelineno-14-25" name="__codelineno-14-25"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-14-26" name="__codelineno-14-26"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_notes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-14-27" name="__codelineno-14-27"></a>        <span class="k">pass</span>
<a id="__codelineno-14-28" name="__codelineno-14-28"></a>
<a id="__codelineno-14-29" name="__codelineno-14-29"></a>    <span class="c1"># liste des notes d&#39;un élève</span>
<a id="__codelineno-14-30" name="__codelineno-14-30"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-14-31" name="__codelineno-14-31"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_notes_for_élève_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">élève_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-14-32" name="__codelineno-14-32"></a>        <span class="k">pass</span>
<a id="__codelineno-14-33" name="__codelineno-14-33"></a>
<a id="__codelineno-14-34" name="__codelineno-14-34"></a>    <span class="c1"># chercher un élève par son id</span>
<a id="__codelineno-14-35" name="__codelineno-14-35"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-14-36" name="__codelineno-14-36"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_élève_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">élève_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Elève</span><span class="p">:</span>
<a id="__codelineno-14-37" name="__codelineno-14-37"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong> :</p>
<ul>
<li>ligne 2 : ABC=Abstract Base Class. On importe du module <strong>[abc]</strong>, la classe ABC ainsi que le décorateur <strong>[abstractmethod]</strong> utilisé aux lignes 10, 15, 20, 25, 30 et 35 ;</li>
<li>ligne 8 : la classe abstraite s&#x27;appelle <strong>[InterfaceDao]</strong> et dérive de la classe <strong>[ABC]</strong> ;</li>
<li>les méthodes de la classe abstraite sont décorées avec le décorateur <strong>[</strong><strong>@abstractmethod</strong><strong>]</strong> qui fait de la méthode ainsi décorée une méthode abstraite : son code n&#x27;est pas défini. Néanmoins, on y met du code : l’instruction <strong>[pass]</strong> qui ne fait rien ;</li>
<li>la classe abstraite <strong>[InterfaceDao]</strong> ne peut être instanciée. Seules peuvent l&#x27;être les classes <strong>dérivées</strong> de <strong>[InterfaceDao]</strong> ayant implémenté toutes les méthodes de <strong>[InterfaceDao]</strong>. Si donc on crée deux classes <strong>[Dao1]</strong> et <strong>[Dao2]</strong> dérivant de la classe <strong>[InterfaceDao]</strong>, elles implémenteront toutes deux les méthodes abstraites de <strong>[InterfaceDao]</strong>. On pourrait dire ainsi qu&#x27;elles implémentent l&#x27;interface <strong>[InterfaceDao]</strong> ;</li>
<li>les langages implémentant à la fois les interfaces et les classes abstraites donnent à l&#x27;interface un rôle différent de celui de la classe abstraite. Une interface n&#x27;a pas d&#x27;attributs et ne peut être instanciée. Une classe peut implémenter une interface en définissant toutes les méthodes de celle-ci ;</li>
</ul>
<h4 id="14242-implementation-dao">14.2.4.2. Implémentation [Dao]</h4>
<p>La classe <strong>[Dao]</strong> (dao.py) implémente l&#x27;interface <strong>[InterfaceDao]</strong> de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-15-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-15-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-15-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-15-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-15-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-15-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-15-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-15-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-15-10">10</a></span>
<span class="normal"><a href="#__codelineno-15-11">11</a></span>
<span class="normal"><a href="#__codelineno-15-12">12</a></span>
<span class="normal"><a href="#__codelineno-15-13">13</a></span>
<span class="normal"><a href="#__codelineno-15-14">14</a></span>
<span class="normal"><a href="#__codelineno-15-15">15</a></span>
<span class="normal"><a href="#__codelineno-15-16">16</a></span>
<span class="normal"><a href="#__codelineno-15-17">17</a></span>
<span class="normal"><a href="#__codelineno-15-18">18</a></span>
<span class="normal"><a href="#__codelineno-15-19">19</a></span>
<span class="normal"><a href="#__codelineno-15-20">20</a></span>
<span class="normal"><a href="#__codelineno-15-21">21</a></span>
<span class="normal"><a href="#__codelineno-15-22">22</a></span>
<span class="normal"><a href="#__codelineno-15-23">23</a></span>
<span class="normal"><a href="#__codelineno-15-24">24</a></span>
<span class="normal"><a href="#__codelineno-15-25">25</a></span>
<span class="normal"><a href="#__codelineno-15-26">26</a></span>
<span class="normal"><a href="#__codelineno-15-27">27</a></span>
<span class="normal"><a href="#__codelineno-15-28">28</a></span>
<span class="normal"><a href="#__codelineno-15-29">29</a></span>
<span class="normal"><a href="#__codelineno-15-30">30</a></span>
<span class="normal"><a href="#__codelineno-15-31">31</a></span>
<span class="normal"><a href="#__codelineno-15-32">32</a></span>
<span class="normal"><a href="#__codelineno-15-33">33</a></span>
<span class="normal"><a href="#__codelineno-15-34">34</a></span>
<span class="normal"><a href="#__codelineno-15-35">35</a></span>
<span class="normal"><a href="#__codelineno-15-36">36</a></span>
<span class="normal"><a href="#__codelineno-15-37">37</a></span>
<span class="normal"><a href="#__codelineno-15-38">38</a></span>
<span class="normal"><a href="#__codelineno-15-39">39</a></span>
<span class="normal"><a href="#__codelineno-15-40">40</a></span>
<span class="normal"><a href="#__codelineno-15-41">41</a></span>
<span class="normal"><a href="#__codelineno-15-42">42</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="c1"># import des entités et des interfaces</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Classe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Classe</span>
<a id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Elève</span><span class="w"> </span><span class="kn">import</span> <span class="n">Elève</span>
<a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceDao</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceDao</span>
<a id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Matière</span><span class="w"> </span><span class="kn">import</span> <span class="n">Matière</span>
<a id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Note</span><span class="w"> </span><span class="kn">import</span> <span class="n">Note</span>
<a id="__codelineno-15-8" name="__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9"></a>
<a id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="c1"># couche [dao] implémente l&#39;interface InterfaceDao</span>
<a id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">Dao</span><span class="p">(</span><span class="n">InterfaceDao</span><span class="p">):</span>
<a id="__codelineno-15-12" name="__codelineno-15-12"></a>    <span class="c1"># constructeur</span>
<a id="__codelineno-15-13" name="__codelineno-15-13"></a>    <span class="c1"># on construit des listes en dur</span>
<a id="__codelineno-15-14" name="__codelineno-15-14"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-15-15" name="__codelineno-15-15"></a>        <span class="c1"># on instancie les classes</span>
<a id="__codelineno-15-16" name="__codelineno-15-16"></a>        <span class="n">classe1</span> <span class="o">=</span> <span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">})</span>
<a id="__codelineno-15-17" name="__codelineno-15-17"></a>        <span class="n">classe2</span> <span class="o">=</span> <span class="n">Classe</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">})</span>
<a id="__codelineno-15-18" name="__codelineno-15-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">classe1</span><span class="p">,</span> <span class="n">classe2</span><span class="p">]</span>
<a id="__codelineno-15-19" name="__codelineno-15-19"></a>        <span class="c1"># les matières</span>
<a id="__codelineno-15-20" name="__codelineno-15-20"></a>        <span class="n">matière1</span> <span class="o">=</span> <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière1&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<a id="__codelineno-15-21" name="__codelineno-15-21"></a>        <span class="n">matière2</span> <span class="o">=</span> <span class="n">Matière</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<a id="__codelineno-15-22" name="__codelineno-15-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">matières</span> <span class="o">=</span> <span class="p">[</span><span class="n">matière1</span><span class="p">,</span> <span class="n">matière2</span><span class="p">]</span>
<a id="__codelineno-15-23" name="__codelineno-15-23"></a>        <span class="c1"># les élèves</span>
<a id="__codelineno-15-24" name="__codelineno-15-24"></a>        <span class="n">élève11</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="n">classe1</span><span class="p">})</span>
<a id="__codelineno-15-25" name="__codelineno-15-25"></a>        <span class="n">élève21</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom2&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom2&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="n">classe1</span><span class="p">})</span>
<a id="__codelineno-15-26" name="__codelineno-15-26"></a>        <span class="n">élève32</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom3&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom3&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="n">classe2</span><span class="p">})</span>
<a id="__codelineno-15-27" name="__codelineno-15-27"></a>        <span class="n">élève42</span> <span class="o">=</span> <span class="n">Elève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom4&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom4&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="n">classe2</span><span class="p">})</span>
<a id="__codelineno-15-28" name="__codelineno-15-28"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">élèves</span> <span class="o">=</span> <span class="p">[</span><span class="n">élève11</span><span class="p">,</span> <span class="n">élève21</span><span class="p">,</span> <span class="n">élève32</span><span class="p">,</span> <span class="n">élève42</span><span class="p">]</span>
<a id="__codelineno-15-29" name="__codelineno-15-29"></a>        <span class="c1"># les notes des élèves dans les différentes matières</span>
<a id="__codelineno-15-30" name="__codelineno-15-30"></a>        <span class="n">note1</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève11</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière1</span><span class="p">})</span>
<a id="__codelineno-15-31" name="__codelineno-15-31"></a>        <span class="n">note2</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève21</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière1</span><span class="p">})</span>
<a id="__codelineno-15-32" name="__codelineno-15-32"></a>        <span class="n">note3</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève32</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière1</span><span class="p">})</span>
<a id="__codelineno-15-33" name="__codelineno-15-33"></a>        <span class="n">note4</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève42</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière1</span><span class="p">})</span>
<a id="__codelineno-15-34" name="__codelineno-15-34"></a>        <span class="n">note5</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève11</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière2</span><span class="p">})</span>
<a id="__codelineno-15-35" name="__codelineno-15-35"></a>        <span class="n">note6</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève21</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière2</span><span class="p">})</span>
<a id="__codelineno-15-36" name="__codelineno-15-36"></a>        <span class="n">note7</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève32</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière2</span><span class="p">})</span>
<a id="__codelineno-15-37" name="__codelineno-15-37"></a>        <span class="n">note8</span> <span class="o">=</span> <span class="n">Note</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève42</span><span class="p">,</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="n">matière2</span><span class="p">})</span>
<a id="__codelineno-15-38" name="__codelineno-15-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">notes</span> <span class="o">=</span> <span class="p">[</span><span class="n">note1</span><span class="p">,</span> <span class="n">note2</span><span class="p">,</span> <span class="n">note3</span><span class="p">,</span> <span class="n">note4</span><span class="p">,</span> <span class="n">note5</span><span class="p">,</span> <span class="n">note6</span><span class="p">,</span> <span class="n">note7</span><span class="p">,</span> <span class="n">note8</span><span class="p">]</span>
<a id="__codelineno-15-39" name="__codelineno-15-39"></a>
<a id="__codelineno-15-40" name="__codelineno-15-40"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-15-41" name="__codelineno-15-41"></a>    <span class="c1"># interface IDao</span>
<a id="__codelineno-15-42" name="__codelineno-15-42"></a>    <span class="c1"># -----------</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong> :</p>
<ul>
<li>lignes 1-7 : on importe les entités et l&#x27;interface <strong>[</strong><strong>InterfaceDao</strong><strong>]</strong> ;</li>
<li>ligne 11 : la classe <strong>[Dao]</strong> dérive de la classe abstraite <strong>[</strong><strong>InterfaceDao</strong><strong>]</strong>. Nous dirons qu&#x27;elle implémente l&#x27;interface <strong>[</strong><strong>InterfaceDao</strong><strong>]</strong> ;</li>
<li>ligne 14 : le constructeur n&#x27;a pas de paramètres. Il construit en dur quatre listes :</li>
<li>lignes 15-18 : la liste des classes ;</li>
<li>lignes 19-22 : la liste des matières ;</li>
<li>lignes 23-28 : la liste des élèves ;</li>
<li>lignes 29-38 : la liste des notes ;</li>
<li>lignes 40-44 : implémentation des méthodes de l’interface <strong>[Interface Dao]</strong>. Ici, nous ne les définissons pas pour voir le message d’erreur émis par Python ;
Un programme de test pourrait être le suivant <strong>[tests-dao.py]</strong> :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span>
<span class="normal"><a href="#__codelineno-16-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="c1"># instanciation couche [dao]</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Dao</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dao</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="n">daoImpl</span> <span class="o">=</span> <span class="n">Dao</span><span class="p">()</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="c1"># liste des classes</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="k">for</span> <span class="n">classe</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_classes</span><span class="p">():</span>
<a id="__codelineno-16-13" name="__codelineno-16-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">classe</span><span class="p">)</span>
<a id="__codelineno-16-14" name="__codelineno-16-14"></a>
<a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="c1"># liste des matières</span>
<a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="k">for</span> <span class="n">matière</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_matières</span><span class="p">():</span>
<a id="__codelineno-16-17" name="__codelineno-16-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">matière</span><span class="p">)</span>
<a id="__codelineno-16-18" name="__codelineno-16-18"></a>
<a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="c1"># liste des classes</span>
<a id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="k">for</span> <span class="n">élève</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_élèves</span><span class="p">():</span>
<a id="__codelineno-16-21" name="__codelineno-16-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">élève</span><span class="p">)</span>
<a id="__codelineno-16-22" name="__codelineno-16-22"></a>
<a id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="c1"># liste des notes</span>
<a id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_notes</span><span class="p">():</span>
<a id="__codelineno-16-25" name="__codelineno-16-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Note</strong> : le script <strong>[tests-dao.py]</strong> n&#x27;est pas un test <strong>[unittest]</strong> car il ne contient pas de méthodes avec un nom commençant par <strong>[test_]</strong>.</p>
<p>Les commentaires se suffisent à eux-mêmes. Les lignes 11-25 utilisent l&#x27;interface de la couche <strong>[dao]</strong>. Il n&#x27;y a pas là d&#x27;hypothèses sur l&#x27;implémentation réelle de la couche. Ligne 9, on instancie la couche <strong>[dao]</strong>.</p>
<p>Les résultats de l&#x27;exécution de ce script sont les suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span>
<span class="normal"><a href="#__codelineno-17-2">2</a></span>
<span class="normal"><a href="#__codelineno-17-3">3</a></span>
<span class="normal"><a href="#__codelineno-17-4">4</a></span>
<span class="normal"><a href="#__codelineno-17-5">5</a></span>
<span class="normal"><a href="#__codelineno-17-6">6</a></span>
<span class="normal"><a href="#__codelineno-17-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">tests_dao</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>  <span class="n">File</span> <span class="s2">&quot;C:/Data/st-2020/dev/python/cours-2020/python3-flask-2020/troiscouches/v01/tests/tests_dao.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">9</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>    <span class="n">daoImpl</span> <span class="o">=</span> <span class="n">Dao</span><span class="p">()</span>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="ne">TypeError</span><span class="p">:</span> <span class="n">Can</span><span class="s1">&#39;t instantiate abstract class Dao with abstract methods get_classes, get_matières, get_notes, get_notes_for_élève_by_id, get_élève_by_id, get_élèves</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
<p>On voit qu&#x27;une erreur se produit dès l&#x27;instanciation de la classe <strong>[Dao]</strong> (ligne 3 ci-dessus). L&#x27;interpréteur Python 3 nous dit qu&#x27;il ne peut instancier la classe, ceci parce que nous n&#x27;avons pas défini les méthodes abstraites <strong>[get_classes, get_matières, get_notes, get_notes_for_élève_by_id, get_élève_by_id, get_élèves]</strong>.</p>
<p>Pycharm a également la notion de classe abstraite et nous propose de définir les méhodes de celle-ci :</p>
<p><img src="images/10000000000005B5000003042EF1D7AD.png" style="width:16.89cm;height:8.921cm;" alt="Image" /></p>
<ul>
<li>en <strong>[1]</strong>, cliquer droit sur le code ;</li>
<li>en <strong>[2-3]</strong>, choisir <strong>[Generate / Implement Methods]</strong> pour implémenter les méthodes manquantes de la classe <strong>[Dao]</strong> ;</li>
<li>en <strong>[4]</strong>, choisir les méthodes à implémenter, ici toutes ;
Ceci fait, la classe <strong>[Dao]</strong> est complétée par PyCharm de la façon suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a>    <span class="c1"># interface IDao</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a>        <span class="k">pass</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_élèves</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a>        <span class="k">pass</span>
<a id="__codelineno-18-10" name="__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_matières</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-18-12" name="__codelineno-18-12"></a>        <span class="k">pass</span>
<a id="__codelineno-18-13" name="__codelineno-18-13"></a>
<a id="__codelineno-18-14" name="__codelineno-18-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_notes</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-18-15" name="__codelineno-18-15"></a>        <span class="k">pass</span>
<a id="__codelineno-18-16" name="__codelineno-18-16"></a>
<a id="__codelineno-18-17" name="__codelineno-18-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_notes_for_élève_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">élève_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-18-18" name="__codelineno-18-18"></a>        <span class="k">pass</span>
<a id="__codelineno-18-19" name="__codelineno-18-19"></a>
<a id="__codelineno-18-20" name="__codelineno-18-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_élève_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">élève_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Elève</span><span class="p">:</span>
<a id="__codelineno-18-21" name="__codelineno-18-21"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p>Nous complétons la classe <strong>[Dao]</strong> de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span>
<span class="normal"><a href="#__codelineno-19-22">22</a></span>
<span class="normal"><a href="#__codelineno-19-23">23</a></span>
<span class="normal"><a href="#__codelineno-19-24">24</a></span>
<span class="normal"><a href="#__codelineno-19-25">25</a></span>
<span class="normal"><a href="#__codelineno-19-26">26</a></span>
<span class="normal"><a href="#__codelineno-19-27">27</a></span>
<span class="normal"><a href="#__codelineno-19-28">28</a></span>
<span class="normal"><a href="#__codelineno-19-29">29</a></span>
<span class="normal"><a href="#__codelineno-19-30">30</a></span>
<span class="normal"><a href="#__codelineno-19-31">31</a></span>
<span class="normal"><a href="#__codelineno-19-32">32</a></span>
<span class="normal"><a href="#__codelineno-19-33">33</a></span>
<span class="normal"><a href="#__codelineno-19-34">34</a></span>
<span class="normal"><a href="#__codelineno-19-35">35</a></span>
<span class="normal"><a href="#__codelineno-19-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a>    <span class="c1"># interface IDao</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a>    <span class="c1"># liste des classes</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a>    <span class="c1"># liste des matières</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_matières</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matières</span>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a>    <span class="c1"># liste des élèves</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_élèves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">élèves</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a>    <span class="c1"># liste des notes</span>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_notes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">notes</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a>
<a id="__codelineno-19-21" name="__codelineno-19-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_notes_for_élève_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">élève_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-19-22" name="__codelineno-19-22"></a>        <span class="c1"># on recherche l&#39;élève</span>
<a id="__codelineno-19-23" name="__codelineno-19-23"></a>        <span class="n">élève</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_élève_by_id</span><span class="p">(</span><span class="n">élève_id</span><span class="p">)</span>
<a id="__codelineno-19-24" name="__codelineno-19-24"></a>        <span class="c1"># on récupère ses notes</span>
<a id="__codelineno-19-25" name="__codelineno-19-25"></a>        <span class="n">notes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">n</span><span class="p">:</span> <span class="n">n</span><span class="o">.</span><span class="n">élève</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">élève_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_notes</span><span class="p">()))</span>
<a id="__codelineno-19-26" name="__codelineno-19-26"></a>        <span class="c1"># on rend le résultat</span>
<a id="__codelineno-19-27" name="__codelineno-19-27"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève</span><span class="p">,</span> <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="n">notes</span><span class="p">}</span>
<a id="__codelineno-19-28" name="__codelineno-19-28"></a>
<a id="__codelineno-19-29" name="__codelineno-19-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_élève_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">élève_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Elève</span><span class="p">:</span>
<a id="__codelineno-19-30" name="__codelineno-19-30"></a>        <span class="c1"># on filtre les élèves</span>
<a id="__codelineno-19-31" name="__codelineno-19-31"></a>        <span class="n">élèves</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">élève_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_élèves</span><span class="p">()))</span>
<a id="__codelineno-19-32" name="__codelineno-19-32"></a>        <span class="c1"># trouvé ?</span>
<a id="__codelineno-19-33" name="__codelineno-19-33"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">élèves</span><span class="p">:</span>
<a id="__codelineno-19-34" name="__codelineno-19-34"></a>            <span class="k">raise</span> <span class="n">MyException</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;L&#39;élève d&#39;identifiant </span><span class="si">{</span><span class="n">élève_id</span><span class="si">}</span><span class="s2"> n&#39;existe pas&quot;</span><span class="p">)</span>
<a id="__codelineno-19-35" name="__codelineno-19-35"></a>        <span class="c1"># résultat</span>
<a id="__codelineno-19-36" name="__codelineno-19-36"></a>        <span class="k">return</span> <span class="n">élèves</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>les lignes 5-19 ne posent pas de difficultés ;</li>
<li>lignes 29-36 : la méthode qui rend l’élève dont on passe le numéro. Si l’élève n’existe pas, une exception est levée ;</li>
<li>ligne 31 : la fonction <strong>[filter]</strong> permet de filtrer une liste :</li>
<li>le 1er paramètre est le critère de filtrage ;</li>
<li>le second paramètre est la liste à filtrer, ici la liste des élèves ; </li>
<li>ligne 31 : le critère de filtrage de la liste est implémenté à l’aide d’une fonction <strong>[f(e :Elève)-&gt;bool]</strong>. Celle-ci est appliquée à chacun des éléments de la liste à filtrer. Si l’élément satisfait le critère de filtrage, il est retenu dans la liste filtrée, sinon il en est exclu. On peut ici soit :</li>
<li>donner le nom de la fonction f et implémenter celle-ci ailleurs. L’appel à la fonction <strong>[filter]</strong> devient alors <strong>[filter(f,self.get_élèves()]</strong> ;</li>
<li>donner la définition de la fonction f. L’appel à la fonction <strong>[filter]</strong> devient alors <strong>[filter(f(e :Elève){…},self.get_élèves()]</strong><strong> </strong>où <strong>[e]</strong> représente un élément de la liste filtrée, ç-à-d un élève. C’est ce qui a été fait ici. La définition de la fonction f serait ici <strong>[f(e :Elève){return e.id==élève_id)]</strong> : un élève n’est retenu que si non n° <strong>[id]</strong> est égal à celui cherché. Une telle fonction peut être remplacée par une fonction dite lambda : <strong>[</strong><strong>lambda</strong><strong> </strong><strong>e</strong><strong>: </strong><strong>e</strong><strong>.id == </strong><strong>élève_id</strong><strong>]</strong> : </li>
<li>e : représente le paramètre de la fonction f, ici un élève. On peut utiliser le nom que l’on veut ;</li>
<li>e.id==élève_id est le critère de filtrage : un élève <strong>[e]</strong> n’est retenu que si son n° <strong>[id]</strong> correspond à celui qui est cherché ;</li>
<li>ligne 31 : la fonction <strong>[filter]</strong> rend la liste filtrée sous un type qui n’est pas le type <strong>[list]</strong> mais qui supporte d’être transformé en type <strong>[list]</strong>. C’est ce que nous faisons ici avec l’expression <strong>[list(liste filtrée)]</strong> ;</li>
<li>lignes 33-34 : si la liste filtrée est vide c’est que l’élève cherché n’existe pas. On lève alors une exception ;</li>
<li>ligne 36 : si on arrive ici, c’est qu’il n’y a pas eu d’exception. On sait alors qu’on a récupéré une liste à 1 élément (il n’y a pas deux élèves ayant le même n° <strong>[id]</strong>). On rend donc le 1er élément de la liste ;</li>
<li>lignes 21-27 : la méthode <strong>[</strong><strong>get_notes_for_élève_by_id</strong><strong>]</strong> doit rendre les notes de l’élève dont on lui passe le n° <strong>[id]</strong> ;</li>
<li>lignes 22-23 : on commence par rechercher l’élève de n° <strong>[élève_id]</strong> à l’aide de la méthode <strong>[</strong><strong>get_élève_by_id</strong><strong>]</strong> que l’on vient de commenter. Il peut se produire une exception si l’élève cherché n’existe pas. Comme il n’y a pas de try / catch autour de l’instruction de la ligne 23, l’exception remontera au code appelant. C’est ce qui est désiré ;</li>
<li>lignes 24-25 : une fois l’élève récupéré, on récupère toutes ses notes. On le fait de nouveau avec un filtre :</li>
<li>le filtre est <strong>[filter(critère, self_getnotes()]</strong>. La liste à filtrer est donc la liste de toutes les notes de tous les élèves du collège ;</li>
<li>le critère de filtrage est exprimé à l’aide d’une fonction <strong>[lambda]</strong> : lambda n: n.élève.id == élève_id. Le paramètre n est un élément de la liste à filtrer, donc une note. Le type <strong>[Note]</strong> a une propriété <strong>[élève]</strong> qui représente l’élève propriétaire de la note. Il faut alors que <strong>[n.élève.id]</strong> qui représente le n° de cet élève soit égal au numéro de l’élève cherché ;
Puis nous exécutons le script <strong>[tests-dao.py]</strong>.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span>
<span class="normal"><a href="#__codelineno-20-30">30</a></span>
<span class="normal"><a href="#__codelineno-20-31">31</a></span>
<span class="normal"><a href="#__codelineno-20-32">32</a></span>
<span class="normal"><a href="#__codelineno-20-33">33</a></span>
<span class="normal"><a href="#__codelineno-20-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="c1"># instanciation couche [dao]</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Dao</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dao</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="n">daoImpl</span> <span class="o">=</span> <span class="n">Dao</span><span class="p">()</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="c1"># liste des classes</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="k">for</span> <span class="n">classe</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_classes</span><span class="p">():</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">classe</span><span class="p">)</span>
<a id="__codelineno-20-14" name="__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="c1"># liste des matières</span>
<a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="k">for</span> <span class="n">matière</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_matières</span><span class="p">():</span>
<a id="__codelineno-20-17" name="__codelineno-20-17"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">matière</span><span class="p">)</span>
<a id="__codelineno-20-18" name="__codelineno-20-18"></a>
<a id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="c1"># liste des classes</span>
<a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="k">for</span> <span class="n">élève</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_élèves</span><span class="p">():</span>
<a id="__codelineno-20-21" name="__codelineno-20-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">élève</span><span class="p">)</span>
<a id="__codelineno-20-22" name="__codelineno-20-22"></a>
<a id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="c1"># liste des notes</span>
<a id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_notes</span><span class="p">():</span>
<a id="__codelineno-20-25" name="__codelineno-20-25"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>
<a id="__codelineno-20-26" name="__codelineno-20-26"></a>
<a id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="c1"># un élève particulier</span>
<a id="__codelineno-20-28" name="__codelineno-20-28"></a><span class="nb">print</span><span class="p">(</span><span class="n">daoImpl</span><span class="o">.</span><span class="n">get_élève_by_id</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
<a id="__codelineno-20-29" name="__codelineno-20-29"></a>
<a id="__codelineno-20-30" name="__codelineno-20-30"></a><span class="c1"># la liste de ses notes</span>
<a id="__codelineno-20-31" name="__codelineno-20-31"></a><span class="n">dict1</span> <span class="o">=</span> <span class="n">daoImpl</span><span class="o">.</span><span class="n">get_notes_for_élève_by_id</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a id="__codelineno-20-32" name="__codelineno-20-32"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;élève n° 11 = </span><span class="si">{</span><span class="n">dict1</span><span class="p">[</span><span class="s1">&#39;élève&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-20-33" name="__codelineno-20-33"></a><span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">dict1</span><span class="p">[</span><span class="s2">&quot;notes&quot;</span><span class="p">]:</span>
<a id="__codelineno-20-34" name="__codelineno-20-34"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;note de l&#39;élève n° 11 = </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>Nous obtenons alors les résultats suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">tests_dao</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière1&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<a id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}}</span>
<a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom2&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom2&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}}</span>
<a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom3&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom3&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}}</span>
<a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom4&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom4&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}}</span>
<a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière1&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom2&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom2&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière1&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<a id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom3&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom3&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière1&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<a id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom4&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom4&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière1&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}</span>
<a id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom2&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom2&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}</span>
<a id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom3&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom3&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}</span>
<a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;valeur&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom4&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom4&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe2&quot;</span><span class="p">}},</span> <span class="s2">&quot;matière&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;matière2&quot;</span><span class="p">,</span> <span class="s2">&quot;coefficient&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}}</span>
<a id="__codelineno-21-18" name="__codelineno-21-18"></a><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}}</span>
<a id="__codelineno-21-19" name="__codelineno-21-19"></a><span class="n">élève</span> <span class="n">n</span><span class="err">°</span> <span class="mi">11</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}}</span>
<a id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="n">note</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève n° 11 = {&quot;id&quot;: 1, &quot;valeur&quot;: 10, &quot;élève&quot;: {&quot;id&quot;: 11, &quot;nom&quot;: &quot;nom1&quot;, &quot;prénom&quot;: &quot;prénom1&quot;, &quot;classe&quot;: {&quot;id&quot;: 1, &quot;nom&quot;: &quot;classe1&quot;}}, &quot;matière&quot;: {&quot;id&quot;: 1, &quot;nom&quot;: &quot;matière1&quot;, &quot;coefficient&quot;: 1}}</span>
<a id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="n">note</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève n° 11 = {&quot;id&quot;: 5, &quot;valeur&quot;: 6, &quot;élève&quot;: {&quot;id&quot;: 11, &quot;nom&quot;: &quot;nom1&quot;, &quot;prénom&quot;: &quot;prénom1&quot;, &quot;classe&quot;: {&quot;id&quot;: 1, &quot;nom&quot;: &quot;classe1&quot;}}, &quot;matière&quot;: {&quot;id&quot;: 2, &quot;nom&quot;: &quot;matière2&quot;, &quot;coefficient&quot;: 2}}</span>
<a id="__codelineno-21-22" name="__codelineno-21-22"></a>
<a id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>On pourra remarquer que lorsqu’on affiche une note (pour les autres objets, c’est similaire), on a également :</p>
<ul>
<li>l’élève propriétaire de la note ;</li>
<li>la matière référencée par la note ;
C’est la fonction <strong>[BaseEntity.asdict]</strong> qui produit ce résultat (cf. paragraphe <a href="#_La_classe_[BaseEntity]"><u><u>lien</u></u></a>).</li>
</ul>
<h3 id="1425-la-couche-metier">14.2.5. La couche [métier]</h3>
<table class="odt-table" style="border-collapse: collapse; width: 100%; margin-bottom: 1em;"><tr><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/1000000100000250000000E5BCFA285A.png" style="display:inline-block; margin:4px;width:7.062cm;height:2.731cm;" /></td><td style="border: 1px solid #ddd; padding: 8px; vertical-align: top;"><img src="images/100000000000019E0000029B19CC59FA.png" style="display:inline-block; margin:4px;width:4.31cm;height:6.921cm;" /></td></tr></table>

<ul>
<li><strong>[InterfaceMétier]</strong> est l’interface de la couche <strong>[métier]</strong> ;</li>
<li><strong>[Métier]</strong> est la classe d’implémentation de la couche <strong>[métier]</strong> ;</li>
<li><strong>[Testmétier]</strong> est une classe <strong>[UnitTest]</strong> de test de la classe <strong>[Métier]</strong> ;</li>
</ul>
<h4 id="14251-interface-interfacemetier">14.2.5.1. Interface [InterfaceMétier]</h4>
<p>La couche <strong>[métier]</strong> implémentera l&#x27;interface <strong>[InterfaceMétier]</strong> suivante (InterfaceMétier.py) :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="c1"># imports</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">StatsForElève</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatsForElève</span>
<a id="__codelineno-22-5" name="__codelineno-22-5"></a>
<a id="__codelineno-22-6" name="__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="c1"># interface Métier</span>
<a id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">InterfaceMétier</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-22-9" name="__codelineno-22-9"></a>    <span class="c1"># calcul de statistiques pour un élève</span>
<a id="__codelineno-22-10" name="__codelineno-22-10"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-22-11" name="__codelineno-22-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_stats_for_élève</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idElève</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatsForElève</span><span class="p">:</span>
<a id="__codelineno-22-12" name="__codelineno-22-12"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li><strong>[get_stats_for_élève]</strong> rend les notes de l&#x27;élève n° idElève ainsi que des informations sur celles-ci : moyenne pondérée, note la plus basse, note la plus haute. Ces informations sont encapsulées dans un objet de type <strong>[</strong><strong>StatsForElève</strong><strong>]</strong> ;</li>
</ul>
<h4 id="14252-lentite-statsforeleve">14.2.5.2. L&#x27;entité [StatsForElève]</h4>
<p>Le type <strong>[StatsForElève]</strong> (StatsForElève.py) qui encapsule les statistiques (notes, min, max, moyenne pondérée) d&#x27;un élève est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span>
<span class="normal"><a href="#__codelineno-23-21">21</a></span>
<span class="normal"><a href="#__codelineno-23-22">22</a></span>
<span class="normal"><a href="#__codelineno-23-23">23</a></span>
<span class="normal"><a href="#__codelineno-23-24">24</a></span>
<span class="normal"><a href="#__codelineno-23-25">25</a></span>
<span class="normal"><a href="#__codelineno-23-26">26</a></span>
<span class="normal"><a href="#__codelineno-23-27">27</a></span>
<span class="normal"><a href="#__codelineno-23-28">28</a></span>
<span class="normal"><a href="#__codelineno-23-29">29</a></span>
<span class="normal"><a href="#__codelineno-23-30">30</a></span>
<span class="normal"><a href="#__codelineno-23-31">31</a></span>
<span class="normal"><a href="#__codelineno-23-32">32</a></span>
<span class="normal"><a href="#__codelineno-23-33">33</a></span>
<span class="normal"><a href="#__codelineno-23-34">34</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1"># imports</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">BaseEntity</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseEntity</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="c1"># statistiques d&#39;un élève particulier</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a>
<a id="__codelineno-23-7" name="__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">StatsForElève</span><span class="p">(</span><span class="n">BaseEntity</span><span class="p">):</span>
<a id="__codelineno-23-9" name="__codelineno-23-9"></a>    <span class="c1"># attributs exclus de l&#39;état de la classe</span>
<a id="__codelineno-23-10" name="__codelineno-23-10"></a>    <span class="n">excluded_keys</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-23-11" name="__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12"></a>    <span class="c1"># propriétés de la classe</span>
<a id="__codelineno-23-13" name="__codelineno-23-13"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-23-14" name="__codelineno-23-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_allowed_keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<a id="__codelineno-23-15" name="__codelineno-23-15"></a>        <span class="c1"># id : identifiant de la note</span>
<a id="__codelineno-23-16" name="__codelineno-23-16"></a>        <span class="c1"># élève : l&#39;élève concerné</span>
<a id="__codelineno-23-17" name="__codelineno-23-17"></a>        <span class="c1"># notes : ses notes</span>
<a id="__codelineno-23-18" name="__codelineno-23-18"></a>        <span class="c1"># moyennePondérée : sa moyenne pondérée par les coefficients des matières</span>
<a id="__codelineno-23-19" name="__codelineno-23-19"></a>        <span class="c1"># min : sa note minimale</span>
<a id="__codelineno-23-20" name="__codelineno-23-20"></a>        <span class="c1"># max : sa note maximale</span>
<a id="__codelineno-23-21" name="__codelineno-23-21"></a>
<a id="__codelineno-23-22" name="__codelineno-23-22"></a>        <span class="k">return</span> <span class="n">BaseEntity</span><span class="o">.</span><span class="n">get_allowed_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;élève&quot;</span><span class="p">,</span> <span class="s2">&quot;notes&quot;</span><span class="p">,</span> <span class="s2">&quot;moyenne_pondérée&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">]</span>
<a id="__codelineno-23-23" name="__codelineno-23-23"></a>
<a id="__codelineno-23-24" name="__codelineno-23-24"></a>    <span class="c1"># toString</span>
<a id="__codelineno-23-25" name="__codelineno-23-25"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-23-26" name="__codelineno-23-26"></a>        <span class="c1"># cas de l&#39;élève sans notes</span>
<a id="__codelineno-23-27" name="__codelineno-23-27"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-23-28" name="__codelineno-23-28"></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Elève=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">élève</span><span class="si">}</span><span class="s2">, notes=[]&quot;</span>
<a id="__codelineno-23-29" name="__codelineno-23-29"></a>        <span class="c1"># cas de l&#39;élève avec notes</span>
<a id="__codelineno-23-30" name="__codelineno-23-30"></a>        <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-23-31" name="__codelineno-23-31"></a>        <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notes</span><span class="p">:</span>
<a id="__codelineno-23-32" name="__codelineno-23-32"></a>            <span class="nb">str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">note</span><span class="o">.</span><span class="n">valeur</span><span class="si">}</span><span class="s2"> &quot;</span>
<a id="__codelineno-23-33" name="__codelineno-23-33"></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Elève=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">élève</span><span class="si">}</span><span class="s2">, notes=[</span><span class="si">{</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">], max=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max</span><span class="si">}</span><span class="s2">, min=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">min</span><span class="si">}</span><span class="s2">, &quot;</span> \
<a id="__codelineno-23-34" name="__codelineno-23-34"></a>               <span class="sa">f</span><span class="s2">&quot;moyenne pondérée=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">moyenne_pondérée</span><span class="si">:</span><span class="s2">4.2f</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong> :</p>
<ul>
<li>ligne 8 : la classe <strong>[StatsForElève]</strong> dérive de la classe <strong>[BaseEntity]</strong> ;</li>
<li>lignes 13-22 : les propriétés de la classe ;</li>
<li>un identifiant <strong>[id]</strong> provenant de <strong>[BaseEntity]</strong> ;</li>
<li>l&#x27;élève <strong>[élève]</strong> dont on encapsile les statistiques ;</li>
<li>ses notes <strong>[notes]</strong> ;</li>
<li>sa moyenne pondérée <strong>[moyenne_pondérée]</strong> ;</li>
<li>sa note minimale <strong>[min]</strong> ;</li>
<li>sa note maximale <strong>[max]</strong> ;</li>
<li>on ne définit pas de getters / setters pour ces attributs. On part du principe que c&#x27;est la couche <strong>[métier]</strong> qui crée des objets de ce type et que celle-ci ne crée pas d&#x27;objets invalides ;</li>
<li>lignes 23-33 : la fonction <strong>[<strong>str</strong>]</strong> rend une chaîne de caractères reprenant les propriétés de l’objet ;</li>
</ul>
<h4 id="14253-limplementation-metier">14.2.5.3. L&#x27;implémentation [Métier]</h4>
<p>L&#x27;implémentation <strong>[</strong><strong>Métier</strong><strong>]</strong> (Metier.py) de l&#x27;interface <strong>[</strong><strong>InterfaceMétier</strong><strong>]</strong> sera la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span>
<span class="normal"><a href="#__codelineno-24-16">16</a></span>
<span class="normal"><a href="#__codelineno-24-17">17</a></span>
<span class="normal"><a href="#__codelineno-24-18">18</a></span>
<span class="normal"><a href="#__codelineno-24-19">19</a></span>
<span class="normal"><a href="#__codelineno-24-20">20</a></span>
<span class="normal"><a href="#__codelineno-24-21">21</a></span>
<span class="normal"><a href="#__codelineno-24-22">22</a></span>
<span class="normal"><a href="#__codelineno-24-23">23</a></span>
<span class="normal"><a href="#__codelineno-24-24">24</a></span>
<span class="normal"><a href="#__codelineno-24-25">25</a></span>
<span class="normal"><a href="#__codelineno-24-26">26</a></span>
<span class="normal"><a href="#__codelineno-24-27">27</a></span>
<span class="normal"><a href="#__codelineno-24-28">28</a></span>
<span class="normal"><a href="#__codelineno-24-29">29</a></span>
<span class="normal"><a href="#__codelineno-24-30">30</a></span>
<span class="normal"><a href="#__codelineno-24-31">31</a></span>
<span class="normal"><a href="#__codelineno-24-32">32</a></span>
<span class="normal"><a href="#__codelineno-24-33">33</a></span>
<span class="normal"><a href="#__codelineno-24-34">34</a></span>
<span class="normal"><a href="#__codelineno-24-35">35</a></span>
<span class="normal"><a href="#__codelineno-24-36">36</a></span>
<span class="normal"><a href="#__codelineno-24-37">37</a></span>
<span class="normal"><a href="#__codelineno-24-38">38</a></span>
<span class="normal"><a href="#__codelineno-24-39">39</a></span>
<span class="normal"><a href="#__codelineno-24-40">40</a></span>
<span class="normal"><a href="#__codelineno-24-41">41</a></span>
<span class="normal"><a href="#__codelineno-24-42">42</a></span>
<span class="normal"><a href="#__codelineno-24-43">43</a></span>
<span class="normal"><a href="#__codelineno-24-44">44</a></span>
<span class="normal"><a href="#__codelineno-24-45">45</a></span>
<span class="normal"><a href="#__codelineno-24-46">46</a></span>
<span class="normal"><a href="#__codelineno-24-47">47</a></span>
<span class="normal"><a href="#__codelineno-24-48">48</a></span>
<span class="normal"><a href="#__codelineno-24-49">49</a></span>
<span class="normal"><a href="#__codelineno-24-50">50</a></span>
<span class="normal"><a href="#__codelineno-24-51">51</a></span>
<span class="normal"><a href="#__codelineno-24-52">52</a></span>
<span class="normal"><a href="#__codelineno-24-53">53</a></span>
<span class="normal"><a href="#__codelineno-24-54">54</a></span>
<span class="normal"><a href="#__codelineno-24-55">55</a></span>
<span class="normal"><a href="#__codelineno-24-56">56</a></span>
<span class="normal"><a href="#__codelineno-24-57">57</a></span>
<span class="normal"><a href="#__codelineno-24-58">58</a></span>
<span class="normal"><a href="#__codelineno-24-59">59</a></span>
<span class="normal"><a href="#__codelineno-24-60">60</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="c1"># imports</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceDao</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceDao</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceMétier</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceMétier</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">StatsForElève</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatsForElève</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">Métier</span><span class="p">(</span><span class="n">InterfaceMétier</span><span class="p">):</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>    <span class="c1"># constructeur</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dao</span><span class="p">:</span> <span class="n">InterfaceDao</span><span class="p">):</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a>        <span class="c1"># on mémorise le paramètre</span>
<a id="__codelineno-24-12" name="__codelineno-24-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dao</span> <span class="o">=</span> <span class="n">dao</span>
<a id="__codelineno-24-13" name="__codelineno-24-13"></a>
<a id="__codelineno-24-14" name="__codelineno-24-14"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-24-15" name="__codelineno-24-15"></a>    <span class="c1"># interface</span>
<a id="__codelineno-24-16" name="__codelineno-24-16"></a>    <span class="c1"># -----------</span>
<a id="__codelineno-24-17" name="__codelineno-24-17"></a>
<a id="__codelineno-24-18" name="__codelineno-24-18"></a>    <span class="c1"># les indicateurs sur les notes d&#39;un élève particulier</span>
<a id="__codelineno-24-19" name="__codelineno-24-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_stats_for_élève</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">id_élève</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatsForElève</span><span class="p">:</span>
<a id="__codelineno-24-20" name="__codelineno-24-20"></a>        <span class="c1"># Stats pour l&#39;élève de n° idEleve</span>
<a id="__codelineno-24-21" name="__codelineno-24-21"></a>        <span class="c1"># id_élève : n° de l&#39;élève</span>
<a id="__codelineno-24-22" name="__codelineno-24-22"></a>
<a id="__codelineno-24-23" name="__codelineno-24-23"></a>        <span class="c1"># on récupère ses notes avec la couche [dao]</span>
<a id="__codelineno-24-24" name="__codelineno-24-24"></a>        <span class="n">notes_élève</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dao</span><span class="o">.</span><span class="n">get_notes_for_élève_by_id</span><span class="p">(</span><span class="n">id_élève</span><span class="p">)</span>
<a id="__codelineno-24-25" name="__codelineno-24-25"></a>        <span class="n">élève</span> <span class="o">=</span> <span class="n">notes_élève</span><span class="p">[</span><span class="s2">&quot;élève&quot;</span><span class="p">]</span>
<a id="__codelineno-24-26" name="__codelineno-24-26"></a>        <span class="n">notes</span> <span class="o">=</span> <span class="n">notes_élève</span><span class="p">[</span><span class="s2">&quot;notes&quot;</span><span class="p">]</span>
<a id="__codelineno-24-27" name="__codelineno-24-27"></a>
<a id="__codelineno-24-28" name="__codelineno-24-28"></a>        <span class="c1"># on s&#39;arrête s&#39;il n&#39;y a pas de notes</span>
<a id="__codelineno-24-29" name="__codelineno-24-29"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-30" name="__codelineno-24-30"></a>            <span class="c1"># on rend le résultat</span>
<a id="__codelineno-24-31" name="__codelineno-24-31"></a>            <span class="k">return</span> <span class="n">StatsForElève</span><span class="p">()</span><span class="o">.</span><span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève</span><span class="p">,</span> <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="p">[]})</span>
<a id="__codelineno-24-32" name="__codelineno-24-32"></a>
<a id="__codelineno-24-33" name="__codelineno-24-33"></a>        <span class="c1"># exploitation des notes de l&#39;élève</span>
<a id="__codelineno-24-34" name="__codelineno-24-34"></a>        <span class="n">somme_pondérée</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-35" name="__codelineno-24-35"></a>        <span class="n">somme_coeff</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-36" name="__codelineno-24-36"></a>        <span class="nb">max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a id="__codelineno-24-37" name="__codelineno-24-37"></a>        <span class="nb">min</span> <span class="o">=</span> <span class="mi">21</span>
<a id="__codelineno-24-38" name="__codelineno-24-38"></a>        <span class="k">for</span> <span class="n">note</span> <span class="ow">in</span> <span class="n">notes</span><span class="p">:</span>
<a id="__codelineno-24-39" name="__codelineno-24-39"></a>            <span class="c1"># valeur de la note</span>
<a id="__codelineno-24-40" name="__codelineno-24-40"></a>            <span class="n">valeur</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">valeur</span>
<a id="__codelineno-24-41" name="__codelineno-24-41"></a>            <span class="c1"># coefficient de la matière</span>
<a id="__codelineno-24-42" name="__codelineno-24-42"></a>            <span class="n">coeff</span> <span class="o">=</span> <span class="n">note</span><span class="o">.</span><span class="n">matière</span><span class="o">.</span><span class="n">coefficient</span>
<a id="__codelineno-24-43" name="__codelineno-24-43"></a>            <span class="c1"># somme des coefficients</span>
<a id="__codelineno-24-44" name="__codelineno-24-44"></a>            <span class="n">somme_coeff</span> <span class="o">+=</span> <span class="n">coeff</span>
<a id="__codelineno-24-45" name="__codelineno-24-45"></a>            <span class="c1"># somme pondérée</span>
<a id="__codelineno-24-46" name="__codelineno-24-46"></a>            <span class="n">somme_pondérée</span> <span class="o">+=</span> <span class="n">valeur</span> <span class="o">*</span> <span class="n">coeff</span>
<a id="__codelineno-24-47" name="__codelineno-24-47"></a>            <span class="c1"># recherche du min</span>
<a id="__codelineno-24-48" name="__codelineno-24-48"></a>            <span class="k">if</span> <span class="n">valeur</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">:</span>
<a id="__codelineno-24-49" name="__codelineno-24-49"></a>                <span class="nb">min</span> <span class="o">=</span> <span class="n">valeur</span>
<a id="__codelineno-24-50" name="__codelineno-24-50"></a>            <span class="c1"># recherche du max</span>
<a id="__codelineno-24-51" name="__codelineno-24-51"></a>            <span class="k">if</span> <span class="n">valeur</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
<a id="__codelineno-24-52" name="__codelineno-24-52"></a>                <span class="nb">max</span> <span class="o">=</span> <span class="n">valeur</span>
<a id="__codelineno-24-53" name="__codelineno-24-53"></a>        <span class="c1"># calcul des indicateurs manquants</span>
<a id="__codelineno-24-54" name="__codelineno-24-54"></a>        <span class="n">moyenne_pondérée</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">somme_pondérée</span><span class="p">)</span> <span class="o">/</span> <span class="n">somme_coeff</span>
<a id="__codelineno-24-55" name="__codelineno-24-55"></a>
<a id="__codelineno-24-56" name="__codelineno-24-56"></a>        <span class="c1"># on rend le résultat sous la forme d&#39;un type [StatsForElève]</span>
<a id="__codelineno-24-57" name="__codelineno-24-57"></a>        <span class="k">return</span> <span class="n">StatsForElève</span><span class="p">()</span><span class="o">.</span> \
<a id="__codelineno-24-58" name="__codelineno-24-58"></a>            <span class="n">fromdict</span><span class="p">({</span><span class="s2">&quot;élève&quot;</span><span class="p">:</span> <span class="n">élève</span><span class="p">,</span> <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="n">notes</span><span class="p">,</span>
<a id="__codelineno-24-59" name="__codelineno-24-59"></a>                      <span class="s2">&quot;moyenne_pondérée&quot;</span><span class="p">:</span> <span class="n">moyenne_pondérée</span><span class="p">,</span>
<a id="__codelineno-24-60" name="__codelineno-24-60"></a>                      <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>ligne 7 : la classe <strong>[Métier]</strong> dérive de la classe <strong>[InterfaceMétier]</strong>. On a pris l’habitude de dire qu’elle implémente l’interface <strong>[InterfaceMétier]</strong> ;</li>
<li>lignes 9-12 : le constructeur reçoit pour seul paramètre une référence sur la couche <strong>[dao]</strong>. Ligne 10, on notera qu’on a donné le type <strong>[InterfaceDao]</strong> au paramètre <strong>[dao]</strong>. On n’attend pas une implémentation précise mais simplement une implémentation restectant l’interface <strong>[InterfaceDao]</strong>. Ici, ça n’a pas d’importance puisque Python ne va pas tenir compte de ce type mais c’est une bonne habitude de travailler avec des interfaces plutôt qu’avec des implémentations précises. Le code est alors plus facilement modifiable ;</li>
<li>lignes 19-60 : implémentation de la méthode <strong>[</strong><strong>get_stats_for_élève</strong><strong>]</strong> ;</li>
<li>ligne 19 : la méthode reçoit un unique paramètre, le n° <strong>[idElève]</strong> de l’élève dont on veut les statistiques ;</li>
<li>ligne 24 : on demande à la couche <strong>[dao]</strong>, les notes de l’élève. Cette demande débouche sur une exception si l’élève n’existe pas. Celle-ci n’est pas gérée (absence de try / catch) et remonte donc au code appelant ;</li>
<li>ligne 25 : on arrive ici s’il n’y a pas eu exception. <strong>[notes_élève]</strong> est alors un dictionnaire à deux clés <strong>[élève, note]</strong> :</li>
<li>ligne 25 : on récupère les informations sur l’élève (son nom, sa classe, …) ;</li>
<li>ligne 26 : on récupère ses notes ;</li>
<li>lignes 28-31 : on regarde si l’élève a des notes. S’il n’en a pas, il n’y a pas de statistiques à calculer ;</li>
<li>ligne 31 : on rend un objet <strong>[StatsForElève]</strong> construit à partir d’un dictionnaire avec la méthode <strong>[BaseEntity.fromdict]</strong> ;</li>
<li>lignes 33-54 : on exploite les notes de l’élève pour calculer les statistiques demandées. Les commentaires du code devraient suffire à sa compréhension ;</li>
<li>lignes 56-60 : on rend un objet <strong>[StatsForElève]</strong> construit à partir d’un dictionnaire avec la méthode <strong>[BaseEntity.fromdict]</strong> ;</li>
</ul>
<h4 id="14254-test-de-la-couche-metier">14.2.5.4. Test de la couche [métier]</h4>
<p>Un script <strong>[UnitTest]</strong> de la couche <strong>[métier]</strong> pourrait être le suivant (TestMétier.py) :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span>
<span class="normal"><a href="#__codelineno-25-19">19</a></span>
<span class="normal"><a href="#__codelineno-25-20">20</a></span>
<span class="normal"><a href="#__codelineno-25-21">21</a></span>
<span class="normal"><a href="#__codelineno-25-22">22</a></span>
<span class="normal"><a href="#__codelineno-25-23">23</a></span>
<span class="normal"><a href="#__codelineno-25-24">24</a></span>
<span class="normal"><a href="#__codelineno-25-25">25</a></span>
<span class="normal"><a href="#__codelineno-25-26">26</a></span>
<span class="normal"><a href="#__codelineno-25-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># imports</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="k">class</span><span class="w"> </span><span class="nc">Testmétier</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>        <span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>        <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">test_statsForEleve11</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a>        <span class="c1"># imports</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Dao</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dao</span>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">Métier</span><span class="w"> </span><span class="kn">import</span> <span class="n">Métier</span>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a>        <span class="c1"># on teste les indicateurs de l&#39;élève 11</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a>        <span class="n">dao</span> <span class="o">=</span> <span class="n">Dao</span><span class="p">()</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a>        <span class="n">stats_for_élève</span> <span class="o">=</span> <span class="n">Métier</span><span class="p">(</span><span class="n">dao</span><span class="p">)</span><span class="o">.</span><span class="n">get_stats_for_élève</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a>        <span class="c1"># affichage</span>
<a id="__codelineno-25-19" name="__codelineno-25-19"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">stats=</span><span class="si">{</span><span class="n">stats_for_élève</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-25-20" name="__codelineno-25-20"></a>        <span class="c1"># vérifications</span>
<a id="__codelineno-25-21" name="__codelineno-25-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stats_for_élève</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<a id="__codelineno-25-22" name="__codelineno-25-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">stats_for_élève</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-25-23" name="__codelineno-25-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">assertAlmostEqual</span><span class="p">(</span><span class="n">stats_for_élève</span><span class="o">.</span><span class="n">moyenne_pondérée</span><span class="p">,</span> <span class="mf">7.333</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<a id="__codelineno-25-24" name="__codelineno-25-24"></a>
<a id="__codelineno-25-25" name="__codelineno-25-25"></a>
<a id="__codelineno-25-26" name="__codelineno-25-26"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-25-27" name="__codelineno-25-27"></a>    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>lignes 6-9 : la fonction <strong>[setUp]</strong> est ici utilisée pour configurer le Python Path du test ;</li>
<li>ligne 16 : on instancie la couche <strong>[dao]</strong> ;</li>
<li>ligne 17 : on instancie la couche <strong>[métier]</strong> et on utilise sa méthode <strong>[</strong><strong>get_stats_for_élève</strong><strong>]</strong> pour calculer les statistiques de l’élève n° 11 ;</li>
<li>ligne 19 : on affiche le résultat <strong>[StatsForElève]</strong> obtenu. Comme <strong>[StatsForElève]</strong> dérive de <strong>[BaseEntity]</strong>, c’est la chaîne jSON de <strong>[StatsForElève]</strong> qui est ici affichée ;</li>
<li>ligne 21 : on vérifie la note minimale de l’élève ;</li>
<li>ligne 22 : on vérifie sa note maximale ;</li>
<li>ligne 23 : on teste que la moyenne pondérée vaut 7,333 à 10-3 près. En général, il n&#x27;est pas possible de comparer les nombres réels de façon exacte car de façon interne, ils n&#x27;ont le plus souvent qu&#x27;une représentation approchée ; 
Les résultats du test sont les suivants :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span>
<span class="normal"><a href="#__codelineno-26-12">12</a></span>
<span class="normal"><a href="#__codelineno-26-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">Testing</span> <span class="n">started</span> <span class="n">at</span> <span class="mi">18</span><span class="p">:</span><span class="mi">17</span> <span class="o">...</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="s2">&quot;C:\Program Files\JetBrains\PyCharm Community Edition 2020.1.2\plugins\python-ce\helpers\pycharm\_jb_unittest_runner.py&quot;</span> <span class="o">--</span><span class="n">path</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">TestMétier</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="n">Launching</span> <span class="n">unittests</span> <span class="k">with</span> <span class="n">arguments</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">unittest</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">TestMétier</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">troiscouches</span>\<span class="n">v01</span>\<span class="n">tests</span>
<a id="__codelineno-26-4" name="__codelineno-26-4"></a>
<a id="__codelineno-26-5" name="__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6"></a>
<a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="n">Ran</span> <span class="mi">1</span> <span class="n">test</span> <span class="ow">in</span> <span class="mf">0.015</span><span class="n">s</span>
<a id="__codelineno-26-8" name="__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="n">OK</span>
<a id="__codelineno-26-10" name="__codelineno-26-10"></a>
<a id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="n">stats</span><span class="o">=</span><span class="n">Elève</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}},</span> <span class="n">notes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span> <span class="mi">6</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">moyenne</span> <span class="n">pondérée</span><span class="o">=</span><span class="mf">7.33</span>
<a id="__codelineno-26-12" name="__codelineno-26-12"></a>
<a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<h3 id="1426-la-couche-ui">14.2.6. La couche [ui]</h3>
<p><img src="images/100000000000053C00000277D270FF4C.png" style="width:15.47cm;height:7.28cm;" alt="Image" /></p>
<ul>
<li>en <strong>[1]</strong>, l’interface de la couche <strong>[ui]</strong> ;</li>
<li>en <strong>[2]</strong>, l’implémentation de cette interface ;</li>
<li>en <strong>[3]</strong>, le script principal de l’application ;</li>
</ul>
<h4 id="14261-interface-interfaceui">14.2.6.1. Interface [InterfaceUi]</h4>
<p>L&#x27;interface de la couche <strong>[UI]</strong> sera la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-27-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-27-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-27-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-27-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-27-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-27-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-27-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-27-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-27-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="c1"># imports</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4"></a>
<a id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="c1"># interface UI</span>
<a id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">InterfaceUi</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-27-7" name="__codelineno-27-7"></a>    <span class="c1"># exécution de la couche UI</span>
<a id="__codelineno-27-8" name="__codelineno-27-8"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-27-9" name="__codelineno-27-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">):</span>
<a id="__codelineno-27-10" name="__codelineno-27-10"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<p><strong>Notes</strong></p>
<ul>
<li>lignes 9-10 : la couche <strong>[UI]</strong> n&#x27;aura qu&#x27;une méthode, <strong>[run]</strong> ;</li>
</ul>
<h4 id="14262-limplementation-console">14.2.6.2. L&#x27;implémentation [Console]</h4>
<p>La couche <strong>[console]</strong> est implémentée par le script <strong>[Console.py]</strong> suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span>
<span class="normal"><a href="#__codelineno-28-26">26</a></span>
<span class="normal"><a href="#__codelineno-28-27">27</a></span>
<span class="normal"><a href="#__codelineno-28-28">28</a></span>
<span class="normal"><a href="#__codelineno-28-29">29</a></span>
<span class="normal"><a href="#__codelineno-28-30">30</a></span>
<span class="normal"><a href="#__codelineno-28-31">31</a></span>
<span class="normal"><a href="#__codelineno-28-32">32</a></span>
<span class="normal"><a href="#__codelineno-28-33">33</a></span>
<span class="normal"><a href="#__codelineno-28-34">34</a></span>
<span class="normal"><a href="#__codelineno-28-35">35</a></span>
<span class="normal"><a href="#__codelineno-28-36">36</a></span>
<span class="normal"><a href="#__codelineno-28-37">37</a></span>
<span class="normal"><a href="#__codelineno-28-38">38</a></span>
<span class="normal"><a href="#__codelineno-28-39">39</a></span>
<span class="normal"><a href="#__codelineno-28-40">40</a></span>
<span class="normal"><a href="#__codelineno-28-41">41</a></span>
<span class="normal"><a href="#__codelineno-28-42">42</a></span>
<span class="normal"><a href="#__codelineno-28-43">43</a></span>
<span class="normal"><a href="#__codelineno-28-44">44</a></span>
<span class="normal"><a href="#__codelineno-28-45">45</a></span>
<span class="normal"><a href="#__codelineno-28-46">46</a></span>
<span class="normal"><a href="#__codelineno-28-47">47</a></span>
<span class="normal"><a href="#__codelineno-28-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="c1"># imports des couches</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceDao</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceDao</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceMétier</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceMétier</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceUi</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceUi</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="c1"># autres dépendances</span>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">MyException</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyException</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a><span class="k">class</span><span class="w"> </span><span class="nc">Console</span><span class="p">(</span><span class="n">InterfaceUi</span><span class="p">):</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a>    <span class="c1"># constructeur</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span> <span class="n">métier</span><span class="p">:</span> <span class="n">InterfaceMétier</span><span class="p">):</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a>        <span class="c1"># métier : la couche [métier]</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a>        <span class="c1"># on mémorise les attributs</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">métier</span> <span class="o">=</span> <span class="n">métier</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a>        <span class="c1"># -----------</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a>        <span class="c1"># interface</span>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a>        <span class="c1"># -----------</span>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-28-25" name="__codelineno-28-25"></a>        <span class="c1"># dialogue utilisateur</span>
<a id="__codelineno-28-26" name="__codelineno-28-26"></a>        <span class="n">fini</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-28-27" name="__codelineno-28-27"></a>        <span class="k">while</span> <span class="ow">not</span> <span class="n">fini</span><span class="p">:</span>
<a id="__codelineno-28-28" name="__codelineno-28-28"></a>            <span class="c1"># question / réponse</span>
<a id="__codelineno-28-29" name="__codelineno-28-29"></a>            <span class="n">réponse</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Numéro de l&#39;élève (&gt;=1 et * pour arrêter) : &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-28-30" name="__codelineno-28-30"></a>            <span class="c1"># fini ?</span>
<a id="__codelineno-28-31" name="__codelineno-28-31"></a>            <span class="k">if</span> <span class="n">réponse</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span><span class="p">:</span>
<a id="__codelineno-28-32" name="__codelineno-28-32"></a>                <span class="k">break</span>
<a id="__codelineno-28-33" name="__codelineno-28-33"></a>            <span class="c1"># a-t-on une saisie correcte ?</span>
<a id="__codelineno-28-34" name="__codelineno-28-34"></a>            <span class="n">ok</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-28-35" name="__codelineno-28-35"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-28-36" name="__codelineno-28-36"></a>                <span class="n">id_élève</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">réponse</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a id="__codelineno-28-37" name="__codelineno-28-37"></a>                <span class="n">ok</span> <span class="o">=</span> <span class="n">id_élève</span> <span class="o">&gt;=</span> <span class="mi">1</span>
<a id="__codelineno-28-38" name="__codelineno-28-38"></a>            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-28-39" name="__codelineno-28-39"></a>                <span class="k">pass</span>
<a id="__codelineno-28-40" name="__codelineno-28-40"></a>            <span class="c1"># donnée correcte ?</span>
<a id="__codelineno-28-41" name="__codelineno-28-41"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ok</span><span class="p">:</span>
<a id="__codelineno-28-42" name="__codelineno-28-42"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saisie incorrecte. Recommencez...&quot;</span><span class="p">)</span>
<a id="__codelineno-28-43" name="__codelineno-28-43"></a>                <span class="k">continue</span>
<a id="__codelineno-28-44" name="__codelineno-28-44"></a>            <span class="c1"># calcul des statistiques pour l&#39;élève choisi</span>
<a id="__codelineno-28-45" name="__codelineno-28-45"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-28-46" name="__codelineno-28-46"></a>                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">métier</span><span class="o">.</span><span class="n">get_stats_for_élève</span><span class="p">(</span><span class="n">id_élève</span><span class="p">))</span>
<a id="__codelineno-28-47" name="__codelineno-28-47"></a>            <span class="k">except</span> <span class="n">MyException</span> <span class="k">as</span> <span class="n">erreur</span><span class="p">:</span>
<a id="__codelineno-28-48" name="__codelineno-28-48"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L&#39;erreur suivante s&#39;est produite : </span><span class="si">{</span><span class="n">erreur</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 3-5 : import de toutes les interfaces ;</li>
<li>ligne 11 : la classe <strong>[Console]</strong> implémente l&#x27;interface <strong>[</strong><strong>InterfaceUi</strong><strong>]</strong> ;</li>
<li>lignes 12-17 : le constructeur de la classe <strong>[Console]</strong> reçoit en paramètre une référence sur la couche <strong>[métier]</strong>. On notera qu’on a donné le type <strong>[InterfaceMétier]</strong> à ce paramètre pour rappeler qu’on travaille avec des interfaces plutôt qu’avec des implémentations précises ;</li>
<li>ligne 24 : implémentation de la méthode <strong>[run]</strong> de l&#x27;interface ;</li>
<li>ligne 27 : une boucle qui s’arrête lorsque la condition de la ligne 31 est vérifiée ;</li>
<li>ligne 29 : saisie d’une donnée tapée au clavier. La fonction <strong>[input]</strong> reçoit un paramètre facultatif : le message à écrire sur l’écran pour demander la saisie. Celle-ci est toujours récupérée comme une chaîne de caractères. La fonction <strong>[strip]</strong> débarrasse celle-ci de ses « blancs » qui la suivent ou la précèdent ;</li>
<li>lignes 34-39 : on vérifie que la saisie, un n° d’élève, est valide. Il faut que ce soit un entier &gt;=1. On rappelle que la saisie a été faite en tant que chaîne de caractères ;</li>
<li>ligne 36 : on essaie de transformer la saisie en nombre entier en base 10. La fonction <strong>[int]</strong> lance une exception si ce n’est pas possible ;</li>
<li>ligne 37 : on arrive là seulement s’il n’y a pas eu d’exception. On vérifie que le nombre entier récupéré est bien &gt;=1 ;</li>
<li>lignes 38-39 : on gère l’exception. S’il y a eu exception, la variable <strong>[ok]</strong> de la ligne 34 est restée à <strong>[False]</strong> ;</li>
<li>lignes 41-43 : si la saisie a été incorrecte, on affiche un message d’erreur et on reboucle (ligne 43) ;</li>
<li>lignes 45-48 : on calcule les statistiques de l’élève dont on a saisi le n° ;</li>
<li>ligne 46 : on utilise la méthode <strong>[</strong><strong>get_stats_for_élève</strong><strong>]</strong> de la couche <strong>[métier]</strong>. Celle-ci lance une exception si l’élève n’existe pas. Celle-ci est gérée aux lignes 47-48. On sait que les couches <strong>[dao]</strong> et <strong>[métier]</strong> lancent l’exception <strong>[MyException]</strong> ;</li>
</ul>
<h2 id="143-le-script-principal-main">14.3. Le script principal [main]</h2>
<p>Le script principal <strong>[main]</strong> est le suivant (main.py) :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-29-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-29-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-29-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-29-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-29-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-29-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-29-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-29-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-29-10">10</a></span>
<span class="normal"><a href="#__codelineno-29-11">11</a></span>
<span class="normal"><a href="#__codelineno-29-12">12</a></span>
<span class="normal"><a href="#__codelineno-29-13">13</a></span>
<span class="normal"><a href="#__codelineno-29-14">14</a></span>
<span class="normal"><a href="#__codelineno-29-15">15</a></span>
<span class="normal"><a href="#__codelineno-29-16">16</a></span>
<span class="normal"><a href="#__codelineno-29-17">17</a></span>
<span class="normal"><a href="#__codelineno-29-18">18</a></span>
<span class="normal"><a href="#__codelineno-29-19">19</a></span>
<span class="normal"><a href="#__codelineno-29-20">20</a></span>
<span class="normal"><a href="#__codelineno-29-21">21</a></span>
<span class="normal"><a href="#__codelineno-29-22">22</a></span>
<span class="normal"><a href="#__codelineno-29-23">23</a></span>
<span class="normal"><a href="#__codelineno-29-24">24</a></span>
<span class="normal"><a href="#__codelineno-29-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="c1"># on configure l&#39;application</span>
<a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config</span>
<a id="__codelineno-29-3" name="__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>
<a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="c1"># le syspath est configuré - on peut faire les imports</span>
<a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Console</span><span class="w"> </span><span class="kn">import</span> <span class="n">Console</span>
<a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Dao</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dao</span>
<a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Métier</span><span class="w"> </span><span class="kn">import</span> <span class="n">Métier</span>
<a id="__codelineno-29-10" name="__codelineno-29-10"></a>
<a id="__codelineno-29-11" name="__codelineno-29-11"></a><span class="c1"># ----------- couche [console]</span>
<a id="__codelineno-29-12" name="__codelineno-29-12"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-29-13" name="__codelineno-29-13"></a>    <span class="c1"># instanciation couche [dao]</span>
<a id="__codelineno-29-14" name="__codelineno-29-14"></a>    <span class="n">dao</span> <span class="o">=</span> <span class="n">Dao</span><span class="p">()</span>
<a id="__codelineno-29-15" name="__codelineno-29-15"></a>    <span class="c1"># instanciation couche [métier]</span>
<a id="__codelineno-29-16" name="__codelineno-29-16"></a>    <span class="n">métier</span> <span class="o">=</span> <span class="n">Métier</span><span class="p">(</span><span class="n">dao</span><span class="p">)</span>
<a id="__codelineno-29-17" name="__codelineno-29-17"></a>    <span class="c1"># instanciation couche [ui]</span>
<a id="__codelineno-29-18" name="__codelineno-29-18"></a>    <span class="n">console</span> <span class="o">=</span> <span class="n">Console</span><span class="p">(</span><span class="n">métier</span><span class="p">)</span>
<a id="__codelineno-29-19" name="__codelineno-29-19"></a>    <span class="c1"># exécution couche [console]</span>
<a id="__codelineno-29-20" name="__codelineno-29-20"></a>    <span class="n">console</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<a id="__codelineno-29-21" name="__codelineno-29-21"></a><span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<a id="__codelineno-29-22" name="__codelineno-29-22"></a>    <span class="c1"># on affiche l&#39;erreur</span>
<a id="__codelineno-29-23" name="__codelineno-29-23"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;L&#39;erreur suivante s&#39;est produite : </span><span class="si">{</span><span class="n">ex</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-29-24" name="__codelineno-29-24"></a><span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-29-25" name="__codelineno-29-25"></a>    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 1-4 : on configure le Python Path de l’application ;</li>
<li>lignes 6-9 : on importe les classes et interfaces dont on a besoin ;</li>
<li>ligne 14 : instanciation de la couche <strong>[dao]</strong> ;</li>
<li>ligne 16 : instanciation de la couche <strong>[métier]</strong> ;</li>
<li>ligne 18 : instanciation de la couche <strong>[ui]</strong> ;</li>
<li>ligne 20 : on lance le dialogue avec l&#x27;utilisateur ;</li>
<li>lignes 13-20 : normalement aucune exception ne sort de ces lignes. Celles qui remontent des couches <strong>[dao]</strong> et <strong>[métier]</strong> sont arrêtées par la couche <strong>[Console]</strong>. La gestion des exceptions est un art difficile lorsqu’on ne connaît pas parfaitement les couches utilisées (ici ce n’est pas le cas). Dans le cas de doutes, on peut ajouter du code pour arrêter tout type d’exception pouvant être lancé par le code exécuté. C’est ce qui est fait ici, lignes 21-23. On arrête toute exception dérivant de <strong>[BaseException]</strong>, ç-à-d toutes les exceptions ;</li>
<li>lignes 24-25 : la clause <strong>[finally]</strong> ne fait rien ici. Elle n’est là que pour pouvoir mettre en commentaires les lignes 21-23. En effet, en mode débogage on n’a pas intérêt à arrêter les exceptions. Dans ce cas, c’est l’interpréteur Python qui les arrête et il donne alors le n° de la ligne où l’exception s’est produite. Une information indispensable. Lorsque les lignes 21-23 sont mises en commentaires, la présence des lignes 24-25 permet d’avoir un try/catch syntaxiquement correct. En leur absence, Python déclare une erreur ;
Voici un exemple d&#x27;exécution :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span>
<span class="normal"><a href="#__codelineno-30-7">7</a></span>
<span class="normal"><a href="#__codelineno-30-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v01</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="n">Numéro</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève (&gt;=1 et * pour arrêter) : 11</span>
<a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="n">Elève</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;nom1&quot;</span><span class="p">,</span> <span class="s2">&quot;prénom&quot;</span><span class="p">:</span> <span class="s2">&quot;prénom1&quot;</span><span class="p">,</span> <span class="s2">&quot;classe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nom&quot;</span><span class="p">:</span> <span class="s2">&quot;classe1&quot;</span><span class="p">}},</span> <span class="n">notes</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span> <span class="mi">6</span><span class="p">],</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">moyenne</span> <span class="n">pondérée</span><span class="o">=</span><span class="mf">7.33</span>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="n">Numéro</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève (&gt;=1 et * pour arrêter) : 1</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="n">L</span><span class="s1">&#39;erreur suivante s&#39;</span><span class="n">est</span> <span class="n">produite</span> <span class="p">:</span> <span class="n">MyException</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="n">L</span><span class="s1">&#39;élève d&#39;</span><span class="n">identifiant</span> <span class="mi">1</span> <span class="n">n</span><span class="s1">&#39;existe pas]</span>
<a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="n">Numéro</span> <span class="n">de</span> <span class="n">l</span><span class="s1">&#39;élève (&gt;=1 et * pour arrêter) : *</span>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<h2 id="144-exemple-2">14.4. Exemple 2</h2>
<p>Ce nouvel exemple d’architectures en couches vise à montrer l’intérêt de la programmation par interfaces. Celle-ci facilite la maintenance et le test des applications. Nous utiliserons de nouveau une architecture à trois couches :</p>
<p><img src="images/1000000000000500000002996716F67B.png" style="width:14.78cm;height:7.681cm;" alt="Image" /></p>
<p>Chaque couche sera implémentée de deux façons différentes. Nous voulons montrer que l’on peut changer facilement l’implémentation d’une couche avec un impact minimal sur les autres.</p>
<h3 id="1441-la-couche-dao">14.4.1. La couche [dao]</h3>
<p><img src="images/100000000000016C0000012C100849CE.png" style="width:3.791cm;height:3.121cm;" alt="Image" /></p>
<p>L’interface <strong>[InterfaceDao]</strong> est la suivante:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-31-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-31-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-31-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-31-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-31-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-31-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-31-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-31-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-31-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="c1"># imports</span>
<a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-31-3" name="__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="c1"># interface Dao</span>
<a id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">InterfaceDao</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-31-7" name="__codelineno-31-7"></a>    <span class="c1"># une seule méthode</span>
<a id="__codelineno-31-8" name="__codelineno-31-8"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-31-9" name="__codelineno-31-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_dao_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-31-10" name="__codelineno-31-10"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 8-10: la méthode <strong>[</strong><strong>do_something_in_dao_layer</strong><strong>]</strong> est l’unique méthode de l’interface ;
La classe <strong>[DaoImpl1]</strong> implémente l’interface <strong>[InterfaceDao]</strong> de la façon suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span>
<span class="normal"><a href="#__codelineno-32-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceDao</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceDao</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">DaoImpl1</span><span class="p">(</span><span class="n">InterfaceDao</span><span class="p">):</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a>    <span class="c1"># implémentation InterfaceDao</span>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_dao_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">InterfaceDao</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a>        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
<p>La classe <strong>[DaoImpl2]</strong> implémente l’interface <strong>[InterfaceDao]</strong> de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span>
<span class="normal"><a href="#__codelineno-33-4">4</a></span>
<span class="normal"><a href="#__codelineno-33-5">5</a></span>
<span class="normal"><a href="#__codelineno-33-6">6</a></span>
<span class="normal"><a href="#__codelineno-33-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceDao</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceDao</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">DaoImpl2</span><span class="p">(</span><span class="n">InterfaceDao</span><span class="p">):</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a>    <span class="c1"># implémentation InterfaceDao</span>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_dao_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">InterfaceDao</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a>        <span class="k">return</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
</code></pre></div></td></tr></table></div>
<h3 id="1442-la-couche-metier">14.4.2. La couche [métier]</h3>
<p><img src="images/100000000000018C00000155E597C5F3.png" style="width:4.571cm;height:3.931cm;" alt="Image" /></p>
<p>L’interface <strong>[InterfaceMétier]</strong> est la suivante:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="c1"># imports</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-34-3" name="__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="c1"># interface métier</span>
<a id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">InterfaceMétier</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-34-7" name="__codelineno-34-7"></a>    <span class="c1"># une seule méthode</span>
<a id="__codelineno-34-8" name="__codelineno-34-8"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-34-9" name="__codelineno-34-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_métier_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-34-10" name="__codelineno-34-10"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 8-10: la méthode <strong>[</strong><strong>do_something_in_métier_layer</strong><strong>]</strong> est l’unique méthode de l’interface ;
La classe <strong>[AbstractBaseMétier]</strong> implémente l’interface <strong>[InterfaceMétier]</strong> de la façon suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span>
<span class="normal"><a href="#__codelineno-35-15">15</a></span>
<span class="normal"><a href="#__codelineno-35-16">16</a></span>
<span class="normal"><a href="#__codelineno-35-17">17</a></span>
<span class="normal"><a href="#__codelineno-35-18">18</a></span>
<span class="normal"><a href="#__codelineno-35-19">19</a></span>
<span class="normal"><a href="#__codelineno-35-20">20</a></span>
<span class="normal"><a href="#__codelineno-35-21">21</a></span>
<span class="normal"><a href="#__codelineno-35-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="c1"># imports</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceDao</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceDao</span>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceMétier</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceMétier</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">AbstractBaseMétier</span><span class="p">(</span><span class="n">InterfaceMétier</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a>    <span class="c1"># propriétés</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a>    <span class="c1"># __dao est une référence sur la couche [dao]</span>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a>    <span class="nd">@property</span>
<a id="__codelineno-35-12" name="__codelineno-35-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dao</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InterfaceDao</span><span class="p">:</span>
<a id="__codelineno-35-13" name="__codelineno-35-13"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dao</span>
<a id="__codelineno-35-14" name="__codelineno-35-14"></a>
<a id="__codelineno-35-15" name="__codelineno-35-15"></a>    <span class="nd">@dao</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-35-16" name="__codelineno-35-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dao</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dao</span><span class="p">:</span> <span class="n">InterfaceDao</span><span class="p">):</span>
<a id="__codelineno-35-17" name="__codelineno-35-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dao</span> <span class="o">=</span> <span class="n">dao</span>
<a id="__codelineno-35-18" name="__codelineno-35-18"></a>
<a id="__codelineno-35-19" name="__codelineno-35-19"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceMétier]</span>
<a id="__codelineno-35-20" name="__codelineno-35-20"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-35-21" name="__codelineno-35-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_métier_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-35-22" name="__codelineno-35-22"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 8 : la classe <strong>[AbstractBaseMétier]</strong> dérive deux classes :</li>
<li><strong>[InterfaceMétier]</strong> : la classe <strong>[AbstractBaseMétier]</strong> implémente cette interface aux lignes 19-22. En fait on voit qu’elle n’a pas implémenté la méthode <strong>[</strong><strong>do_something_in_métier_layer</strong><strong>]</strong> qu’elle a déclarée abstraite (ligne 20). Ce sera aux classes dérivées d’implémenter la méthode;</li>
<li><strong>[ABC]</strong> pour avoir accès aux annotations <strong>[</strong><strong>@abstractmethod</strong><strong>]</strong> ;</li>
<li>
<p>l’ordre a un sens : si on l’inverse ici, Python déclare une erreur à l’exécution ;
C’est la première fois qu’on utilise l’héritage multiple (hériter de plusieurs classes). La classe <strong>[AbstractBaseMétier]</strong> hérite, à la fois, des propriétés des classes <strong>[InterfaceMétier]</strong> et <strong>[ABC]</strong>.</p>
</li>
<li>
<p>lignes 9-17 : on définit la propriété <strong>[dao]</strong> qui sera une référence sur la couche <strong>[dao]</strong> ;
Une interface est destinée à être implémentée. Lorsque des implémentations différentes partagent des propriétés il est intéressant de mettre celles-ci dans une classe parent afin d’éviter de les dupliquer. C’est le cas ici de la propriété <strong>[dao]</strong>. La classe parent est en général toujours abstraite parce qu’elle ne sait pas implémenter toutes les méthodes de l’interface.</p>
</li>
</ul>
<p>La classe <strong>[MétierImpl1]</strong> implémente l’interface <strong>[InterfaceMétier]</strong> de la façon suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span>
<span class="normal"><a href="#__codelineno-36-7">7</a></span>
<span class="normal"><a href="#__codelineno-36-8">8</a></span>
<span class="normal"><a href="#__codelineno-36-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">AbstractBaseMétier</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractBaseMétier</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">MétierImpl1</span><span class="p">(</span><span class="n">AbstractBaseMétier</span><span class="p">):</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceMétier]</span>
<a id="__codelineno-36-6" name="__codelineno-36-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_métier_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span><span class="n">AbstractBaseMétier</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-36-9" name="__codelineno-36-9"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dao</span><span class="o">.</span><span class="n">do_something_in_dao_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 4 : la classe <strong>[MétierImpl1]</strong> dérive de la classe <strong>[AbstractbaseMétier]</strong>. Elle hérite donc de la propriété <strong>[dao]</strong> de cette classe ;</li>
<li>lignes 6-9 : implémentation de l’interface <strong>[InterfaceMétier]</strong> que n’a pas implémentée la classe parent <strong>[AbstractbaseMétier]</strong> ;</li>
<li>ligne 9 : on utilise la couche <strong>[dao]</strong> ;
La classe <strong>[MétierImpl2]</strong> implémente l’interface <strong>[InterfaceMétier]</strong> de façon analogue :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span>
<span class="normal"><a href="#__codelineno-37-6">6</a></span>
<span class="normal"><a href="#__codelineno-37-7">7</a></span>
<span class="normal"><a href="#__codelineno-37-8">8</a></span>
<span class="normal"><a href="#__codelineno-37-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">AbstractBaseMétier</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractBaseMétier</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">MétierImpl2</span><span class="p">(</span><span class="n">AbstractBaseMétier</span><span class="p">):</span>
<a id="__codelineno-37-5" name="__codelineno-37-5"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceMétier]</span>
<a id="__codelineno-37-6" name="__codelineno-37-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_métier_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span><span class="n">AbstractBaseMétier</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-37-7" name="__codelineno-37-7"></a>        <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-37-8" name="__codelineno-37-8"></a>        <span class="n">y</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-37-9" name="__codelineno-37-9"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dao</span><span class="o">.</span><span class="n">do_something_in_dao_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<h3 id="1443-la-couche-ui">14.4.3. La couche [ui]</h3>
<p><img src="images/100000000000017C0000019674470E37.png" style="width:4.4cm;height:4.68cm;" alt="Image" /></p>
<p>L’interface <strong>[InterfaceUi]</strong> est la suivante :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-38-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-38-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-38-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-38-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-38-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-38-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-38-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-38-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-38-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="c1"># imports</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5"></a><span class="c1"># interface Ui</span>
<a id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">InterfaceUi</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a>    <span class="c1"># une seule méthode</span>
<a id="__codelineno-38-8" name="__codelineno-38-8"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-38-9" name="__codelineno-38-9"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_ui_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-38-10" name="__codelineno-38-10"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 8-10 : l’unique méthode de l’interface ;
La classe <strong>[AbstractBaseUi]</strong> implémente l’interface <strong>[InterfaceUi]</strong> de la façon suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-39-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-39-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-39-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-39-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-39-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-39-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-39-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-39-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-39-10">10</a></span>
<span class="normal"><a href="#__codelineno-39-11">11</a></span>
<span class="normal"><a href="#__codelineno-39-12">12</a></span>
<span class="normal"><a href="#__codelineno-39-13">13</a></span>
<span class="normal"><a href="#__codelineno-39-14">14</a></span>
<span class="normal"><a href="#__codelineno-39-15">15</a></span>
<span class="normal"><a href="#__codelineno-39-16">16</a></span>
<span class="normal"><a href="#__codelineno-39-17">17</a></span>
<span class="normal"><a href="#__codelineno-39-18">18</a></span>
<span class="normal"><a href="#__codelineno-39-19">19</a></span>
<span class="normal"><a href="#__codelineno-39-20">20</a></span>
<span class="normal"><a href="#__codelineno-39-21">21</a></span>
<span class="normal"><a href="#__codelineno-39-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="c1"># imports</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a>
<a id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceMétier</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceMétier</span>
<a id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">InterfaceUi</span><span class="w"> </span><span class="kn">import</span> <span class="n">InterfaceUi</span>
<a id="__codelineno-39-6" name="__codelineno-39-6"></a>
<a id="__codelineno-39-7" name="__codelineno-39-7"></a>
<a id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">AbstractBaseUi</span><span class="p">(</span><span class="n">InterfaceUi</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<a id="__codelineno-39-9" name="__codelineno-39-9"></a>    <span class="c1"># propriétés</span>
<a id="__codelineno-39-10" name="__codelineno-39-10"></a>    <span class="c1"># métier est une référence sur la couche [métier]</span>
<a id="__codelineno-39-11" name="__codelineno-39-11"></a>    <span class="nd">@property</span>
<a id="__codelineno-39-12" name="__codelineno-39-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">métier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InterfaceMétier</span><span class="p">:</span>
<a id="__codelineno-39-13" name="__codelineno-39-13"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__métier</span>
<a id="__codelineno-39-14" name="__codelineno-39-14"></a>
<a id="__codelineno-39-15" name="__codelineno-39-15"></a>    <span class="nd">@métier</span><span class="o">.</span><span class="n">setter</span>
<a id="__codelineno-39-16" name="__codelineno-39-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">métier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">métier</span><span class="p">:</span> <span class="n">InterfaceMétier</span><span class="p">):</span>
<a id="__codelineno-39-17" name="__codelineno-39-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__métier</span> <span class="o">=</span> <span class="n">métier</span>
<a id="__codelineno-39-18" name="__codelineno-39-18"></a>
<a id="__codelineno-39-19" name="__codelineno-39-19"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceUI]</span>
<a id="__codelineno-39-20" name="__codelineno-39-20"></a>    <span class="nd">@abstractmethod</span>
<a id="__codelineno-39-21" name="__codelineno-39-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_ui_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">InterfaceUi</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-39-22" name="__codelineno-39-22"></a>        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>la classe <strong>[AbstractBaseUi]</strong> est une classe abstraite (ligne 20). Elle devra être dérivée pour implémenter l’interface <strong>[InterfaceUi]</strong> ;</li>
<li>lignes 9-17 : la classe <strong>[AbstractBaseUi]</strong> possède une référence sur la couche <strong>[métier]</strong> ;
La classe d’implémentation <strong>[UiImpl1]</strong> est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span>
<span class="normal"><a href="#__codelineno-40-5">5</a></span>
<span class="normal"><a href="#__codelineno-40-6">6</a></span>
<span class="normal"><a href="#__codelineno-40-7">7</a></span>
<span class="normal"><a href="#__codelineno-40-8">8</a></span>
<span class="normal"><a href="#__codelineno-40-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">AbstractBaseUi</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractBaseUi</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3"></a>
<a id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">UiImpl1</span><span class="p">(</span><span class="n">AbstractBaseUi</span><span class="p">):</span>
<a id="__codelineno-40-5" name="__codelineno-40-5"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceUi]</span>
<a id="__codelineno-40-6" name="__codelineno-40-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_ui_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">AbstractBaseUi</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-40-7" name="__codelineno-40-7"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-40-8" name="__codelineno-40-8"></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-40-9" name="__codelineno-40-9"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">métier</span><span class="o">.</span><span class="n">do_something_in_métier_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 4 : la classe <strong>[UiImpl1]</strong> dérive de la classe <strong>[AbstractBaseUi]</strong> et hérite donc de sa propriété <strong>[métier]</strong>. Celle-ci est utilisée ligne 9 ;
La classe d’implémentation <strong>[UiImpl2]</strong> est analogue :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span>
<span class="normal"><a href="#__codelineno-41-4">4</a></span>
<span class="normal"><a href="#__codelineno-41-5">5</a></span>
<span class="normal"><a href="#__codelineno-41-6">6</a></span>
<span class="normal"><a href="#__codelineno-41-7">7</a></span>
<span class="normal"><a href="#__codelineno-41-8">8</a></span>
<span class="normal"><a href="#__codelineno-41-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">AbstractBaseUi</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractBaseUi</span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a>
<a id="__codelineno-41-3" name="__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">UiImpl2</span><span class="p">(</span><span class="n">AbstractBaseUi</span><span class="p">):</span>
<a id="__codelineno-41-5" name="__codelineno-41-5"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceUi]</span>
<a id="__codelineno-41-6" name="__codelineno-41-6"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_ui_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">AbstractBaseUi</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-41-7" name="__codelineno-41-7"></a>        <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-41-8" name="__codelineno-41-8"></a>        <span class="n">y</span> <span class="o">-=</span> <span class="mi">1</span>
<a id="__codelineno-41-9" name="__codelineno-41-9"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">métier</span><span class="o">.</span><span class="n">do_something_in_métier_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 4 : la classe <strong>[UiImpl2]</strong> dérive de la classe <strong>[AbstractBaseUi]</strong> et hérite donc de sa propriété <strong>[métier]</strong>. Celle-ci est utilisée ligne 9 ;</li>
</ul>
<h3 id="1444-les-fichiers-de-configuration">14.4.4. Les fichiers de configuration</h3>
<p><img src="images/100000000000015500000175811D8558.png" style="width:3.931cm;height:4.301cm;" alt="Image" /></p>
<ul>
<li>les fichiers <strong>[config1, config2]</strong> configurent l’application de deux façons différentes ;</li>
<li>le fichier <strong>[main]</strong> est le script principal de l’application ;
Le fichier <strong>[config1]</strong> est le suivant :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-42-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-42-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-42-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-42-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-42-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-42-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-42-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-42-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-42-10">10</a></span>
<span class="normal"><a href="#__codelineno-42-11">11</a></span>
<span class="normal"><a href="#__codelineno-42-12">12</a></span>
<span class="normal"><a href="#__codelineno-42-13">13</a></span>
<span class="normal"><a href="#__codelineno-42-14">14</a></span>
<span class="normal"><a href="#__codelineno-42-15">15</a></span>
<span class="normal"><a href="#__codelineno-42-16">16</a></span>
<span class="normal"><a href="#__codelineno-42-17">17</a></span>
<span class="normal"><a href="#__codelineno-42-18">18</a></span>
<span class="normal"><a href="#__codelineno-42-19">19</a></span>
<span class="normal"><a href="#__codelineno-42-20">20</a></span>
<span class="normal"><a href="#__codelineno-42-21">21</a></span>
<span class="normal"><a href="#__codelineno-42-22">22</a></span>
<span class="normal"><a href="#__codelineno-42-23">23</a></span>
<span class="normal"><a href="#__codelineno-42-24">24</a></span>
<span class="normal"><a href="#__codelineno-42-25">25</a></span>
<span class="normal"><a href="#__codelineno-42-26">26</a></span>
<span class="normal"><a href="#__codelineno-42-27">27</a></span>
<span class="normal"><a href="#__codelineno-42-28">28</a></span>
<span class="normal"><a href="#__codelineno-42-29">29</a></span>
<span class="normal"><a href="#__codelineno-42-30">30</a></span>
<span class="normal"><a href="#__codelineno-42-31">31</a></span>
<span class="normal"><a href="#__codelineno-42-32">32</a></span>
<span class="normal"><a href="#__codelineno-42-33">33</a></span>
<span class="normal"><a href="#__codelineno-42-34">34</a></span>
<span class="normal"><a href="#__codelineno-42-35">35</a></span>
<span class="normal"><a href="#__codelineno-42-36">36</a></span>
<span class="normal"><a href="#__codelineno-42-37">37</a></span>
<span class="normal"><a href="#__codelineno-42-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">():</span>
<a id="__codelineno-42-2" name="__codelineno-42-2"></a>    <span class="c1"># étape 1 ------</span>
<a id="__codelineno-42-3" name="__codelineno-42-3"></a>    <span class="c1"># chemin absolu du dossier de ce script</span>
<a id="__codelineno-42-4" name="__codelineno-42-4"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-42-5" name="__codelineno-42-5"></a>    <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<a id="__codelineno-42-6" name="__codelineno-42-6"></a>    <span class="c1"># dépendances</span>
<a id="__codelineno-42-7" name="__codelineno-42-7"></a>    <span class="n">absolute_dependencies</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-42-8" name="__codelineno-42-8"></a>        <span class="c1"># dossiers locaux du Python Path</span>
<a id="__codelineno-42-9" name="__codelineno-42-9"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../dao&quot;</span><span class="p">,</span>
<a id="__codelineno-42-10" name="__codelineno-42-10"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../ui&quot;</span><span class="p">,</span>
<a id="__codelineno-42-11" name="__codelineno-42-11"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../métier&quot;</span><span class="p">,</span>
<a id="__codelineno-42-12" name="__codelineno-42-12"></a>    <span class="p">]</span>
<a id="__codelineno-42-13" name="__codelineno-42-13"></a>
<a id="__codelineno-42-14" name="__codelineno-42-14"></a>    <span class="c1"># on configure le syspath</span>
<a id="__codelineno-42-15" name="__codelineno-42-15"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">myutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_syspath</span>
<a id="__codelineno-42-16" name="__codelineno-42-16"></a>    <span class="n">set_syspath</span><span class="p">(</span><span class="n">absolute_dependencies</span><span class="p">)</span>
<a id="__codelineno-42-17" name="__codelineno-42-17"></a>
<a id="__codelineno-42-18" name="__codelineno-42-18"></a>    <span class="c1"># étape 2 ------</span>
<a id="__codelineno-42-19" name="__codelineno-42-19"></a>    <span class="c1"># configuration des couches de l&#39;application</span>
<a id="__codelineno-42-20" name="__codelineno-42-20"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">DaoImpl1</span><span class="w"> </span><span class="kn">import</span> <span class="n">DaoImpl1</span>
<a id="__codelineno-42-21" name="__codelineno-42-21"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">MétierImpl1</span><span class="w"> </span><span class="kn">import</span> <span class="n">MétierImpl1</span>
<a id="__codelineno-42-22" name="__codelineno-42-22"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">UiImpl1</span><span class="w"> </span><span class="kn">import</span> <span class="n">UiImpl1</span>
<a id="__codelineno-42-23" name="__codelineno-42-23"></a>    <span class="c1"># instanciation des couches</span>
<a id="__codelineno-42-24" name="__codelineno-42-24"></a>    <span class="c1"># dao</span>
<a id="__codelineno-42-25" name="__codelineno-42-25"></a>    <span class="n">dao</span> <span class="o">=</span> <span class="n">DaoImpl1</span><span class="p">()</span>
<a id="__codelineno-42-26" name="__codelineno-42-26"></a>    <span class="c1"># métier</span>
<a id="__codelineno-42-27" name="__codelineno-42-27"></a>    <span class="n">métier</span> <span class="o">=</span> <span class="n">MétierImpl1</span><span class="p">()</span>
<a id="__codelineno-42-28" name="__codelineno-42-28"></a>    <span class="n">métier</span><span class="o">.</span><span class="n">dao</span> <span class="o">=</span> <span class="n">dao</span>
<a id="__codelineno-42-29" name="__codelineno-42-29"></a>    <span class="c1"># ui</span>
<a id="__codelineno-42-30" name="__codelineno-42-30"></a>    <span class="n">ui</span> <span class="o">=</span> <span class="n">UiImpl1</span><span class="p">()</span>
<a id="__codelineno-42-31" name="__codelineno-42-31"></a>    <span class="n">ui</span><span class="o">.</span><span class="n">métier</span> <span class="o">=</span> <span class="n">métier</span>
<a id="__codelineno-42-32" name="__codelineno-42-32"></a>
<a id="__codelineno-42-33" name="__codelineno-42-33"></a>    <span class="c1"># on met les instances de couche dans la config</span>
<a id="__codelineno-42-34" name="__codelineno-42-34"></a>    <span class="c1"># seule la couche ui est ici nécessaire</span>
<a id="__codelineno-42-35" name="__codelineno-42-35"></a>    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ui&quot;</span><span class="p">:</span> <span class="n">ui</span><span class="p">}</span>
<a id="__codelineno-42-36" name="__codelineno-42-36"></a>
<a id="__codelineno-42-37" name="__codelineno-42-37"></a>    <span class="c1"># on rend la config</span>
<a id="__codelineno-42-38" name="__codelineno-42-38"></a>    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>lignes 2-16 : configuration du Python Path de l’application ;</li>
<li>lignes 18-31 : instanciation des couches <strong>[dao, métier, ui]</strong>. Pour implémenter leurs interfaces, on choisit à chaque fois la 1ère implémentation construite ;</li>
<li>lignes 33-35 : on met les références de couches dans la configuration. Ici, le script principal n’a besoin que de la couche <strong>[ui]</strong> ;
Le fichier <strong>[config2]</strong> est analogue et implémente chaque interface avec la 2ième implémentation disponible :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-43-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-43-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-43-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-43-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-43-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-43-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-43-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-43-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-43-10">10</a></span>
<span class="normal"><a href="#__codelineno-43-11">11</a></span>
<span class="normal"><a href="#__codelineno-43-12">12</a></span>
<span class="normal"><a href="#__codelineno-43-13">13</a></span>
<span class="normal"><a href="#__codelineno-43-14">14</a></span>
<span class="normal"><a href="#__codelineno-43-15">15</a></span>
<span class="normal"><a href="#__codelineno-43-16">16</a></span>
<span class="normal"><a href="#__codelineno-43-17">17</a></span>
<span class="normal"><a href="#__codelineno-43-18">18</a></span>
<span class="normal"><a href="#__codelineno-43-19">19</a></span>
<span class="normal"><a href="#__codelineno-43-20">20</a></span>
<span class="normal"><a href="#__codelineno-43-21">21</a></span>
<span class="normal"><a href="#__codelineno-43-22">22</a></span>
<span class="normal"><a href="#__codelineno-43-23">23</a></span>
<span class="normal"><a href="#__codelineno-43-24">24</a></span>
<span class="normal"><a href="#__codelineno-43-25">25</a></span>
<span class="normal"><a href="#__codelineno-43-26">26</a></span>
<span class="normal"><a href="#__codelineno-43-27">27</a></span>
<span class="normal"><a href="#__codelineno-43-28">28</a></span>
<span class="normal"><a href="#__codelineno-43-29">29</a></span>
<span class="normal"><a href="#__codelineno-43-30">30</a></span>
<span class="normal"><a href="#__codelineno-43-31">31</a></span>
<span class="normal"><a href="#__codelineno-43-32">32</a></span>
<span class="normal"><a href="#__codelineno-43-33">33</a></span>
<span class="normal"><a href="#__codelineno-43-34">34</a></span>
<span class="normal"><a href="#__codelineno-43-35">35</a></span>
<span class="normal"><a href="#__codelineno-43-36">36</a></span>
<span class="normal"><a href="#__codelineno-43-37">37</a></span>
<span class="normal"><a href="#__codelineno-43-38">38</a></span>
<span class="normal"><a href="#__codelineno-43-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">configure</span><span class="p">():</span>
<a id="__codelineno-43-2" name="__codelineno-43-2"></a>    <span class="c1"># étape 1 ---</span>
<a id="__codelineno-43-3" name="__codelineno-43-3"></a>    <span class="c1"># chemin absolu du dossier de ce script</span>
<a id="__codelineno-43-4" name="__codelineno-43-4"></a>    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-43-5" name="__codelineno-43-5"></a>    <span class="n">script_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<a id="__codelineno-43-6" name="__codelineno-43-6"></a>    <span class="c1"># dépendances</span>
<a id="__codelineno-43-7" name="__codelineno-43-7"></a>    <span class="n">absolute_dependencies</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-43-8" name="__codelineno-43-8"></a>        <span class="c1"># dossiers locaux du Python Path</span>
<a id="__codelineno-43-9" name="__codelineno-43-9"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../dao&quot;</span><span class="p">,</span>
<a id="__codelineno-43-10" name="__codelineno-43-10"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../ui&quot;</span><span class="p">,</span>
<a id="__codelineno-43-11" name="__codelineno-43-11"></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_dir</span><span class="si">}</span><span class="s2">/../métier&quot;</span><span class="p">,</span>
<a id="__codelineno-43-12" name="__codelineno-43-12"></a>    <span class="p">]</span>
<a id="__codelineno-43-13" name="__codelineno-43-13"></a>
<a id="__codelineno-43-14" name="__codelineno-43-14"></a>    <span class="c1"># on configure le syspath</span>
<a id="__codelineno-43-15" name="__codelineno-43-15"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">myutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">set_syspath</span>
<a id="__codelineno-43-16" name="__codelineno-43-16"></a>
<a id="__codelineno-43-17" name="__codelineno-43-17"></a>    <span class="n">set_syspath</span><span class="p">(</span><span class="n">absolute_dependencies</span><span class="p">)</span>
<a id="__codelineno-43-18" name="__codelineno-43-18"></a>
<a id="__codelineno-43-19" name="__codelineno-43-19"></a>    <span class="c1"># étape 2 ------</span>
<a id="__codelineno-43-20" name="__codelineno-43-20"></a>    <span class="c1"># configuration des couches de l&#39;application</span>
<a id="__codelineno-43-21" name="__codelineno-43-21"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">DaoImpl2</span><span class="w"> </span><span class="kn">import</span> <span class="n">DaoImpl2</span>
<a id="__codelineno-43-22" name="__codelineno-43-22"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">MétierImpl2</span><span class="w"> </span><span class="kn">import</span> <span class="n">MétierImpl2</span>
<a id="__codelineno-43-23" name="__codelineno-43-23"></a>    <span class="kn">from</span><span class="w"> </span><span class="nn">UiImpl2</span><span class="w"> </span><span class="kn">import</span> <span class="n">UiImpl2</span>
<a id="__codelineno-43-24" name="__codelineno-43-24"></a>    <span class="c1"># instanciation des couches</span>
<a id="__codelineno-43-25" name="__codelineno-43-25"></a>    <span class="c1"># dao</span>
<a id="__codelineno-43-26" name="__codelineno-43-26"></a>    <span class="n">dao</span> <span class="o">=</span> <span class="n">DaoImpl2</span><span class="p">()</span>
<a id="__codelineno-43-27" name="__codelineno-43-27"></a>    <span class="c1"># métier</span>
<a id="__codelineno-43-28" name="__codelineno-43-28"></a>    <span class="n">métier</span> <span class="o">=</span> <span class="n">MétierImpl2</span><span class="p">()</span>
<a id="__codelineno-43-29" name="__codelineno-43-29"></a>    <span class="n">métier</span><span class="o">.</span><span class="n">dao</span> <span class="o">=</span> <span class="n">dao</span>
<a id="__codelineno-43-30" name="__codelineno-43-30"></a>    <span class="c1"># ui</span>
<a id="__codelineno-43-31" name="__codelineno-43-31"></a>    <span class="n">ui</span> <span class="o">=</span> <span class="n">UiImpl2</span><span class="p">()</span>
<a id="__codelineno-43-32" name="__codelineno-43-32"></a>    <span class="n">ui</span><span class="o">.</span><span class="n">métier</span> <span class="o">=</span> <span class="n">métier</span>
<a id="__codelineno-43-33" name="__codelineno-43-33"></a>
<a id="__codelineno-43-34" name="__codelineno-43-34"></a>    <span class="c1"># on met les instances de couche dans la config</span>
<a id="__codelineno-43-35" name="__codelineno-43-35"></a>    <span class="c1"># seule la couche ui est ici nécessaire</span>
<a id="__codelineno-43-36" name="__codelineno-43-36"></a>    <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ui&quot;</span><span class="p">:</span> <span class="n">ui</span><span class="p">}</span>
<a id="__codelineno-43-37" name="__codelineno-43-37"></a>
<a id="__codelineno-43-38" name="__codelineno-43-38"></a>    <span class="c1"># on rend la config</span>
<a id="__codelineno-43-39" name="__codelineno-43-39"></a>    <span class="k">return</span> <span class="n">config</span>
</code></pre></div></td></tr></table></div>
<h3 id="1445-le-script-principal-main">14.4.5. Le script principal [main]</h3>
<p><img src="images/100000000000015500000175811D8558.png" style="width:3.541cm;height:3.871cm;" alt="Image" /></p>
<p>Le script principal est le suivant :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-44-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-44-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-44-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-44-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-44-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-44-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-44-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-44-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-44-10">10</a></span>
<span class="normal"><a href="#__codelineno-44-11">11</a></span>
<span class="normal"><a href="#__codelineno-44-12">12</a></span>
<span class="normal"><a href="#__codelineno-44-13">13</a></span>
<span class="normal"><a href="#__codelineno-44-14">14</a></span>
<span class="normal"><a href="#__codelineno-44-15">15</a></span>
<span class="normal"><a href="#__codelineno-44-16">16</a></span>
<span class="normal"><a href="#__codelineno-44-17">17</a></span>
<span class="normal"><a href="#__codelineno-44-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="c1"># imports</span>
<a id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">importlib</span>
<a id="__codelineno-44-3" name="__codelineno-44-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<a id="__codelineno-44-4" name="__codelineno-44-4"></a>
<a id="__codelineno-44-5" name="__codelineno-44-5"></a><span class="c1"># main ---------</span>
<a id="__codelineno-44-6" name="__codelineno-44-6"></a>
<a id="__codelineno-44-7" name="__codelineno-44-7"></a><span class="c1"># il faut deux arguments</span>
<a id="__codelineno-44-8" name="__codelineno-44-8"></a><span class="n">nb_args</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
<a id="__codelineno-44-9" name="__codelineno-44-9"></a><span class="k">if</span> <span class="n">nb_args</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;config1&quot;</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;config2&quot;</span><span class="p">):</span>
<a id="__codelineno-44-10" name="__codelineno-44-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Syntaxe : </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> config1 ou config2&quot;</span><span class="p">)</span>
<a id="__codelineno-44-11" name="__codelineno-44-11"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<a id="__codelineno-44-12" name="__codelineno-44-12"></a>
<a id="__codelineno-44-13" name="__codelineno-44-13"></a><span class="c1"># configuration de l&#39;application</span>
<a id="__codelineno-44-14" name="__codelineno-44-14"></a><span class="n">module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-44-15" name="__codelineno-44-15"></a><span class="n">config</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<a id="__codelineno-44-16" name="__codelineno-44-16"></a>
<a id="__codelineno-44-17" name="__codelineno-44-17"></a><span class="c1"># exécution de la couche [ui]</span>
<a id="__codelineno-44-18" name="__codelineno-44-18"></a><span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;ui&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">do_something_in_ui_layer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<p>Ce script reçoit un paramètre :</p>
<ul>
<li><strong>[config1]</strong> pour utiliser la configuration n° 1 ;</li>
<li>
<p><strong>[config2]</strong> pour utiliser la configuration n° 2 ;
Python enregistre les paramètres dans une liste <strong>[sys.argv]</strong> :</p>
</li>
<li>
<p>sys.argv<strong>[0]</strong> est le nom du script, ici <strong>[main]</strong>. Ce paramètre est toujours présent ;</p>
</li>
<li>sys.argv<strong>[1]</strong> est le 1er paramètre passé au script, sys.argv<strong>[2]</strong> le 2ième, …</li>
<li>ligne 8 : on récupère le nombre de paramètres ;</li>
<li>lignes 9-11 : on vérifie qu’il y a bien un paramètre et que sa valeur est soit <strong>[config1]</strong>, soit <strong>[config2]</strong>. Si ce n’est pas le cas, un message d’erreur est affiché (ligne 10) et on quitte le programme (ligne 11) ;
Une fois connue la configuration souhaitée, il nous faut exécuter cette configuration. Par exemple, si c’est la configuration 1 qui a été choisie, il nous faut exécuter le code :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">config1</span>
<a id="__codelineno-45-2" name="__codelineno-45-2"></a><span class="n">config1</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<p>Le problème ici est que la configuration à utiliser est dans une variable, la variable <strong>[sys.argv[1]</strong>. Pour importer un module dont le nom est dans une variable, il nous faut utiliser le package<strong>[importlib]</strong> (ligne 2).</p>
<ul>
<li>ligne 14 : on importe le module dont le nom est dans <strong>[sys.argv[1]</strong> ;</li>
<li>ligne 15 : ceci fait, on exécute la fonction <strong>[configure]</strong> de ce module. On récupère un dictionnaire <strong>[config]</strong> qui est la configuration de l’application ;</li>
<li>ligne 18 : on sait qu’une référence de la couche <strong>[ui]</strong> est dans config<strong>[‘ui’]</strong>. On l’utilise pour appeler la méthode <strong>[</strong><strong>do_something_in_ui_layer</strong><strong>]</strong>. On sait que cette méthode va appeler une méthode de la couche <strong>[métier]</strong> qui elle-même va appeler une méthode de la couche <strong>[dao]</strong> ;
Par exemple, la fonction <strong>[</strong><strong>do_something_in_ui_layer</strong><strong>]</strong> est la suivante :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span>
<span class="normal"><a href="#__codelineno-46-2">2</a></span>
<span class="normal"><a href="#__codelineno-46-3">3</a></span>
<span class="normal"><a href="#__codelineno-46-4">4</a></span>
<span class="normal"><a href="#__codelineno-46-5">5</a></span>
<span class="normal"><a href="#__codelineno-46-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">UiImpl1</span><span class="p">(</span><span class="n">AbstractBaseUi</span><span class="p">):</span>
<a id="__codelineno-46-2" name="__codelineno-46-2"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceUi]</span>
<a id="__codelineno-46-3" name="__codelineno-46-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_ui_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">AbstractBaseUi</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-46-4" name="__codelineno-46-4"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-46-5" name="__codelineno-46-5"></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-46-6" name="__codelineno-46-6"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">métier</span><span class="o">.</span><span class="n">do_something_in_métier_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>
<p>ligne 6 ci-dessus utilise la propriété <strong>[métier]</strong> de la classe <strong>[UiImpl1]</strong>, ligne 1. Or dans la configuration <strong>[config1]</strong> il a été écrit :
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span>
<span class="normal"><a href="#__codelineno-47-2">2</a></span>
<span class="normal"><a href="#__codelineno-47-3">3</a></span>
<span class="normal"><a href="#__codelineno-47-4">4</a></span>
<span class="normal"><a href="#__codelineno-47-5">5</a></span>
<span class="normal"><a href="#__codelineno-47-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><span class="c1"># métier</span>
<a id="__codelineno-47-2" name="__codelineno-47-2"></a>    <span class="n">métier</span> <span class="o">=</span> <span class="n">MétierImpl1</span><span class="p">()</span>
<a id="__codelineno-47-3" name="__codelineno-47-3"></a>    <span class="n">métier</span><span class="o">.</span><span class="n">dao</span> <span class="o">=</span> <span class="n">dao</span>
<a id="__codelineno-47-4" name="__codelineno-47-4"></a>    <span class="c1"># ui</span>
<a id="__codelineno-47-5" name="__codelineno-47-5"></a>    <span class="n">ui</span> <span class="o">=</span> <span class="n">UiImpl1</span><span class="p">()</span>
<a id="__codelineno-47-6" name="__codelineno-47-6"></a>    <span class="n">ui</span><span class="o">.</span><span class="n">métier</span> <span class="o">=</span> <span class="n">métier</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>ligne 6 : la propriété <strong>[métier]</strong> de <strong>[UIImpl1]</strong> est une référence à la classe <strong>[MétierImpl1]</strong> (ligne 2). Ainsi c’est la méthode <strong>[do_something_in_ui_layer]</strong> de la classe <strong>[MétierImpl1]</strong> qui va être exécutée ;
Dans la classe <strong>[MétierUiImpl1]</strong>, il est écrit :</p>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span>
<span class="normal"><a href="#__codelineno-48-4">4</a></span>
<span class="normal"><a href="#__codelineno-48-5">5</a></span>
<span class="normal"><a href="#__codelineno-48-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MétierImpl1</span><span class="p">(</span><span class="n">AbstractBaseMétier</span><span class="p">):</span>
<a id="__codelineno-48-2" name="__codelineno-48-2"></a>    <span class="c1"># implémentation de l&#39;interface [InterfaceMétier]</span>
<a id="__codelineno-48-3" name="__codelineno-48-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">do_something_in_métier_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">AbstractBaseMétier</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-48-4" name="__codelineno-48-4"></a>        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-48-5" name="__codelineno-48-5"></a>        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-48-6" name="__codelineno-48-6"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dao</span><span class="o">.</span><span class="n">do_something_in_dao_layer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 6, la méthode appelée par la couche <strong>[ui]</strong> va à son tour appelée une méthode de la propriété <strong>[dao]</strong> de la classe <strong>[MétierImpl1]</strong> ;
Or dans la configuration <strong>[config1]</strong>, il a été écrit :</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span>
<span class="normal"><a href="#__codelineno-49-3">3</a></span>
<span class="normal"><a href="#__codelineno-49-4">4</a></span>
<span class="normal"><a href="#__codelineno-49-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="c1"># dao</span>
<a id="__codelineno-49-2" name="__codelineno-49-2"></a>    <span class="n">dao</span> <span class="o">=</span> <span class="n">DaoImpl1</span><span class="p">()</span>
<a id="__codelineno-49-3" name="__codelineno-49-3"></a>    <span class="c1"># métier</span>
<a id="__codelineno-49-4" name="__codelineno-49-4"></a>    <span class="n">métier</span> <span class="o">=</span> <span class="n">MétierImpl1</span><span class="p">()</span>
<a id="__codelineno-49-5" name="__codelineno-49-5"></a>    <span class="n">métier</span><span class="o">.</span><span class="n">dao</span> <span class="o">=</span> <span class="n">dao</span>
</code></pre></div></td></tr></table></div>
<ul>
<li>ligne 5 : la propriété <strong>[MétierImpl1.dao]</strong> est de type <strong>[DaoImpl1]</strong> (ligne 2) ;
Ce qu’on veut montrer ici, c’est que le script <strong>[main]</strong> n’a pas à se préoccuper des couches <strong>[métier]</strong> et <strong>[dao]</strong>. Il n’a à se préoccuper que de la couche <strong>[ui]</strong>, les liens entre cette couche et les autres ayant été faits par configuration.</li>
</ul>
<p><img src="images/1000000000000470000000BB574DD97C.png" style="width:13.14cm;height:2.162cm;" alt="Image" /></p>
<p>Pour passer le paramètre <strong>[config1]</strong> ou <strong>[config2]</strong> au script <strong>[main]</strong>, on procèdera de la façon suivante :</p>
<p><img src="images/100000000000054B0000041FD56C07BD.png" style="width:15.65cm;height:12.172cm;" alt="Image" /></p>
<ul>
<li>en <strong>[1-2]</strong>, on crée ce qu’on appelle une configuration d’exécution ;</li>
<li>en <strong>[3]</strong>, on donne un nom à cette configuration pour pouvoir la retrouver ;</li>
<li>en <strong>[4]</strong>, on sélectionne le script à exécuter. Si on a suivi la procédure <strong>[1-2]</strong>, le bon script a déjà été sélectionné ;</li>
<li>en <strong>[5]</strong>, on met ici les paramètres à transmettre au script. On passe ici la chaîne <strong>[config1]</strong> pour demander au script d’utiliser la configuration n° 1 ;</li>
<li>en <strong>[6]</strong>, on valide la configuration d’exécution ;</li>
</ul>
<p><img src="images/10000000000005700000019B53F48C66.png" style="width:16.091cm;height:4.74cm;" alt="Image" /></p>
<ul>
<li>en <strong>[1-2]</strong>, on demande à voir les contextes d’exécution existants ;</li>
<li>en <strong>[3]</strong>, on sélectionne le contexte d’exécution existant et on le duplique <strong>[4]</strong> ;</li>
</ul>
<p><img src="images/1000000100000427000000D6C304DEAC.png" style="width:17.971cm;height:3.611cm;" alt="Image" /></p>
<ul>
<li>en <strong>[5]</strong>, le nom donné à la nouvelle configuration. Ce sera celle qui exécute le script <strong>[main]</strong> <strong>[6]</strong> en lui passant le paramètre <strong>[config2]</strong> <strong>[7]</strong> ;
Les configurations d’exécution sont disponibles en haut à droite de la fenêtre PyCharm :</li>
</ul>
<p><img src="images/100000000000034A000001C92AAF8360.png" style="width:9.722cm;height:5.28cm;" alt="Image" /></p>
<p>Il suffit de sélectionner <strong>[2]</strong> ou <strong>[3]</strong> puis d’appuyer sur <strong>[4]</strong> pour exécuter le script <strong>[main]</strong> avec l’un ou l’autre des paramètres <strong>[config1]</strong> ou <strong>[config2]</strong>.</p>
<p>Avec <strong>[config1]</strong>, l’exécution de <strong>[main]</strong> donne les résultats suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span>
<span class="normal"><a href="#__codelineno-50-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v02</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">config1</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="mi">34</span>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a>
<a id="__codelineno-50-4" name="__codelineno-50-4"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>Avec <strong>[config2]</strong>, l’exécution de <strong>[main]</strong> donne les résultats suivants :</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span>
<span class="normal"><a href="#__codelineno-51-3">3</a></span>
<span class="normal"><a href="#__codelineno-51-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="n">C</span><span class="p">:</span>\<span class="n">Data</span>\<span class="n">st</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">dev</span>\<span class="n">python</span>\<span class="n">cours</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span>\<span class="n">venv</span>\<span class="n">Scripts</span>\<span class="n">python</span><span class="o">.</span><span class="n">exe</span> <span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">st</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">cours</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">flask</span><span class="o">-</span><span class="mi">2020</span><span class="o">/</span><span class="n">troiscouches</span><span class="o">/</span><span class="n">v02</span><span class="o">/</span><span class="n">main</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">config2</span>
<a id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="o">-</span><span class="mi">10</span>
<a id="__codelineno-51-3" name="__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4"></a><span class="n">Process</span> <span class="n">finished</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<p>Le lecteur est invité à vérifier ces résultats.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner">

      <div>
        <a href="https://tahe.developpez.com" target="_blank">
          https://tahe.developpez.com
        </a>
        <br>
        Ce cours tutoriel écrit par <strong>Serge Tahé</strong> est mis à disposition du public selon les termes de la
        <em>Licence Creative Commons Attribution – Pas d’Utilisation Commerciale –
        Partage dans les Mêmes Conditions 3.0 non transposé</em>.
      </div>

    </div>
  </div>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["navigation.sections", "navigation.indexes", "toc.integrate", "navigation.top"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="javascripts/focus.js"></script>
      
    
  </body>
</html>